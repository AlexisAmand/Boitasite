<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>SELFHTML: HTML dynamique / Les diff&eacute;rents mod&egrave;les DHTML / L'ancien mod&egrave;le DHTML de  Microsoft</title>
<link rel="stylesheet" type="text/css" href="../../src/selfhtml.css">
<meta name="description"    content="Comment fonctionne HTML dynamique d'apr&egrave;s l'ancien apport (1997)de Microsoft et quelle importance a-t-il aujourd'hui.">
<meta name="keywords"       content="SELFHTML, HTML dynamique, Dynamic HTML, DHTML, Microsoft, Explorer Internet, all-Objekt, langages scripts">
<meta name="author"         content="Stefan M&uuml;nz, selfhtml@teamone.de">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<meta name="DC.Publisher"   content="Serge Fran&ccedil;ois, selfhtml@selfhtml.com.fr">
<meta name="DC.Date"        content="2003-01-27T08:00+00:00">
<meta name="DC.Identifier"  content="http://selfhtml.selfhtml.com.fr/dhtml/modeles/microsoft.htm">
<meta name="DC.Language"    content="fr">
<meta name="DC.Rights"      content="../../editorial/copyright.htm">
<meta name="DC.Date.Create" content="2003-01-27T08:00+00:00">
<meta name="SELF.Version"   content="1">
<meta name="SELF.Pagetype"  content="Information">
<meta name="SELF.Path"      content="SELFHTML == ../../index.htm //  HTML dynamiqueL == ../index.htm // Les diff&eacute;rents mod&egrave;les DHTML == index.htm">
<!-- Matomo -->
<script type="text/javascript">
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//matomo.boitasite.com/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#AA5522" vlink="#772200" alink="#000000">

<table cellpadding="4" cellspacing="0" border="0" width="100%">
<tr>
<td bgcolor="#FFEEDD" class="nav"><a class="an" name="top"><img src="../../src/refchap.gif" width="16" height="13" border="0" alt="Renvoie au chapitre d'origine"></a> <a href="../../index.htm"><b>SELFHTML</b></a>/<a href="../../navigation/index.htm" target="_parent">Aides &agrave; la navigation</a> <img src="../../src/refchap.gif" width="16" height="13" border="0" alt="Renvoie au chapitre d'origine"> <a href="../index.htm"><b>HTML dynamique</b></a> <img src="../../src/refchap.gif" width="16" height="13" border="0" alt="Renvoie au chapitre d'origine"> <a href="index.htm"><b>Les diff&eacute;rents mod&egrave;les DHTML</b></a></td>
</tr>
</table><table cellpadding="4" cellspacing="0" border="0" width="100%">
<tr>
<td bgcolor="#EEEEEE" class="doc" width="110"><img src="../../src/logo.gif" width="106" height="109" border="0" alt="SELFHTML"></td>
<td bgcolor="#EEEEEE" class="doc" valign="bottom" width="100%"><h2>L'ancien mod&egrave;le DHTML de  Microsoft</h2>
<tr>
<td bgcolor="#EEEEEE" class="doc" valign="top" align="center">
<img src="../../src/docx.gif" width="30" height="20" vspace="6" border="0" alt="Page d'information: vue d'ensemble">
</td>
<td bgcolor="#FFFFFF" valign="top" nowrap>
<p>
<img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas">&nbsp;<a href="#generalites"><b>G&eacute;n&eacute;ralit&eacute;s sur le mod&egrave;le Microsoft</b></a><br>
<img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas">&nbsp;<a href="#langages_script"><b>Les langages scripts: JavaScript, JScript et VBScript</b></a><br>
<img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas">&nbsp;<a href="#all_objekt"><b>L'objet all</b></a><br>
<img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas">&nbsp;<a href="#css"><b>Feuilles de style CSS et scripts</b></a><br>
<img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas">&nbsp;<a href="#ecriture_css"><b>Fa&ccedil;on d'&eacute;crire les propri&eacute;t&eacute;s CSS en  JavaScript/JScript</b></a><br>
<img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas">&nbsp;<a href="#gestionnaire_evenement"><b>Gestionnaire d'&eacute;v&eacute;nement et l'objet Event</b></a><br>
<img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas">&nbsp;<a href="#event_bubbling"><b>H&eacute;ritage chez les &eacute;v&eacute;nements (Event-Bubbling) </b></a>
</p>
</td>
</tr><tr><td colspan="2" bgcolor="#EEEEEE" class="doc">&#160;<a href="#bottom"><img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas"></a>&#160;</td></tr>
</table>



<h2 class="Sh2"><a class="an" name="generalites">G&eacute;n&eacute;ralit&eacute;s sur le mod&egrave;le Microsoft</a></h2>

<p>Alors que l'Explorer Internet MS introduisait en 1997 un concept r&eacute;volutionnaire avec des possibilit&eacute;s tout &agrave; fait nouvelles de l'acc&egrave;s dynamique &agrave; une page Web, la plupart des d&eacute;veloppeurs Web &eacute;taient encore enferr&eacute;s dans l'apport JavaScript de Netscape et ne mesur&egrave;rent pas vraiment la port&eacute;e su nouveau mod&egrave;le. Le mod&egrave;le proposait rien de moins que la modification &agrave; volont&eacute; d'&eacute;l&eacute;ments HTML y compris leurs propri&eacute;t&eacute;s de feuilles de style, leur &eacute;change, leur cr&eacute;ation. leur effacement etc... Pour cela le navigateur r&eacute;agissait comme un logiciel de traitement de texte pendant le traitement. Quand des contenus &eacute;taient ins&eacute;r&eacute;s de fa&ccedil;on dynamique, tout ce qui suivait &eacute;tait repositionn&eacute; automatiquement. Bien que l'on soit en droit d'attendre au fond cette possibilit&eacute; dans un logiciel professionnel - si on se base sur les logiciels de traitement de texte modernes - il n'en allait pas ainsi &agrave; l'&eacute;poque. Le navigateur Netscape qui dominait encore en 1997 n'&eacute;tait pas en mesure de faire ceci:: vraiment reconstruire compl&egrave;tement une page en raison de modifications dynamiques. M&ecirc;me les d&eacute;veloppeurs Web rest&egrave;rent longtemps sans comprendre qu'il &eacute;tait pourtant plus simple et plus logique de modifier des &eacute;l&eacute;ments HTML de son choix, ainsi que leurs propri&eacute;t&eacute; et leurs contenus plut&ocirc;t que de manipuler avec la technique de mise en page compliqu&eacute;e de Netscape.</p>

<p>Le mod&egrave;le Microsoft montrait donc la voie &agrave; suivre. Mais il &eacute;tait sp&eacute;cifique &agrave; la marque, une pouss&eacute;e en avant de la firme dans les nouveaux mondes sans accord avec un organisme ind&eacute;pendant de normalisation. Microsoft se comporta &agrave; l'&eacute;poque en effet, de fa&ccedil;on incroyablement agressive et essayait de rattraper le temps perdu des ann&eacute;es pr&eacute;c&eacute;dentes. Bill Gates avait encore d&eacute;clar&eacute; pendant les deux ann&eacute;es qui pr&eacute;c&egrave;dent qu'Internet &eacute;tait n&eacute;gligeable et sans importance pour Microsoft. La tentative de s'attribuer seul la part du lion avec une politique commerciale agressive, ne r&eacute;ussit heureusement qu'en partie. Certes l'Explorer Internet conqu&eacute;rait mois apr&egrave;s mois plus de parts de march&eacute; des navigateurs et est devenu entre-temps et est devenu depuis longtemps le navigateur le plus largement r&eacute;pandu. Pourtant la tentative de Microsoft d'imposer ses propres langages, formats et techniques de programmation, &eacute;choua. Sur ce point la communaut&eacute; du Web se montra chatouilleuse. On avait reconnu que le logiciel  rend avant tout d&eacute;pendant quand il impose ses formats de fichiers.</p>

<p>Le mod&egrave;le DHTML de Microsoft &eacute;tait donc une importante pierre pos&eacute;e sur la route du <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="dom.htm"><b>mod&egrave;le DOM</b></a> &agrave; recommander aujourd'hui. Le mod&egrave;le DOM diff&egrave;re cependant de l'apport Microsoft en ce sens qu'il n'est pas limit&eacute; au seul HTML mais qu'il couvre tous les langages de marquage &agrave; rep&egrave;res compatibles XML. L'apport Microsoft n'a plus d'importance, si on le consid&egrave;re aujourd'hui, que si vous voulez cr&eacute;er des pages Web dynamiques qui doivent &eacute;galement pouvoir &ecirc;tre repr&eacute;sent&eacute;es par l'Explorer Internet 4.x. Il est certain que la part du march&eacute; des navigateurs de ce dernier dispara&icirc;t chaque jour davantage par rapport &agrave; celle des versions plus r&eacute;centes qui depuis la version 5 supportent le mod&egrave;le DOM, la conception Web doit n&eacute;anmoins, quand c'est possible, tenir compte des versions de navigateur plus anciennes.</p>


<table bgcolor="#EEEEEE" class="doc" width="100%"><tr><td>
&#160;<a href="#top"><img src="../../src/haut.gif" width="14" height="10" border="0" alt="vers le haut"></a><a href="#bottom"><img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas"></a>&#160;</td></tr></table>
<h2 class="Sh2"><img src="../../src/msjs.gif" width="30" height="30" border="0" alt="MS JScript"><img src="../../src/msie4.gif" width="30" height="30" border="0" alt="MS IE 4.0">&nbsp;<a class="an" name="langages_script">Les langages scripts: JavaScript, JScript et VBScript</a></h2>

<p>Il n'y a en fin de compte aucune directive prescrivant le langage script &agrave; utiliser pour HTML dynamique. C'est la raison pour laquelle r&egrave;gne ici encore quelque confusion.</p>

<p><img src="../../src/chap.gif" width="15" height="13" border="0" alt="Chapitre: vue d'ensemble">&nbsp;<a href="../../javascript/index.htm"><b>JavaScript</b></a> est toutefois et sans conteste le langage script le plus utilis&eacute; et le plus connu. Il a &eacute;t&eacute; introduit par Netscape. L'Explorer Internet MS interpr&egrave;te &eacute;galement JavaScript. Ici pourtant, il claudique toujours un peu derri&egrave;re Netscape, &eacute;tant donn&eacute; que Netscape poss&egrave;de les licences pour JavaScript et qu'il n'est pas permis &agrave; Microsoft de d&eacute;velopper lui-m&ecirc;me l'&eacute;tendue du langage de JavaScript. Avec une petite ruse, Microsoft s'est lib&eacute;r&eacute; de cette situation d&eacute;sagr&eacute;able: le langage fut simplement renomm&eacute; JScript. JScript, c'est JavaScript plus des extensions de langage sp&eacute;cifiques &agrave; Microsoft. JScript contient une quantit&eacute; d'objets de m&eacute;thodes et de propri&eacute;t&eacute;s qu'on ne trouve pas dans JavaScript. La plupart de ces commandes sont con&ccedil;ues pour des extensions de syst&egrave;me d'exploitation locales qui sont n&eacute;cessaires &agrave; l'Explorer Internet MS 4.x sous Windows. Mais m&ecirc;me l'<img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas">&nbsp;<a href="#all_objekt"><b>objet  all</b></a>, qui jusqu'alors n'existait pas dans le JavaScript de Netscape, en fait partie. Et cet objet est tout &agrave; fait primordial pour HTML dynamique dans l'Explorer Internet MS.</p>

<p>Outre JavaScript et JScript, l'Explorer Internet MS ma&icirc;trise encore VBScript. Ce langage est d&eacute;riv&eacute; de Visual Basic (VB). Il n'a cependant pas pu jusqu'alors s'imposer sur le WWW. VBScript a une toute autre syntaxe que JavaScript et JScript. Les objets, propri&eacute;t&eacute;s et m&eacute;thodes sont cependant, pour l'essentiel, les m&ecirc;mes. Avec VBScript vous pouvez donc aussi &eacute;crire du HTML dynamique.</p>
<h3 class="xmp">Exemple:</h3>
<p><img src="../../src/docf.gif" width="15" height="10" border="0" alt="D&eacute;monstration - nouvelle fen&ecirc;tre">&nbsp;<a href="affichage/langagesscript.htm" target="_blank"><b>Exemple d'affichage: aper&ccedil;u</b></a></p>


<table width="100%" cellpadding="10"><tr><td class="xmpcode" bgcolor="#FFFFE0"><pre>
&lt;html&gt;&lt;head&gt;&lt;title&gt;Test&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;p&gt;Votre navigateur ma�trise les langages script suivants:&lt;br&gt;
&lt;script language=&quot;JavaScript&quot; type=&quot;text/javascript&quot;&gt;
&lt;!--
document.write(&lt;br&gt;JavaScript&quot;);
//--&gt;
&lt;/script&gt;
&lt;script language=&quot;JScript&quot; type=&quot;text/jscript&quot;&gt;
&lt;!--
document.write(&lt;br&gt;JScript&quot;);
//--&gt;
&lt;/script&gt;
&lt;script language=&quot;VBScript&quot; type=&quot;text/vbscript&quot;&gt;
&lt;!--
document.write &quot;&lt;br&gt;VBScript&quot;
//--&gt;
&lt;/script&gt;
&lt;/p&gt;
&lt;/body&gt;&lt;/html&gt;
</pre></td></tr></table>

<h3 class="xpl">Explication:</h3>

<p>L'exemple ci-dessus n'est pas du HTML dynamique au sens strict du terme. Il doit simplement d&eacute;montrer comment mettre en &#339;uvre diff&eacute;rents langages script et quel en est l'effet sur le navigateur WWW. Dans l'exemple sont d&eacute;finis trois passages script: un avec JavaScript (<code>&lt;script language=&quot;JavaScript&quot; type=&quot;text/javascript&quot;&gt;</code>), un avec  JScript (<code>&lt;script language=&quot;JScript&quot; type=&quot;text/jscript&quot;&gt;</code>) et un avec VBScript <code>&lt;script language=&quot;VBScript&quot; type=&quot;text/vbscript&quot;&gt;</code>. Chacun des trois passages &eacute;crit &agrave; l'aide de la commande <code>document.write</code> (cette commande est la m&ecirc;me dans les trois langages) une ligne dans le document . &Eacute;tant donn&eacute; qu'un navigateur n'ex&eacute;cute que les passages scripts dont il conna&icirc;t le langage, figurent &agrave; la fin sur la page, exactement les langages script connus par le navigateur WWW utilis&eacute;.</p>

<p>Si vous voulez emp&ecirc;cher Netscape d'interpr&eacute;ter le passage, marquez simplement le passage script avec &quot;JScript&quot;. L'Explorer Internet MS 4.x quant &agrave; lui ne le prend pas mal si vous marquez un passage avec &quot;JavaScript&quot; en y utilisant des objets, m&eacute;thodes et propri&eacute;t&eacute;s qui n'existent jusque l&agrave; qu'en JScript. Si vous marquez un passage script avec &quot;JavaScript&quot; et y utilisez des extensions JScript sp&eacute;cifiques &agrave; Microsoft comme l'objet all, vous devez toujours faire d&eacute;pendre l'ex&eacute;cution des instructions correspondantes d'une requ&ecirc;te. Lisez &agrave; ce sujet  <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/langage/objets.htm#demande_existence"><b>demandes sur l'existence d'un objet</b></a> en JavaScript.</p>

<h3 class="inf">Attention:</h3>

<p>Dans les navigateurs modernes, il suffit en principe de mentionner la propri&eacute;t&eacute; <code>type=</code>. Les navigateurs plus anciens et  Opera 5.12 ont toutefois besoin imp&eacute;rativement de l'attribut <code>language=</code>, pour exclure le passage script du traitement.</p>






<table bgcolor="#EEEEEE" class="doc" width="100%"><tr><td>
&#160;<a href="#top"><img src="../../src/haut.gif" width="14" height="10" border="0" alt="vers le haut"></a><a href="#bottom"><img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas"></a>&#160;</td></tr></table>
<h2 class="Sh2"><img src="../../src/msjs.gif" width="30" height="30" border="0" alt="MS JScript"><img src="../../src/msie4.gif" width="30" height="30" border="0" alt="MS IE 4.0">&nbsp;<a class="an" name="all_objekt">L'objet all</a></h2>

<p>L'objet <code>all</code> est la pierre angulaire de l'apport DHTML de Microsoft. Comme le nom le laisse d&eacute;j&agrave; entendre, il est possible d'adresser par cet objet chaque &eacute;l&eacute;ment HTML distinct d'un fichier HTML. L'objet <code>all</code> a quantit&eacute; de propri&eacute;t&eacute;s et m&eacute;thodes qui permettent la modification dynamique d'un &eacute;l&eacute;ment HTML. Toutes les m&eacute;thodes et propri&eacute;t&eacute;s ne peuvent pas &ecirc;tre trait&eacute;es ici. Consultez pour cela la  <img src="../../src/chap.gif" width="15" height="13" border="0" alt="Chapitre: vue d'ensemble">&nbsp;<a href="../../javascript/objets/index.htm"><b>r&eacute;f&eacute;rence objet JavaScript</b></a> et r&eacute;capitulez les propri&eacute;t&eacute;s et les m&eacute;thodes de l'objet <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/objets/all.htm"><b>all</b></a>. Un autre exemple doit mettre ici en lumi&egrave;re la fa&ccedil;on d'agir de cet objet.</p>
<h3 class="xmp">Exemple:</h3>
<p><img src="../../src/docf.gif" width="15" height="10" border="0" alt="D&eacute;monstration - nouvelle fen&ecirc;tre">&nbsp;<a href="affichage/heure.htm" target="_blank"><b>Exemple d'affichage: aper&ccedil;u</b></a></p>




<table width="100%" cellpadding="10"><tr><td class="xmpcode" bgcolor="#FFFFE0"><pre>
&lt;html&gt;
&lt;head&gt;&lt;title&gt;Test&lt;/title&gt;
&lt;script language=&quot;JScript&quot; type=&quot;text/jscript&quot;&gt;
&lt;!--
 var jour_semaine =
 new Array(&quot;Dimanche&quot;,&quot;Lundi&quot;,&quot;Mardi&quot;,&quot;Mercredi&quot;,&quot;Jeudi&quot;,&quot;Vendredi&quot;,&quot;Samedi&quot;);
function affichage_date_heure()
{
 var maintenant = new Date();
 var jour = maintenant.getDate();
 var mois = maintenant.getMonth() + 1;
 var an = maintenant.getYear();
 var heures = maintenant.getHours();
 var minutes = maintenant.getMinutes();
 var secondes = maintenant.getSeconds();
 var jour_sem = maintenant.getDay();
 var jour_prec  = ((jour &lt; 10) ? &quot;0&quot; : &quot;/&quot;);
 var mois_prec  = ((mois &lt; 10) ? &quot;.0&quot; : &quot;/&quot;);
 var heure_prec  = ((heures &lt; 10) ? &quot;0&quot; : &quot;&quot;);
 var minutes_prec  = ((minutes &lt; 10) ? &quot;:0&quot; : &quot;:&quot;);
 var secondes_prec  = ((secondes &lt; 10) ? &quot;:0&quot; : &quot;:&quot;);
 var Datum = jour_prec + jour + mois_prec + mois  + &quot;.&quot; + an;
 var heure = heure_prec + heures + minutes_prec + minutes + secondes_prec + secondes;
 document.all.temps.innerHTML = Datum + &quot; (&quot; + jour_semaine[jour_sem] + &quot;)&lt;br&gt;&quot; + heure;
 window.setTimeout(&quot;affichage_date_heure()&quot;,1000);
}
//--&gt;
&lt;/script&gt;
&lt;/head&gt;
&lt;body bgcolor=&quot;#FFFFFF&quot;&gt;
&lt;p id=&quot;temps&quot; style=&quot;font-family:Verdana; font-size:24pt;
font-weight:bold; color:#CC00CC&quot;&gt;&lt;/p&gt;
&lt;script language=&quot;JScript&quot; type=&quot;text/jscript&quot;&gt;
&lt;!--
window.setTimeout(&quot;affichage_date_heure()&quot;,1000);
//--&gt;
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table>

<h3 class="xpl">Explication:</h3>

<p>L'exemple repr&eacute;sente une horloge compl&egrave;te qui tourne avec affichage de la date. &Agrave; cet effet est d&eacute;fini un paragraphe de texte vide avec <code>&lt;p&gt;</code>...<code>&lt;/p&gt;</code>. Les mentions de feuilles de style CSS servent &agrave; formater le paragraphe de texte selon son gr&eacute;. Quoique le paragraphe ne contienne tout d'abord aucun texte, il va servir de conteneur au cours du script pour le texte affich&eacute; avec la date et l'heure.</p>

<p>Le script du haut recherche la date et l'heure et les formate pour un affichage propre et habituel au pays. La cha&icirc;ne de caract&egrave;res qui doit &ecirc;tre affich&eacute;e est finalement affect&eacute;e &agrave; la propri&eacute;t&eacute; d'objet <code>document.all.temps.innerHTML</code>. <code>temps</code> est la r&eacute;f&eacute;rence au nom qui a &eacute;t&eacute; attribu&eacute; avec <code>id=</code> lors de la d&eacute;finition du paragraphe. Avec la propri&eacute;t&eacute; d'objet <code>innerHTML</code>, vous pouvez remplacer de fa&ccedil;on dynamique tout le contenu d'un &eacute;l&eacute;ment, ici celui de l'&eacute;l&eacute;ment <code>&lt;p&gt;</code>...<code>&lt;/p&gt;</code>. &Eacute;tant donn&eacute; que la fonction s'appelle elle-m&ecirc;me toutes les secondes pour l'affichage de l'heure, sera &eacute;crit chaque seconde un nouveau contenu dans le rep&egrave;re <code>&lt;p&gt;</code> avec l' <code>id=&quot;temps&quot;</code>. C'est par ce moyen qu'on a l'impression d'une horloge qui tourne.</p>

<p>Il y a d'autres possibilit&eacute;s puissantes de l'objet all. Elles sont d&eacute;crites dans la r&eacute;f&eacute;rence objet JavaScript &agrave; l'objet  <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/objets/all.htm"><b>all</b></a>. Ici encore seulement quelques suites d'instructions typiques:</p>

<p>Supposons que vous ayez l'&eacute;l&eacute;ment HTML suivant, un simple paragraphe de texte:<br>
<code>&lt;p id=&quot;le_texte&quot;&gt;Ceci est le texte d'un paragraphe de texte&lt;/p&gt;</code><br>
Ensuite vous pouvez par exemple provoquer les modifications dynamiques suivantes:<br>
Avec <code>document.all.le_texte.innerHTML = &quot;&lt;b&gt;nouveau texte&lt;\/b&gt; dans le m&ecirc;me paragraphe&quot;;</code> vous modifiez le contenu du paragraphe de texte et pouvez m&ecirc;me utiliser en m&ecirc;me temps des rep&egrave;res HTML pour le formatage.<br>
Avec <code>document.all.le_texte.outerHTML = &quot;&lt;h1&gt;&quot; + document.all.le_texte.innerHTML + &quot;&lt;\/h1&gt;&quot;;</code> vous transformez le paragraphe de texte en titre n� 1.<br>

Avec <code>document.all.le_texte.className = &quot;important&quot;;</code> vous affectez au paragraphe une classe de feuilles de style nomm&eacute;e <code>important</code>. Si vous avez d&eacute;fini une telle classe, le paragraphe adoptera toutes les mentions de feuilles de style d&eacute;finies dans la classe (Lisez aussi &agrave; ce propos la partie expliquant comment <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../css/formats/global.htm#klassen"><b>d&eacute;finir des formats pour des classes</b></a>).<br>
</p>






<table bgcolor="#EEEEEE" class="doc" width="100%"><tr><td>
&#160;<a href="#top"><img src="../../src/haut.gif" width="14" height="10" border="0" alt="vers le haut"></a><a href="#bottom"><img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas"></a>&#160;</td></tr></table>
<h2 class="Sh2"><img src="../../src/msjs.gif" width="30" height="30" border="0" alt="MS JScript"><img src="../../src/msie4.gif" width="30" height="30" border="0" alt="MS IE 4.0">&nbsp;<a class="an" name="css">Feuilles de style CSS et scripts</a></h2>

<p>Vous pouvez acc&eacute;der avec HTML dynamique et selon la syntaxe Microsoft &agrave; toutes les d&eacute;finitions de style des diff&eacute;rents &eacute;l&eacute;ments HTML. Ainsi vous pouvez modifier sensiblement les &eacute;l&eacute;ments pendant leur affichage. Si par exemple un titre N�2 a au d&eacute;but une taille de police de 14 points, vous pouvez changer celle-ci de fa&ccedil;on dynamique en 42 points. &quot;De fa&ccedil;on dynamique &quot; signifie ici: lors d'un &eacute;v&eacute;nement utilisateur comme un clic de souris sur le titre ou automatiquement &agrave; retardement, par exemple apr&egrave;s trois secondes .</p>

<p>Outre la taille de police, vous pouvez &eacute;galement mettre de fa&ccedil;on dynamique une couleur d'arri&egrave;re plan, un cadre autour d'un &eacute;l&eacute;ment, laisser voyager l'&eacute;l&eacute;ment sur l'&eacute;cran et bien plus encore. La condition pr&eacute;alable &agrave; ces effets sont chez l'Explorer Internet MS les <img src="../../src/chap.gif" width="15" height="13" border="0" alt="Chapitre: vue d'ensemble">&nbsp;<a href="../../css/index.htm"><b>feuilles de style CSS</b></a>. Vous devez conna&icirc;tre la syntaxe et les possibilit&eacute;s des mentions de feuilles de style.</p>

<p>Vous modifiez les d&eacute;finitions de style d'un &eacute;l&eacute;ment HTML en acc&eacute;dant &agrave; l'&eacute;l&eacute;ment &agrave; l'aide d'un langage script et en modifiant avec de nouvelles mentions de feuilles de style l'apparence de l'&eacute;l&eacute;ment. .</p>
<h3 class="xmp">Exemple:</h3>
<p><img src="../../src/docf.gif" width="15" height="10" border="0" alt="D&eacute;monstration - nouvelle fen&ecirc;tre">&nbsp;<a href="affichage/moucheducoche.htm" target="_blank"><b>Exemple d'affichage: aper&ccedil;u</b></a></p>


<table width="100%" cellpadding="10"><tr><td class="xmpcode" bgcolor="#FFFFE0"><pre>
&lt;html&gt;&lt;head&gt;&lt;title&gt;Test&lt;/title&gt;&lt;/head&gt;&lt;body&gt;
&lt;h1 id=&quot;texte_changeant&quot; style=&quot;font-size:14pt&quot;&gt;Mouche du coche&lt;/h1&gt;
&lt;script language=&quot;JScript&quot; type=&quot;text/jscript&quot;&gt;
&lt;!--
function diminue()
{
 document.all.texte_changeant.style.fontSize = &quot;14pt&quot;;
 window.setTimeout(&quot;augmente()&quot;,1000);
}
function augmente()
{
 document.all.texte_changeant.style.fontSize = &quot;42pt&quot;;
 window.setTimeout(&quot;diminue()&quot;,1000);
}
diminue();
//--&gt;
&lt;/script&gt;
&lt;/body&gt;&lt;/html&gt;
</pre></td></tr></table>

<h3 class="xpl">Explication:</h3>

<p>L'exemple affiche dans un premier temps un  titre N�1 (<code>&lt;h1&gt;</code>...<code>&lt;/h1&gt;</code>). &Agrave; l'aide de l'attribut <code>style=</code>, le titre se voit affecter des  <img src="../../src/chap.gif" width="15" height="13" border="0" alt="Chapitre: vue d'ensemble">&nbsp;<a href="../../css/proprietes/index.htm"><b>propri&eacute;t&eacute;s de feuilles de style CSS</b></a>. Dans l'exemple, la taille de police est fix&eacute;e &agrave; 14 points (<code>font-size:14pt</code>).</p>

<p>L'exemple global fait en sorte que la taille du titre passe de 14 points &agrave; 42 points et inversement une fois par seconde. Pour cette modification dynamique, un script est n&eacute;cessaire. Dans l'exemple ci-dessus un passage script est d&eacute;fini avec <code>&lt;script language=&quot;JScript&quot; type=&quot;text/jscript&quot;&gt;</code>...<code>&lt;/script&gt;</code>. &Agrave; l'int&eacute;rieur de ce passage ont &eacute;t&eacute; d&eacute;finies deux  <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/langage/fonctions.htm"><b>fonctions</b></a>. La premi&egrave;re fonction - <code>diminue()</code> - modifie la taille de police du titre &agrave; 14 points, la deuxi&egrave;me fonction - <code>augmente()</code> - &agrave; 42 points. Apr&egrave;s une seconde (1000 milli&egrave;mes de seconde) chacune des deux fonctions appelle l'autre. C'est ainsi qu'est obtenu l'effet de changement.</p>

<p>Pour comprendre la modification dynamique de la taille de police, vous devez consid&eacute;rer les relations suivantes: dans le rep&egrave;re de titre <code>&lt;h1&gt;</code>, un nom est affect&eacute; avec l'attribut <code>id=</code> - &agrave; savoir <code>texte_changeant</code>. Vous pouvez affecter ce nom librement. Il ne doit se composer que de lettres, de chiffres et/ou de tirets de soulignement "_", et ne doit contenir aucun espace ou caract&egrave;re sp&eacute;cial. Dans l'exemple, le script acc&egrave;de avec les instructions dans lesquelles on trouve <code>document.all.texte_changeant</code>, exactement &agrave; cet &eacute;l&eacute;ment. Avec l'  objet <code>all</code> (<code>document.all</code>), tous les &eacute;l&eacute;ments d'un fichier HTML sont adress&eacute;s. En faisant suivre l'instruction du nom, c'est exactement l'&eacute;l&eacute;ment qui porte ce nom qui est adress&eacute; - dans l'exemple <code>texte_changeant</code>. Derri&egrave;re suit l'objet style (<code>style</code>), qui est subordonn&eacute; &agrave; l'objet all. (Vous trouverez des d&eacute;tails sur cet objet dans la r&eacute;f&eacute;rence JavaScript &agrave; l'objet <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/objets/style.htm"><b>style</b></a>). Par l'objet style, vous pouvez noter comme propri&eacute;t&eacute; une mention permise de feuilles de style CSS. Ici sont &agrave; respecter les particularit&eacute;s des  modes d'&eacute;criture des mentions de feuilles de style en JavaScript/JScript qui vont &ecirc;tre trait&eacute;es ci-apr&egrave;s.</p>




<table bgcolor="#EEEEEE" class="doc" width="100%"><tr><td>
&#160;<a href="#top"><img src="../../src/haut.gif" width="14" height="10" border="0" alt="vers le haut"></a><a href="#bottom"><img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas"></a>&#160;</td></tr></table>
<h2 class="Sh2"><img src="../../src/msjs.gif" width="30" height="30" border="0" alt="MS JScript"><img src="../../src/msie4.gif" width="30" height="30" border="0" alt="MS IE 4.0">&nbsp;<a class="an" name="ecriture_css">Fa&ccedil;on d'&eacute;crire les propri&eacute;t&eacute;s CSS en  JavaScript/JScript</a></h2>

<p>Quand vous utilisez des mentions de feuilles de style dans des langages scripts, vous devez tenir compte de la syntaxe du langage script.</p>

<p>Un probl&egrave;me lors du m&eacute;lange de feuilles de style et de JavaScript ou de JScript, c'est que beaucoup de mentions de feuilles de style comportent des traits d'union dans leur nom comme par exemple <code>font-size</code>, <code>margin-top</code> ou <code>background-color</code>. Si avec de tels noms vous cr&eacute;ez en JavaScript ou en JScript une commande comme:<br>
<code>document.all.mon_texte.style.font-size = &quot;24pt&quot;;</code><br>
vous obtiendrez un message d'erreur. La raison en est que les traits d'union ne sont pas des caract&egrave;res permis dans les noms (le trait d'union est dans ces langages l'op&eacute;rateur pour les soustractions).</p>

<p>Pour &eacute;viter ce probl&egrave;me, Microsoft a institu&eacute; une r&egrave;gle simple. Si dans un script, une mention de feuille de style doit &ecirc;tre lue ou modifi&eacute;e, le trait d'union est omis et la premi&egrave;re lettre du mot qui le suit est &eacute;crite en majuscules.</p>
<h3 class="xmp">Exemple:</h3>
<p><img src="../../src/docf.gif" width="15" height="10" border="0" alt="D&eacute;monstration - nouvelle fen&ecirc;tre">&nbsp;<a href="affichage/jeudetexte.htm" target="_blank"><b>Exemple d'affichage: aper&ccedil;u</b></a></p>


<table width="100%" cellpadding="10"><tr><td class="xmpcode" bgcolor="#FFFFE0"><pre>
&lt;html&gt;&lt;head&gt;&lt;title&gt;Test&lt;/title&gt;
&lt;script language=&quot;JScript&quot; type=&quot;text/jscript&quot;&gt;
&lt;!--
var modus = 1;
 function jeu_texte() {
  if(modus == 1) {
    document.all.mon_texte.style.fontSize = &quot;24pt&quot;;
    modus = 2;
    return;
   }
  if(modus == 2) {
    document.all.mon_texte.style.padding = &quot;8pt&quot;;
    document.all.mon_texte.style.backgroundColor = &quot;#FFFF00&quot;;
    modus = 3;
    return;
   }
  if(modus == 3) {
    document.all.mon_texte.style.border = &quot;8pt groove #FFCC33&quot;;
    document.all.mon_texte.style.backgroundImage = &quot;url(back.gif)&quot;;
    modus = 0;
    return;
   }
  if(modus == 0) {
    document.all.mon_texte.style.fontSize = &quot;12pt&quot;;
    document.all.mon_texte.style.padding = &quot;0pt&quot;;
    document.all.mon_texte.style.backgroundColor = &quot;#FFFFFF&quot;;
    document.all.mon_texte.style.border = &quot;none&quot;;
    document.all.mon_texte.style.backgroundImage = &quot;none&quot;;
    modus = 1;
    return;
   }
 }
//--&gt;
&lt;/script&gt;
&lt;/head&gt;&lt;body&gt;
&lt;p id=&quot;mon_texte&quot; style=&quot;font-size:12pt; background-color:#FFFFFF; padding:0pt; border:none; background-image:none; cursor:hand&quot; onClick=&quot;jeu_texte()&quot;&gt;Cliquez sur ce texte&lt;/p&gt;
&lt;/body&gt;&lt;/html&gt;
</pre></td></tr></table>

<h3 class="xpl">Explication:</h3>

<p>Dans l'exemple est d&eacute;fini en dernier lieu un paragraphe avec diff&eacute;rentes mentions de feuilles de style. Certaines d'entre elles contiennent des traits d'union comme <code>font-size</code>, <code>background-color</code> et <code>background-image</code>. Dans le script qui est not&eacute; au dessus du paragraphe de texte, ces mentions de feuilles de style et d'autres sont modifi&eacute;es de fa&ccedil;on dynamique. Vous pouvez reconna&icirc;tre que <code>font-size</code> devient <code>fontSize</code>, <code>background-color</code> devient <code>backgroundColor</code> et <code>background-image</code> devient <code>backgroundImage</code> - conform&eacute;ment &agrave; la r&egrave;gle.</p>

<p>Si &agrave; l'int&eacute;rieur d'un script vous voulez affecter une nouvelle valeur &agrave; une propri&eacute;t&eacute; de feuilles de style, vous devez d'abord adresser l'objet HTML d&eacute;sir&eacute; avec la propri&eacute;t&eacute; de style - dans l'exemple ci-dessus donc par exemple: <code>document.all.mon_texte.style.fontSize</code>. Derri&egrave;re suit un signe &eacute;gal pour l'affectation, et ensuite la valeur que vous voulez affecter, donc par exemple: <code>&quot;24pt&quot;</code>. Cette valeur doit figurer entre guillemets aussi bien en JavaScript qu'en JScript.</p>

<p>Cette fa&ccedil;on d'affecter une valeur &agrave; une mention de feuille de style se distingue de la fa&ccedil;on dont les valeurs sont affect&eacute;es lors de d&eacute;finitions de feuilles de style normales: l&agrave;, vous notez &agrave; la place du signe &eacute;gal un double point - comme dans les d&eacute;finitions de feuilles de style du paragraphe de texte dans l'exemple ci-dessus. Les guillemets n'y sont pas n&eacute;cessaires.</p>

<p>Le script de l'exemple modifie le formatage du texte dans le paragraphe de texte quand l'utilisateur clique sur le texte. &Agrave; chaque fois que cet &eacute;v&eacute;nement survient, la fonction <code>jeu_texte()</code> d&eacute;finie dans le script est appel&eacute;e &agrave; l'aide du <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/langage/gestevenements.htm"><b>gestionnaire d'&eacute;v&eacute;nement </b></a> <code>onClick=</code>. Le script g&egrave;re une variable d&eacute;finie globalement et nomm&eacute;e <code>modus</code>. Selon la valeur de cette variable, diff&eacute;rentes nouvelles mentions de feuilles de style sont affect&eacute;es au texte. La modification dynamique du paragraphe dans le script est mise en oeuvre par la mention <code>id=&quot;mon_texte&quot;</code> dans le paragraphe de texte et des commandes du type <code>document.all.mon_texte.style</code>.</p>









<table bgcolor="#EEEEEE" class="doc" width="100%"><tr><td>
&#160;<a href="#top"><img src="../../src/haut.gif" width="14" height="10" border="0" alt="vers le haut"></a><a href="#bottom"><img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas"></a>&#160;</td></tr></table>
<h2 class="Sh2"><img src="../../src/msjs.gif" width="30" height="30" border="0" alt="MS JScript"><img src="../../src/msie4.gif" width="30" height="30" border="0" alt="MS IE 4.0">&nbsp;<a class="an" name="gestionnaire_evenement">Gestionnaire d'&eacute;v&eacute;nement et l'objet Event</a></h2>

<p>Une condition pr&eacute;alable importante pour le HTML dynamique est dans de nombreux cas, l'interaction entre l'utilisateur et le fichier HTML affich&eacute;. Le fichier affich&eacute; peut r&eacute;agir &agrave; des &eacute;v&eacute;nements utilisateur comme des clics de souris, des touches press&eacute;es au clavier en modifiant des &eacute;l&eacute;ments de fa&ccedil;on dynamique. Pour ce faire, il y a des gestionnaires d'&eacute;v&eacute;nement et &eacute;galement un objet Event. Toutes les m&eacute;thodes et propri&eacute;t&eacute;s de l'objet Event et tous les diff&eacute;rents gestionnaires d'&eacute;v&eacute;nement ne peuvent pas &ecirc;tre trait&eacute;s ici. Consultez pour cela dans la documentation les <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/langage/gestevenements.htm"><b>gestionnaires d'&eacute;v&eacute;nement</b></a> ainsi que la r&eacute;f&eacute;rence de l'objet <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/objets/event.htm"><b>event</b></a> et r&eacute;capitulez les diff&eacute;rentes possibilit&eacute;s. Un autre exemple doit mettre ici en lumi&egrave;re la fa&ccedil;on d'agir de cet objet.</p>
<h3 class="xmp">Exemple:</h3>
<p><img src="../../src/docf.gif" width="15" height="10" border="0" alt="D&eacute;monstration - nouvelle fen&ecirc;tre">&nbsp;<a href="affichage/sauteur.htm" target="_blank"><b>Exemple d'affichage: aper&ccedil;u</b></a></p>


<table width="100%" cellpadding="10"><tr><td class="xmpcode" bgcolor="#FFFFE0"><pre>
&lt;html&gt;&lt;head&gt;&lt;title&gt;Test&lt;/title&gt;
&lt;script language=&quot;JScript&quot; type=&quot;text/jscript&quot;&gt;
&lt;!--
 function SetPos()
 {
  document.all.sauteur.style.left = window.event.x;
  document.all.sauteur.style.top = window.event.y;
 }
//--&gt;
&lt;/script&gt;
&lt;/head&gt;&lt;body bgcolor=&quot;#FFFFFF&quot; onClick=&quot;SetPos()&quot;&gt;
&lt;div id=&quot;sauteur&quot; style=&quot;position:absolute; top:100px; left:100px; width:200px;
    height:100px; font-size:16pt; background-color:#000066; color:#FFFF00; padding:1cm;&quot;&gt;
Cliquez quelque part avec la souris!
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table>

<h3 class="xpl">Explication:</h3>

<p>L'exemple ci-dessus d&eacute;finit un passage avec  <code>&lt;div&gt;</code>...<code>&lt;/div&gt;</code>. Diff&eacute;rentes mentions de feuilles de style dans le rep&egrave;re d'ouverture <code>&lt;div&gt;</code> font en sorte que le passage soit bien visible et positionn&eacute; &agrave; l'&eacute;cran de fa&ccedil;on absolue. Si l'utilisateur clique pendant l'affichage quelque part dans la fen&ecirc;tre d'affichage du navigateur, le passage d&eacute;fini <code>&lt;div&gt;</code> est repositionn&eacute;, &agrave; savoir de telle fa&ccedil;on que le coin en haut et &agrave; gauche du passage se trouve exactement &agrave; l'endroit ou l'utilisateur a cliqu&eacute;.</p>

<p>Pour que cela soit possible, tout le document doit r&eacute;agir imm&eacute;diatement quand l'utilisateur clique quelque part avec la souris. &Agrave; cet effet est not&eacute; dans le rep&egrave;re d'ouverture <code>&lt;body&gt;</code> le gestionnaire d'&eacute;v&eacute;nement <code>onClick=</code>. &Agrave; chaque clic de souris dans la fen&ecirc;tre d'affichage la  <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/langage/fonctions.htm"><b>fonction</b></a> <code>SetPos()</code>, not&eacute;e dans le passage script, est appel&eacute;e. Cette fonction fixe les nouvelles valeurs pour le coin sup&eacute;rieur gauche du passage <code>&lt;div&gt;</code>. La r&eacute;f&eacute;rence en est le nom (&quot;<code>sauteur</code>&quot;), qui a &eacute;t&eacute; affect&eacute; dans le rep&egrave;re <code>&lt;div&gt;</code> avec <code>id=</code>. Avec la commande <code>document.all.sauteur.style.left</code> est fix&eacute;e la nouvelle position de d&eacute;part &agrave; gauche, avec <code>document.all.sauteur.style.top</code> la nouvelle position de d&eacute;part en haut. La nouvelle valeur pour la gauche est livr&eacute;e par la propri&eacute;t&eacute; <code>x</code> de l'objet <code>window.event</code>, la valeur pour le haut par la propri&eacute;t&eacute; <code>y</code> de cet objet. Le passage <code>&lt;div&gt;</code> est ainsi repositionn&eacute;.</p>

<p>L'objet Event d&eacute;tient en permanence, dans ses propri&eacute;t&eacute;s objet, toutes les activit&eacute;s significatives de l'utilisateur comme la position de la souris, les &eacute;v&eacute;nements clavier, les clics de souris, les touches souris appuy&eacute;es etc... Sur un simple appel de la propri&eacute;t&eacute; du type <code>window.event.[propri&eacute;t&eacute;]</code>, vous pouvez &agrave; tout moment capter les &eacute;v&eacute;nements actuels. Le captage s'obtient par la notation de gestionnaires d'&eacute;v&eacute;nement. &Eacute;galement important pour le captage: l'endroit auquel vous captez l'&eacute;v&eacute;nement, c'est &agrave; dire, &agrave; quel endroit vous notez le gestionnaire d'&eacute;v&eacute;nement. Ainsi vous pourriez aussi bien, dans l'exemple ci-dessus, noter le gestionnaire d'&eacute;v&eacute;nement <code>onClick=</code> dans le rep&egrave;re d'ouverture <code>&lt;div&gt;</code>. Dans ce cas, les instructions ne seraient ex&eacute;cut&eacute;es que si le clic survenait dans ce passage <code>&lt;div&gt;</code>.</p>

<p>Un sous-objet important de l'objet Event est l'objet pour l'&eacute;l&eacute;ment cliqu&eacute; (<code>srcElement</code>). Ainsi vous pouvez, avec <code>window.event.srcElement.tagName</code>, rechercher quel rep&egrave;re HTML est concern&eacute; par l'&eacute;v&eacute;nement utilisateur actuel. Vous pouvez alors r&eacute;agir en cons&eacute;quence dans vos scripts.</p>

<p>Il n'y a pas que le gestionnaire d'&eacute;v&eacute;nement <code>onClick=</code>, mais beaucoup d'autres. Si par exemple vous notez dans le rep&egrave;re d'ouverture <code>&lt;body&gt;</code> l'instruction <code>onkeydown=&quot;alert(window.event.keyCode)&quot;</code>, sera sortie &agrave; chaque touche appuy&eacute;e sa valeur de signe ASCII sous forme d&eacute;cimale. Car dans la propri&eacute;t&eacute; <code>keyCode</code> de l'objet Event est retenue la valeur de la touche d&eacute;s qu'un utilisateur appuie sur une touche.</p>

<h3 class="inf">Attention:</h3>

<p>Microsoft propose encore une syntaxe sp&eacute;ciale que vous pouvez utiliser de la m&ecirc;me fa&ccedil;on pour l'ex&eacute;cution de scripts d&eacute;pendant d'&eacute;v&eacute;nements:</p>

<pre>&lt;script for=&quot;document&quot; event=&quot;onkeydown()&quot; language=&quot;JScript&quot; type=&quot;text/jscript&quot;&gt;
 if(event.keyCode == 32) window.location.href=&quot;fichier2.htm&quot;;
&lt;/script&gt;</pre>

<p>Avec une telle instruction dans le rep&egrave;re d'ouverture du script, ce dernier n'est ex&eacute;cut&eacute; que si l'&eacute;v&eacute;nement mentionn&eacute; (Event) se produit. Dans l'exemple il est fait en sorte que le navigateur saute &agrave; un autre fichier si on appuie sur la barre d'espacement (elle a le code clavier 32).</p>










<table bgcolor="#EEEEEE" class="doc" width="100%"><tr><td>
&#160;<a href="#top"><img src="../../src/haut.gif" width="14" height="10" border="0" alt="vers le haut"></a><a href="#bottom"><img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas"></a>&#160;</td></tr></table>
<h2 class="Sh2"><img src="../../src/msjs.gif" width="30" height="30" border="0" alt="MS JScript"><img src="../../src/msie4.gif" width="30" height="30" border="0" alt="MS IE 4.0">&nbsp;<a class="an" name="event_bubbling">H&eacute;ritage chez les &eacute;v&eacute;nements (Event-Bubbling)</a></h2>

<p>Les &eacute;v&eacute;nements utilisateurs (Events) survenant pendant l'affichage d'une page WWW sont h&eacute;rit&eacute;s, chez l'Explorer Internet MS, de &quot;l'int&eacute;rieur vers l'ext&eacute;rieur&quot;. Si l'utilisateur par exemple clique sur un texte marqu&eacute; avec <code>&lt;b&gt;</code>...<code>&lt;/b&gt;</code> en caract&egrave;res gras situ&eacute; dans un paragraphe de texte d&eacute;fini avec <code>&lt;p&gt;</code>...<code>&lt;/p&gt;</code> le clic ne concerne dans un premier temps que le texte en caract&egrave;res gras. Supposons que le paragraphe de texte comprenne dans son rep&egrave;re d'ouverture <code>&lt;p&gt;</code> un gestionnaire d'&eacute;v&eacute;nement <code>onClick=</code>: celui-ci ne deviendrait pas actif, &eacute;tant donn&eacute; que le clic ne concerne que le texte marqu&eacute; en caract&egrave;res gras situ&eacute; dans le paragraphe . Et comme le rep&egrave;re <code>&lt;b&gt;</code> ne contient aucun gestionnaire d'&eacute;v&eacute;nement, le clic de souris passerait inaper&ccedil;u, bien qu'il e&ucirc;t lieu dans le paragraphe qui contient le gestionnaire d'&eacute;v&eacute;nement correspondant &agrave; un clic de souris. L'effet Bubble (litt&eacute;ralement: <i>effet de bulles</i>) fait en sorte que l'&eacute;v&eacute;nement (le clic de souris) soit transmis &agrave; l'&eacute;l&eacute;ment imm&eacute;diatement sup&eacute;rieur dans la structure arborescente du fichier HTML. Par ce moyen, l'&eacute;v&eacute;nement arrive au rep&egrave;re <code>&lt;p&gt;</code>, qui traite l'&eacute;v&eacute;nement. Si le rep&egrave;re <code>&lt;p&gt;</code> ne contenait pas non plus de gestionnaire d'&eacute;v&eacute;nement<code>onClick=</code>, alors l'effet de bulles transmettrait l'&eacute;v&eacute;nement &agrave; l'&eacute;l&eacute;ment imm&eacute;diatement sup&eacute;rieur, donc par exemple un rep&egrave;re <code>&lt;div&gt;</code> dans lequel se trouverait le paragraphe de texte, ou au rep&egrave;re <code>&lt;body&gt;</code>. Si un gestionnaire d'&eacute;v&eacute;nement qui r&eacute;agisse au clic de souris n'est not&eacute; nulle part, rien ne se passe tout simplement.</p>
<h3 class="xmp">Exemple:</h3>
<p><img src="../../src/docf.gif" width="15" height="10" border="0" alt="D&eacute;monstration - nouvelle fen&ecirc;tre">&nbsp;<a href="affichage/bubble.htm" target="_blank"><b>Exemple d'affichage: aper&ccedil;u</b></a></p>


<table width="100%" cellpadding="10"><tr><td class="xmpcode" bgcolor="#FFFFE0"><pre>
&lt;html&gt;
&lt;head&gt;&lt;title&gt;Test&lt;/title&gt;
&lt;script language=&quot;JScript&quot; type=&quot;text/jscript&quot;&gt;
&lt;!--
function Handle_Click() {
  document.all.Info.innerHTML = &quot;Le passage que vous avez cliqu� est marqu� avec &amp;lt;&quot; + window.event.srcElement.tagName + &quot;&amp;gt; et il a l'id  &lt;i&gt;&quot; +
  window.event.srcElement.id + &quot; &lt;\/i&gt;. L'�v�nement a �t� pourtant transmis au rep�re body.&quot;;
}
//--&gt;
&lt;/script&gt;
&lt;/head&gt;
&lt;body bgcolor=&quot;#FFFFFF&quot; onClick=&quot;Handle_Click()&quot;&gt;
&lt;div id=&quot;contenu&quot;&gt;
&lt;p id=&quot;Text_1&quot;&gt;Un  &lt;i id=&quot;text_i&quot;&gt;paragraphe de texte&lt;/i&gt;. Cliquez-y&lt;/p&gt;
&lt;p id=&quot;Text_2&quot;&gt;Un &lt;u id=&quot;text_u&quot;&gt;autre paragraphe&lt;/u&gt;. Cliquez-y&lt;/p&gt;
&lt;p id=&quot;Text_3&quot;&gt;Encore un &lt;b id=&quot;text_b&quot;&gt;paragraphe&lt;/b&gt;. Cliquez-y&lt;/p&gt;
&lt;p id=&quot;Text_4&quot;&gt;Et un dernier &lt;tt id=&quot;text_tt&quot;&gt;paragraphe&lt;/tt&gt;. Cliquez-y&lt;/p&gt;
&lt;/div&gt;
&lt;p id=&quot;Info&quot;&gt;Ici apparaissent les informations sur les clics&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table>

<h3 class="xpl">Explication:</h3>

<p>Dans l'exemple sont d&eacute;finis diff&eacute;rents textes avec des marquages HTML diff&eacute;rents. Chaque &eacute;l&eacute;ment s'est vu affecter un nom (<code>id=</code>). Le plus bas des paragraphes de texte avec <code>id=&quot;Info&quot;</code> sert &agrave; sortir des informations de fa&ccedil;on dynamique sur l'&eacute;l&eacute;ment que l'utilisateur a cliqu&eacute;. Chaque fois que l'utilisateur clique sur un &eacute;l&eacute;ment, la  <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/langage/fonctions.htm"><b>fonction</b></a> <code>Handle_Click()</code>, d&eacute;finie dans un passage JavaScript de l'ent&ecirc;te de fichier est appel&eacute;e. Chaque fois est sorti, dans le paragraphe &quot;Info&quot;, quel rep&egrave;re HTML a &eacute;t&eacute; cliqu&eacute; et quel id lui a &eacute;t&eacute; attribu&eacute;e. &Agrave; vrai dire, le clic ne concerne que l'&eacute;l&eacute;ment cliqu&eacute;. Pourtant, aucun de ces &eacute;l&eacute;ments n'a de gestionnaire d'&eacute;v&eacute;nement <code>onClick=</code> qui capte un clic de souris et ex&eacute;cute du code de script. La raison pour laquelle le code du script est malgr&eacute; tout ex&eacute;cut&eacute; &agrave; chaque clic de souris est d&ucirc;e &agrave; l'effet de bulles. L'&eacute;v&eacute;nement "clic de souris" est &agrave; chaque fois transmis plus loin "vers l'ext&eacute;rieur" - pour aboutir finalement au rep&egrave;re <code>&lt;body&gt;</code>, qui contient un gestionnaire d'&eacute;v&eacute;nement <code>onClick=</code>.</p>

<p>L'effet de bulles peut &ecirc;tre mis hors service s'il n'est pas souhait&eacute;. Pour cela, vous devez noter dans un passage JScript/JavaScript l'instruction:<br>
<code>window.event.cancelBubble = true;</code></p>







<table cellpadding="4" cellspacing="0" border="0" width="100%">
<tr><td colspan="2" bgcolor="#EEEEEE" class="doc">
&#160;<a href="#top"><img src="../../src/haut.gif" width="14" height="10" border="0" alt="vers le haut"></a>
</td></tr>
<tr><td bgcolor="#EEEEEE" class="doc" align="right"><a href="netscape.htm"><img src="../../src/suivant.gif" width="10" height="10" border="0" hspace="10" alt="page suivante"></a></td>
<td bgcolor="#FFFFFF"><img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information"> <a href="netscape.htm"><b>L'ancien mod&egrave;le DHTML de Netscape</b></a>
</td></tr>
<tr>
<td bgcolor="#EEEEEE" class="doc" align="right"><a href="dom.htm"><img src="../../src/precedent.gif" width="10" height="10" border="0" hspace="10" alt="page pr&eacute;c&eacute;dente"></a></td>
<td bgcolor="#FFFFFF" width="100%"><img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information"> <a href="dom.htm"><b>Le mod&egrave;le DOM (DOM)</b></a>
</td>
</tr>
<tr><td colspan="2" bgcolor="#EEEEEE" class="doc">&#160;</td></tr>
</table><table cellpadding="4" cellspacing="0" border="0" width="100%">
<tr>
<td bgcolor="#FFEEDD" class="nav"><a class="an" name="bottom"><img src="../../src/refchap.gif" width="16" height="13" border="0" alt="Renvoie au chapitre d'origine"></a> <a href="../../index.htm"><b>SELFHTML</b></a>/<a href="../../navigation/index.htm" target="_parent">Aides &agrave; la navigation</a> <img src="../../src/refchap.gif" width="16" height="13" border="0" alt="Renvoie au chapitre d'origine"> <a href="../index.htm"><b>HTML dynamique</b></a> <img src="../../src/refchap.gif" width="16" height="13" border="0" alt="Renvoie au chapitre d'origine"> <a href="index.htm"><b>Les diff&eacute;rents mod&egrave;les DHTML</b></a></td>
</tr>
</table>

<p>&copy; 2001 Stefan M&uuml;nz / &copy; 2003 Traduction <img src="../../src/courriel.gif" width="15" height="10" border="0" alt="Adresse &eacute;lectronique">&nbsp;<a href="mailto:13405@free.fr">Serge Fran&ccedil;ois, 13405@free.fr</a><br><img src="../../src/courriel.gif" width="15" height="10" border="0" alt="Adresse &eacute;lectronique">&nbsp;<a href="mailto:selfhtml@selfhtml.com.fr">selfhtml@selfhtml.com.fr</a></p>



</body>
</html>