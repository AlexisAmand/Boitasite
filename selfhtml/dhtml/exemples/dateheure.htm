<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>SELFHTML: HTML dynamique / Solutions pour la pratique /  Affichage de la date et de l'heure</title>
<link rel="stylesheet" type="text/css" href="../../src/selfhtml.css">
<meta name="description"    content="Comment construire dans une page Web avec HTML dynamique, un affichage de la date et de l'heure.">
<meta name="keywords"       content="SELFHTML, HTML dynamique, Dynamic HTML, DHTML, Document Object Model, DOM, mod&egrave;le DOM, date, heure, pendule">
<meta name="author"         content="Stefan M&uuml;nz, selfhtml@teamone.de">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<meta name="DC.Publisher"   content="Serge Fran&ccedil;ois, selfhtml@selfhtml.com.fr">
<meta name="DC.Date"        content="2003-01-27T08:00+00:00">
<meta name="DC.Identifier"  content="http://selfhtml.selfhtml.com.fr/dhtml/exemples/dateheure.htm">
<meta name="DC.Language"    content="fr">
<meta name="DC.Rights"      content="../../editorial/copyright.htm">
<meta name="DC.Date.Create" content="2003-01-27T08:00+00:00">
<meta name="SELF.Version"   content="1">
<meta name="SELF.Pagetype"  content="Information">
<meta name="SELF.Path"      content="SELFHTML == ../../index.htm // HTML dynamique == ../index.htm // Solutions pour la pratique == index.htm">
<!-- Matomo -->
<script type="text/javascript">
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//matomo.boitasite.com/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#AA5522" vlink="#772200" alink="#000000">

<table cellpadding="4" cellspacing="0" border="0" width="100%">
<tr>
<td bgcolor="#FFEEDD" class="nav"><a class="an" name="top"><img src="../../src/refchap.gif" width="16" height="13" border="0" alt="Renvoie au chapitre d'origine"></a> <a href="../../index.htm"><b>SELFHTML</b></a>/<a href="../../navigation/index.htm" target="_parent">Aides &agrave; la navigation</a> <img src="../../src/refchap.gif" width="16" height="13" border="0" alt="Renvoie au chapitre d'origine"> <a href="../index.htm"><b>HTML dynamique</b></a> <img src="../../src/refchap.gif" width="16" height="13" border="0" alt="Renvoie au chapitre d'origine"> <a href="index.htm"><b>Solutions pour la pratique</b></a></td>
</tr>
</table><table cellpadding="4" cellspacing="0" border="0" width="100%">
<tr>
<td bgcolor="#EEEEEE" class="doc" width="110"><img src="../../src/logo.gif" width="106" height="109" border="0" alt="SELFHTML"></td>
<td bgcolor="#EEEEEE" class="doc" valign="bottom" width="100%"><h2> Affichage de la date et de l'heure</h2>
<tr>
<td bgcolor="#EEEEEE" class="doc" valign="top" align="center">
<img src="../../src/docx.gif" width="30" height="20" vspace="6" border="0" alt="Page d'information: vue d'ensemble">
</td>
<td bgcolor="#FFFFFF" valign="top" nowrap>
<p>
<img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas">&nbsp;<a href="#remarques"><b>Remarques sur cet exemple</b></a><br>
<img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas">&nbsp;<a href="#texte_source"><b> Texte source avec explications</b></a><br>
</p>
<p><img src="../../src/docf.gif" width="15" height="10" border="0" alt="D&eacute;monstration - nouvelle fen&ecirc;tre">&nbsp;<a href="affichage/heuredate.htm" target="_blank"><b>Exemple d'affichage: aper&ccedil;u</b></a>
</p>
</td>
</tr><tr><td colspan="2" bgcolor="#EEEEEE" class="doc">&#160;<a href="#bottom"><img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas"></a>&#160;</td></tr>
</table>



<h2 class="Sh2"><a class="an" name="remarques">Remarques sur cet exemple</a></h2>

<p>Cet exemple montre comment vous pouvez r&eacute;aliser une montre qui fonctionne et que vous pouvez formater &agrave; souhait, de fa&ccedil;on &agrave; ce qu'elle soit affich&eacute;e aussi bien sur l'Explorer Internet MS &agrave; partir de la version 4.0 qu'avec Netscape &eacute;galement &agrave; partir de la version 4.0. Dans la pratique, une telle horloge est appropri&eacute;e par exemple pour des pages affich&eacute;es en permanence par exemple dans une fen&ecirc;tre cadre dont la contenu ne change pas pendant la navigation, ou bien sur des pages qui contiennent des jeux multim&eacute;dia ou un clavardage incorpor&eacute; - donc sur des pages que l'utilisateur laisse longtemps affich&eacute;es sans les faire d&eacute;filer et sans les quitter.</p>

<p>L'exemple utilise la <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="bibliotheque_dhtml.htm"><b>biblioth&egrave;que DHTML g&eacute;n&eacute;rale</b></a>, pour faire ce qui est n&eacute;cessaire en HTML dynamique dans l'exemple.</p>




<table bgcolor="#EEEEEE" class="doc" width="100%"><tr><td>
&#160;<a href="#top"><img src="../../src/haut.gif" width="14" height="10" border="0" alt="vers le haut"></a><a href="#bottom"><img src="../../src/bas.gif" width="14" height="10" border="0" alt="vers le bas"></a>&#160;</td></tr></table>
<h2 class="Sh2"><img src="../../src/dom10.gif" width="30" height="30" border="0" alt="DOM 1.0"><img src="../../src/js12.gif" width="30" height="30" border="0" alt="JavaScript 1.2"><img src="../../src/netsc4x.gif" width="30" height="30" border="0" alt="Netscape 4.x"><img src="../../src/msie4.gif" width="30" height="30" border="0" alt="MS IE 4.0">&nbsp;<a class="an" name="texte_source">Texte source avec explications</a></h2>

<p>L'exemple montre un fichier HTML complet dans lequel est incorpor&eacute;e une horloge avec la date. Le fichier <code>dhtml.js</code>, dans lequel les fonctions de la biblioth&egrave;que DHTML sont contenues, doit &ecirc;tre doit &ecirc;tre disponible et se trouver dans l'exemple, dans le m&ecirc;me r&eacute;pertoire que le fichier HTML.</p>

<h3 class="xmp">Exemple:</h3>

<p><img src="../../src/docf.gif" width="15" height="10" border="0" alt="D&eacute;monstration - nouvelle fen&ecirc;tre">&nbsp;<a href="affichage/heuredate.htm" target="_blank"><b>Exemple d'affichage: aper&ccedil;u</b></a> (<img src="../../src/docf.gif" width="15" height="10" border="0" alt="D&eacute;monstration - nouvelle fen&ecirc;tre">&nbsp;<a href="affichage/dhtml.htm" target="_blank"><b>Biblioth&egrave;que DHTML g&eacute;n&eacute;rale</b></a>)</p>

<table width="100%" cellpadding="10"><tr><td class="xmpcode" bgcolor="#FFFFE0"><pre>
&lt;html&gt;&lt;head&gt;&lt;title&gt;Test&lt;/title&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;dhtml.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
function afficher_heure() {
var jour_semaine =  new Array(&quot;Dimanche&quot;,&quot;Lundi&quot;,&quot;Mardi&quot;,&quot;Mercredi&quot;,&quot;Jeudi&quot;,&quot;Vendredi&quot;,&quot;Samedi&quot;);

 var maintenant = new Date();
 var jour = maintenant.getDate();
 var mois = maintenant.getMonth() + 1;
 var an = maintenant.getYear();
 if(an &lt; 999) an += 1900;
 var heures = maintenant.getHours();
 var minutes = maintenant.getMinutes();
 var secondes = maintenant.getSeconds();
 var jour_sem = maintenant.getDay();
 var jour_prec  = ((jour &lt; 10) ? &quot;0&quot; : &quot;&quot;);
 var mois_prec  = ((mois &lt; 10) ? &quot;.0&quot; : &quot;.&quot;);
 var heure_prec  = ((heures &lt; 10) ? &quot;0&quot; : &quot;&quot;);
 var minutes_prec  = ((minutes &lt; 10) ? &quot;:0&quot; : &quot;:&quot;);
 var secondes_prec  = ((secondes &lt; 10) ? &quot;:0&quot; : &quot;:&quot;);
 var Datum = jour_prec + jour + mois_prec + mois  + &quot;.&quot; + an;
 var temps = heure_prec + heures + minutes_prec + minutes + secondes_prec + secondes;
 var tout = jour_semaine[jour_sem] + &quot;, &quot; + Datum + &quot;, &quot; + temps;

 if(DHTML) {
   if(NS) setCont(&quot;id&quot;,&quot;pendule&quot;,null,&quot;&lt;span class=\&quot;pendule\&quot;&gt;&quot; + tout + &quot;&lt;\/span&gt;&quot;);
   else   setCont(&quot;id&quot;,&quot;pendule&quot;,null,tout);
 }
 else return;

 window.setTimeout(&quot;afficher_heure()&quot;,1000);
}
//--&gt;
&lt;/script&gt;
&lt;style type=&quot;text/css&quot;&gt;
&lt;!--
#pendule { position:absolute; top:10px; left:10px; }
#reste_page { position:absolute; top:50px; left:10px; }
.pendule { font-family:Arial; font-size:24px; color:blue; }
.reste_page { font-family:Arial; color:black; }
--&gt;
&lt;/style&gt;

&lt;/head&gt;
&lt;body onLoad=&quot;window.setTimeout('afficher_heure()',1000)&quot;&gt;

&lt;div id=&quot;pendule&quot; class=&quot;pendule&quot;&gt;&amp;nbsp;&lt;/div&gt;

&lt;div id=&quot;reste_page&quot; class=&quot;reste_page&quot;&gt;

&lt;h1&gt;Bienvenue sur cette page&lt;/h1&gt;
&lt;p&gt;ici &ccedil;a continue tout ï¿½ fait normalement&lt;/p&gt;

&lt;/div&gt;
&lt;/body&gt;&lt;/html&gt;
</pre></td></tr></table>

<h3 class="xpl">Explication:</h3>

<p>Dans le corps du fichier HTML de l'exemple ont &eacute;t&eacute; d&eacute;finis deux passages <code>div</code>. Les deux passages re&ccedil;oivent un nom Id et se voient affecter par leur nom Id respectif dans le passage  <code>style</code> de l'ent&ecirc;te de fichier, des propri&eacute;t&eacute;s CSS correspondantes. Les deux passages sont positionn&eacute;s de fa&ccedil;on absolue. Sans cette astuce, tout ceci ne pourrait pas &ecirc;tre r&eacute;alis&eacute; avec Netscape 4.x. Le premier passage sert &agrave; l'affichage de l'heure et de la date, et le deuxi&egrave;me passage contient tout le reste du fichier, ce pourquoi il porte le nom <code>reste_page</code>.</p>

<p>Le premier passage ne contient dans un premier temps qu'un espace impos&eacute;. Ainsi, on ne voit tout d'abord rien du passage mais l'espace est important pour que le passage ait un contenu. Sinon le premier acc&egrave;s dynamique &agrave; son contenu avec un navigateur supportant le mod&egrave;le DOM ou avec les fonctions de la biblioth&egrave;que DHTML provoquerait une erreur.</p>

<p>Par ailleurs, le fichier d'exemple contient deux passages script dans l'ent&ecirc;te de fichier. Dans le premier passage JavaScript vide est incorpor&eacute;e la biblioth&egrave;que de fonctions, dans le deuxi&egrave;me se trouve la fonction <code>afficher_heure()</code>, qui assume l'affichage de l'heure et de la date. Dans le rep&egrave;re d'ouverture <code>&lt;body&gt;</code> est not&eacute; le <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/langage/gestevenements.htm"><b>gestionnaire d'&eacute;v&eacute;nement</b></a> <code>onLoad</code>, qui entre en action quand le fichier et toutes les ressources qui lui sont incorpor&eacute;es sont charg&eacute;s compl&egrave;tement. &Agrave; ce gestionnaire d'&eacute;v&eacute;nement est affect&eacute; un appel de fonction. Il lance la fonction <code>afficher_heure()</code>, incorpor&eacute;e cependant dans une instruction <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/objets/window.htm#set_timeout"><b>setTimeout</b></a> qui diff&egrave;re l'appel d'une seconde ou plut&ocirc;t de 1000 milli&egrave;mes de seconde. Dans la premi&egrave;re seconde, rien encore n'est donc encore affich&eacute;.</p>

<p>Dans la fonction <code>afficher_heure()</code> est d&eacute;fini dans un premier temps est d&eacute;fini un  <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/objets/array.htm"><b>tableau</b></a> pour les jours de semaine en fran&ccedil;ais. Enfin la fonction recherche &agrave; l'aide de l'objet <img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information">&nbsp;<a href="../../javascript/objets/date.htm"><b>Date</b></a> l'heure et la date actuelles. &Agrave; l'aide de diff&eacute;rentes commandes de formatage, elle cr&eacute;e ensuite une cha&icirc;ne de caract&egrave;res qui contient une repr&eacute;sentation correcte de la date et de l'heure d'apr&egrave;s les conventions fran&ccedil;aises. Cette cha&icirc;ne de caract&egrave;res est sauvegard&eacute;e dans la variable nomm&eacute;e <code>tout</code>. Toutes ces choses n'ont encore rien &agrave; voir avec l'affichage.</p>

<p>La partie DHTML proprement-dite n'est pas un gros probl&egrave;me gr&acirc;ce &agrave; la biblioth&egrave;que DHTML incorpor&eacute;e. Avec <code>if(DHTML)</code> il est d'abord demand&eacute; si HTML dynamique est bien disponible. Tout le code pour &eacute;crire de fa&ccedil;on dynamique dans le passage <code>div</code> en d&eacute;pend. Ainsi les messages d'erreur, dans les navigateurs qui supportent JavaScript certes mais pas HTML dynamique, sont-ils &eacute;vit&eacute;s. Ensuite, il est demand&eacute; s'il est travaill&eacute; avec l'ancien mod&egrave;le Netscape. Dans l'affirmative, l'&eacute;criture dynamique dans le passage <code>div</code> est un peu diff&eacute;rente que celle des autres cas. La raison en est une autre faiblesse du navigateur Netscape 4. Il ignorerait la classe CSS  <code>pendule</code> dans le rep&egrave;re d'ouverture <code>div</code>, si on ne lui &eacute;crivait pas une autre fois sous la forme d'un &eacute;l&eacute;ment <code>span</code> dans le passage dynamique. Ce n'est que de cette fa&ccedil;on que l'affichage de la date et de l'heure re&ccedil;oit les formatages CSS qui ont &eacute;t&eacute; fix&eacute;s dans le passage  <code>style</code> de l'ent&ecirc;te de fichier pour la classe <code>pendule</code>. La modification dynamique du contenu de  <code>div</code> a lieu par l'appel de la fonction de biblioth&egrave;que <code>setCont()</code> qui s'occupe de tous les autres d&eacute;tails.</p>

<p>Dans la derni&egrave;re instruction de la fonction <code>afficher_heure()</code> la fonction s'appelle elle-m&ecirc;me et cela avec un d&eacute;lai de 1000 milli&egrave;mes de seconde ou une seconde provoqu&eacute; par <code>window.setTimeout()</code>. Ainsi pendant une seconde il ne se passe rien, puis l'heure est &agrave; nouveau inscrite.</p>



<table cellpadding="4" cellspacing="0" border="0" width="100%">
<tr><td colspan="2" bgcolor="#EEEEEE" class="doc">
&#160;<a href="#top"><img src="../../src/haut.gif" width="14" height="10" border="0" alt="vers le haut"></a>
</td></tr>
<tr><td bgcolor="#EEEEEE" class="doc" align="right"><a href="livreimages.htm"><img src="../../src/suivant.gif" width="10" height="10" border="0" hspace="10" alt="page suivante"></a></td>
<td bgcolor="#FFFFFF"><img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information"> <a href="livreimages.htm"><b>Livre d'images &agrave; feuilleter</b></a>
</td></tr>
<tr>
<td bgcolor="#EEEEEE" class="doc" align="right"><a href="navigation.htm"><img src="../../src/precedent.gif" width="10" height="10" border="0" hspace="10" alt="page pr&eacute;c&eacute;dente"></a></td>
<td bgcolor="#FFFFFF" width="100%"><img src="../../src/doc.gif" width="15" height="10" border="0" alt="Autre page d'information"> <a href="navigation.htm"><b>Barre de navigation dynamique
</b></a>
</td>
</tr>
<tr><td colspan="2" bgcolor="#EEEEEE" class="doc">&#160;</td></tr>
</table><table cellpadding="4" cellspacing="0" border="0" width="100%">
<tr>
<td bgcolor="#FFEEDD" class="nav"><a class="an" name="bottom"><img src="../../src/refchap.gif" width="16" height="13" border="0" alt="Renvoie au chapitre d'origine"></a> <a href="../../index.htm"><b>SELFHTML</b></a>/<a href="../../navigation/index.htm" target="_parent">Aides &agrave; la navigation</a> <img src="../../src/refchap.gif" width="16" height="13" border="0" alt="Renvoie au chapitre d'origine"> <a href="../index.htm"><b>HTML dynamique</b></a> <img src="../../src/refchap.gif" width="16" height="13" border="0" alt="Renvoie au chapitre d'origine"> <a href="index.htm"><b>Solutions pour la pratique</b></a></td>
</tr>
</table>

<p>&copy; 2001 Stefan M&uuml;nz / &copy; 2003 Traduction <img src="../../src/courriel.gif" width="15" height="10" border="0" alt="Adresse &eacute;lectronique">&nbsp;<a href="mailto:13405@free.fr">Serge Fran&ccedil;ois, 13405@free.fr</a><br><img src="../../src/courriel.gif" width="15" height="10" border="0" alt="Adresse &eacute;lectronique">&nbsp;<a href="mailto:selfhtml@selfhtml.com.fr">selfhtml@selfhtml.com.fr</a></p>



</body>
</html>
