<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Configuration &agrave; l'ex&eacute;cution</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mysqlnd.install.html">« Installation</a></li>
      <li style="float: right;"><a href="mysqlnd.incompatibilities.html">Incompatibilit&eacute;s »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.mysqlnd.html">Mysqlnd</a></li>
    <li>Configuration &agrave; l'ex&eacute;cution</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="mysqlnd.config" class="chapter">
 
 <h1>Configuration à l&#039;exécution</h1>

 <p class="simpara">Le comportement de ces fonctions est
affecté par la configuration dans le fichier <var class="filename">php.ini</var>.</p>
 
 <p class="para">
  <table class="doctable table">
   <caption><strong>Options de configuration de MySQL Native Driver</strong></caption>
    
     <thead>
      <tr>
       <th>Nom</th>
       <th>Défaut</th>
       <th>Modifiable</th>
       <th>Historique</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td><a href="mysqlnd.config.html#ini.mysqlnd.collect-statistics" class="link">mysqlnd.collect_statistics</a></td>
       <td>&quot;1&quot;</td>
       <td>PHP_INI_SYSTEM</td>
       <td>Disponible depuis PHP 5.3.0.</td>
      </tr>

      <tr>
       <td><a href="mysqlnd.config.html#ini.mysqlnd.collect-memory-statistics" class="link">mysqlnd.collect_memory_statistics</a></td>
       <td>&quot;0&quot;</td>
       <td>PHP_INI_SYSTEM</td>
       <td>Disponible depuis PHP 5.3.0.</td>
      </tr>

      <tr>
       <td><a href="mysqlnd.config.html#ini.mysqlnd.debug" class="link">mysqlnd.debug</a></td>
       <td>&quot;&quot;</td>
       <td>PHP_INI_SYSTEM</td>
       <td>Disponible depuis PHP 5.3.0.</td>
      </tr>

      <tr>
       <td><a href="mysqlnd.config.html#ini.mysqlnd.log-mask" class="link">mysqlnd.log_mask</a></td>
       <td>0</td>
       <td>PHP_INI_ALL</td>
       <td>Disponible depuis PHP 5.3.0</td>
      </tr>

      <tr>
       <td><a href="mysqlnd.config.html#ini.mysqlnd.mempool-default-size" class="link">mysqlnd.mempool_default_size</a></td>
       <td>16000</td>
       <td>PHP_INI_ALL</td>
       <td>Disponible depuis PHP 5.3.3</td>
      </tr>

      <tr>
      <td><a href="mysqlnd.config.html#ini.mysqlnd.net-read-timeout" class="link">mysqlnd.net_read_timeout</a></td>
      <td>&quot;86400&quot;</td>
      <td>PHP_INI_ALL</td>
      <td>
       Disponible depuis PHP 5.3.0. Avant PHP 7.2.0 la valeur par défaut était &quot;31536000&quot;
       et la variabilité était <strong><code>PHP_INI_SYSTEM</code></strong>
      </td>
     </tr>

      <tr>
       <td><a href="mysqlnd.config.html#ini.mysqlnd.net-cmd-buffer-size" class="link">mysqlnd.net_cmd_buffer_size</a></td>
       <td>5.3.0 - &quot;2048&quot;, 5.3.1 - &quot;4096&quot;</td>
       <td>PHP_INI_SYSTEM</td>
       <td>Disponible depuis PHP 5.3.0.</td>
      </tr>

      <tr>
       <td><a href="mysqlnd.config.html#ini.mysqlnd.net-read-buffer-size" class="link">mysqlnd.net_read_buffer_size</a></td>
       <td>&quot;32768&quot;</td>
       <td>PHP_INI_SYSTEM</td>
       <td>Disponible depuis PHP 5.3.0.</td>
      </tr>

      <tr>
       <td><a href="mysqlnd.config.html#ini.mysqlnd.sha256-server-public-key" class="link">mysqlnd.sha256_server_public_key</a></td>
       <td>&quot;&quot;</td>
       <td>PHP_INI_PERDIR</td>
       <td>Disponible depuis PHP 5.5.0.</td>
      </tr>

      <tr>
       <td><a href="mysqlnd.config.html#ini.mysqlnd.trace-alloc" class="link">mysqlnd.trace_alloc</a></td>
       <td>&quot;&quot;</td>
       <td>PHP_INI_SYSTEM</td>
       <td>Disponible depuis PHP 5.5.0.</td>
      </tr>

      <tr>
      <td><a href="mysqlnd.config.html#ini.mysqlnd.fetch_data_copy" class="link">mysqlnd.fetch_data_copy</a></td>
      <td>0</td>
      <td>PHP_INI_ALL</td>
      <td>Disponible depuis PHP 5.6.0.</td>
     </tr>
      
     </tbody>
    
   </table>

   Pour plus de détails sur les modes PHP_INI_*,
        reportez-vous à <a href="configuration.changes.modes.html" class="xref">O&ugrave; une directive de configuration peut &ecirc;tre modifi&eacute;e</a>.
 </p>
 
 <p class="para">Voici un éclaircissement sur
l&#039;utilisation des directives de configuration.</p>
 
 <p class="para">
  <dl>

   
    <dt id="ini.mysqlnd.collect-statistics">
     <code class="parameter">mysqlnd.collect_statistics</code>
     <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
    </dt>

    <dd>

     <p class="para">
      Active la collecte de différentes statistiques du client auxquelles vous
      pouvez accéder via <span class="function"><a href="function.mysqli-get-client-stats.html" class="function">mysqli_get_client_stats()</a></span>,
      <span class="function"><a href="mysqli.get-connection-stats.html" class="function">mysqli_get_connection_stats()</a></span>,
      <span class="function"><a href="function.mysqli-get-cache-stats.html" class="function">mysqli_get_cache_stats()</a></span> et qui sont aussi décrites
      dans la section <code class="literal">mysqlnd</code> de la sortie de la fonction
      <span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span>.
     </p>
     <p class="para">
      Ce paramètre active toutes
      <a href="mysqlnd.stats.html" class="link"> les statistiques de MySQL Native Driver
      </a> sauf celles relatives à la gestion de la mémoire.
     </p>
    </dd>

    
    
     <dt id="ini.mysqlnd.collect-memory-statistics">
      <code class="parameter">mysqlnd.collect_memory_statistics</code>
      <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
     </dt>

     <dd>

      <p class="para">
       Active la collecte de différentes statistiques concernant la mémoire
       qui peuvent être consultées via
       <span class="function"><a href="function.mysqli-get-client-stats.html" class="function">mysqli_get_client_stats()</a></span>,
       <span class="function"><a href="mysqli.get-connection-stats.html" class="function">mysqli_get_connection_stats()</a></span>,
       <span class="function"><a href="function.mysqli-get-cache-stats.html" class="function">mysqli_get_cache_stats()</a></span> et qui sont aussi montrées dans
       la section <code class="literal">mysqlnd</code> de la sortie de la fonction
       <span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span>.
      </p>
      <p class="para">
       Ce paramètre active les statistiques de gestion de la mémoire parmi
       <a href="mysqlnd.stats.html" class="link">les statistiques fournies par MySQL
        Native Driver</a>.
      </p>
     </dd>

    
    
     <dt id="ini.mysqlnd.debug">
      <code class="parameter">mysqlnd.debug</code> <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
     </dt>

     <dd>

      <p class="para">
       Journalise les communications en provenance de toute extension utilisant
       <code class="literal">mysqlnd</code>.
      </p>
      <p class="para">
       Le format de cette directive est <code class="literal">mysqlnd.debug =
       &quot;option1[,parameter_option1][:option2[,parameter_option2]]&quot;</code>.
      </p>
      <p class="para">
       Les options de formatage des chaines sont les suivantes:
      </p>
      <ul class="itemizedlist">
       <li class="listitem">
        <p class="para">
         A[,file] - Ajoute la trace à un fichier. S&#039;assure que les données sont écrites
         après chaque écriture en fermant puis rouvrant le fichier de trace (lent). Ceci
         aide à s&#039;assurer que le fichier de traces sera complet même si l&#039;application crash.
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         a[,file] - Ajoute la trace à un fichier.
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         d - Active la sortie depuis les macros DBUG_&lt;N&gt; pour l&#039;état actuel.
         Peut être suivi d&#039;une liste de mots-clés qui selectionnent la sortie seulement
         pour les macros DBUG avec ce mot-clé (filtre). Une liste vide de mot-clé
         sélectionnera tout.
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         f[,functions] - Limite les actions du débogueur à une liste spécifique de fonctions.
         Une liste vide fera en sorte que toutes les fonctions seront utilisées.
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         F - Marque chaque ligne de débogage du nom du fichier source contenant la macro
         causant cette sortie.
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         i - Marque chaque ligne de débogage du PID.
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         L - Marque chaque ligne de débogage du nom du fichier source ainsi que de la ligne
         de la macro qui cause cette sortie.
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         n - Marque chaque ligne de débogage de la profondeur actuelle de la fonction.
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         o[,file] - Similaire à a[,file] mais écrase les fichiers plutôt que de les
         compléter.
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         O[,file] - Similaire à A[,file] mais écrase les fichiers plutôt que de les
         compléter.
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         t[,N] - Active le traçage du flux de contrôle des fonctions. La profondeur maximale
         est précisée par N, par défaut 200.
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         x - Active le profilage.
        </p>
       </li>
       <li class="listitem">
        <p class="para">
         m - Trace les allocations et désallocations de mémoire.
        </p>
       </li>       
      </ul>
      <p class="para">
       Exemple:
      </p>
      <div class="example-contents">
<div class="cdata"><pre>
d:t:x:O,/tmp/mysqlnd.trace
</pre></div>
     </div>

     <blockquote class="note"><p><strong class="note">Note</strong>: 
      <p class="para">
       Cette caractéristique n&#039;est disponible que pour les versions debug de PHP.
       Fonctionne sur Microsoft Windows si PHP est en version debug et construit avec
       Microsoft Visual C version 9 et supérieures.
      </p>
     </p></blockquote>
     <p class="para"/>
    </dd>

    
    
     <dt id="ini.mysqlnd.log-mask">
      <code class="parameter">mysqlnd.log_mask</code>
      <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
     </dt>

     <dd>

      <p class="para">
       Définit quelle requête sera historisée. Par défaut, vaut 0, ce qui signifie
       que les logs sont désactivés. Il convient de définir cette option en utilisant
       un entier, et non une constante PHP. Par exemple, une valeur de
       48 (16 + 32) va historiser les requêtes lentes qui utilisent soit &#039;no good index&#039; 
       (SERVER_QUERY_NO_GOOD_INDEX_USED = 16) soit aucun index du tout (SERVER_QUERY_NO_INDEX_USED = 32).
       Une valeur de 2043 (1 + 2 + 8 + ... + 1024) historisera tout type de requêtes lentes.
      </p>
      <p class="para">
       Les types sont les suivants : SERVER_STATUS_IN_TRANS=1, SERVER_STATUS_AUTOCOMMIT=2,
       SERVER_MORE_RESULTS_EXISTS=8, SERVER_QUERY_NO_GOOD_INDEX_USED=16, SERVER_QUERY_NO_INDEX_USED=32,
       SERVER_STATUS_CURSOR_EXISTS=64, SERVER_STATUS_LAST_ROW_SENT=128, SERVER_STATUS_DB_DROPPED=256,
       SERVER_STATUS_NO_BACKSLASH_ESCAPES=512, et SERVER_QUERY_WAS_SLOW=1024.
      </p>
     </dd>

    
    
     <dt id="ini.mysqlnd.mempool-default-size">
      <code class="parameter">mysqlnd.mempool_default_size</code>
      <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
     </dt>

     <dd>

      <p class="para">
       Taille par défaut de la file d&#039;attente mémoire mysqlnd, utilisée par les jeux
       de résultats.
      </p>
     </dd>

    
    
     <dt id="ini.mysqlnd.net-read-timeout">
      <code class="parameter">mysqlnd.net_read_timeout</code>
      <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
     </dt>

     <dd>

      <p class="para">
       <code class="literal">mysqlnd</code> et la MySQL Client Library,
       <code class="literal">libmysqlclient</code> utilise des API réseau différentes.
       <code class="literal">mysqlnd</code> utilise les flux PHP, alors que
       <code class="literal">libmysqlclient</code> utilise sa propre implémentation basée sur
       le système. PHP, par défaut, utilise un timeout en lecture de 60s. Ceci
       en utilisant le paramètre de <var class="filename">php.ini</var>,
       <code class="literal">default_socket_timeout</code>. Ceci s&#039;applique à tous les flux
       qui ne précisent pas de timeout par défaut.
       <code class="literal">mysqlnd</code> n&#039;affecte aucune autre valeur et donc des requêtes
       longues peuvent se voir déconnectées après
       <code class="literal">default_socket_timeout</code> secondes avec comme résultat
       un message d&#039;erreur <q class="quote">2006 - MySQL Server has gone
       away</q>. La MySQL Client Library affecte un timeout par défaut de
       24 * 3600 secondes (1 jour) et attend les autres timeout, comme ceux de
       TCP/IP. <code class="literal">mysqlnd</code> utilise maintenant le même timeout très long.
       La valeur est configurable via le paramètre <var class="filename">php.ini</var>
       <code class="literal">mysqlnd.net_read_timeout</code>.
       <code class="literal">mysqlnd.net_read_timeout</code> est donc utilisé par toute extension
       (<code class="literal">ext/mysql</code>, <code class="literal">ext/mysqli</code>,
       <code class="literal">PDO_MySQL</code>) qui se repose sur
       <code class="literal">mysqlnd</code>. <code class="literal">mysqlnd</code> indique aux flux PHP d&#039;utiliser
       <code class="literal">mysqlnd.net_read_timeout</code>. Notez qu&#039;il peut y avoir des différences
       subtiles entre
       <code class="literal">MYSQL_OPT_READ_TIMEOUT</code> de la MySQL Client Library et les flux
       PHP, par exemple <code class="literal">MYSQL_OPT_READ_TIMEOUT</code> est dite fonctionnelle
       uniquement avec des connexions TCP/IP et, avant MySQL 5.1.2, seulement sous Windows.
       Les flux PHP, eux, n&#039;ont pas cette limite. Voyez la documentation des flux en cas
       de doute.
      </p>
     </dd>

    
    
     <dt id="ini.mysqlnd.net-cmd-buffer-size">
      <code class="parameter">mysqlnd.net_cmd_buffer_size</code>
      <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
     </dt>

     <dd>

      <p class="para">
       <code class="literal">mysqlnd</code> alloue un buffer interne pour le réseau d&#039;une taille
       de <code class="literal">mysqlnd.net_cmd_buffer_size</code> (dans
       <var class="filename">php.ini</var>) octets pour chaque connexion. Si une commande du
       protocole MySQL Client Server, par exemple,
       <code class="literal">COM_QUERY</code> (requête  <q class="quote">normale</q>), ne rentre pas dans
       le buffer, <code class="literal">mysqlnd</code> va agrandir celui-ci à la taille requise.
       A chaque fois que le buffer est agrandi pour une connexion,
       <code class="literal">command_buffer_too_small</code> va être incrémenté de un.
      </p>
      <p class="para">
       Si <code class="literal">mysqlnd</code> doit agrandir le buffer au-delà de sa taille initiale de
       <code class="literal">mysqlnd.net_cmd_buffer_size</code> octets pour presque toutes les connexions,
       vous devriez alors augmenter cette taille par défaut afin d&#039;éviter les ré-allocations.
      </p>
      <p class="para">
       La taille par défaut du buffer est de 2048 octets dans PHP 5.3.0. Dans les versions
       suivantes, 4096 octets.
      </p>
      <p class="para">
       Il est recommandé d&#039;avoir une taille de buffer au moins égale à 4096
       octets car <code class="literal">mysqlnd</code> l&#039;utilise aussi lors de la lecture
       de certains paquets de communication avec MySQL. Dans PHP 5.3.0,
       <code class="literal">mysqlnd</code> n&#039;augmentera pas le buffer si MySQL envoie
       un paquet plus grand que la taille du buffer. Ainsi,
       <code class="literal">mysqlnd</code> ne peut pas décoder le paquet et l&#039;application
       cliente recevra une erreur. Il n&#039;y a que deux situations dans lesquelles le
       paquet peut être plus grand que les 2048 octets par défaut de
       <code class="literal">mysqlnd.net_cmd_buffer_size</code> sous PHP 5.3.0: le paquet
       véhicule un message d&#039;erreur très long, ou le paquet contient des méta
       données de colonnes provenant de <code class="literal">COM_LIST_FIELD</code>
       (<code class="literal">mysql_list_fields()</code>, méta données d&#039;une colonne de type
       string avec une valeur par défaut très grande (&gt;1900 octets).
      </p>
      <p class="para">
       Depuis PHP 5.3.2, mysqlnd n&#039;autorise plus l&#039;affectation de buffers inférieurs
       à 4096 octets.
      </p>
      <p class="para">
       La valeur peut aussi être changée au moyen de <code class="literal">mysqli_options(link,
       MYSQLI_OPT_NET_CMD_BUFFER_SIZE, size)</code>.
      </p>
     </dd>

    
    
     <dt id="ini.mysqlnd.net-read-buffer-size">
      <code class="parameter">mysqlnd.net_read_buffer_size</code>
      <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
     </dt>

     <dd>

      <p class="para">
       Taille maximale du segment en lecture lors de la lecture du corps d&#039;un
       paquet de commande MySQL. Le protocole serveur de MySQL encapsule toutes
       ses commandes dans des paquets. Les paquets consistent en un en-tête court
       suivi d&#039;un corps contenant les infos. La taille du corps est encodée dans
       l&#039;en-tête. <code class="literal">mysqlnd</code> lit le corps sous forme de segments
       de <code class="literal">MIN(header.size, mysqlnd.net_read_buffer_size)</code>
       octets. Si le corps d&#039;un paquet est plus grand que
       <code class="literal">mysqlnd.net_read_buffer_size</code> octets,
       <code class="literal">mysqlnd</code> doit alors appeler <code class="literal">read()</code>
       plusieurs fois.
      </p>
      <p class="para">
       La valeur peut aussi être changée au moyen de <code class="literal">mysqli_options(link,
       MYSQLI_OPT_NET_READ_BUFFER_SIZE, size)</code>.
      </p>
     </dd>

    
    
    <dt id="ini.mysqlnd.sha256-server-public-key">
      <code class="parameter">mysqlnd.sha256_server_public_key</code>
      <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
     </dt>

     <dd>

      <p class="para">
       En rapport avec le plugin d&#039;authentification SHA-256.
       Fichier contenant la clé publique RSA sur serveur MySQL.
      </p>
      <p class="para">
       Les clients peuvent soit ommettre de définir une clé publique RSA et spécifier
       la clé via la directive de configuration PHP, ou bien, définir la clé
       au moment de l&#039;exécution en utilisant la fonction <span class="function"><a href="mysqli.options.html" class="function">mysqli_options()</a></span>.
       Si aucun fichier de clé publique RSA n&#039;est fourni par le client, alors la clé
       sera échangé conformément à la procédure du plugin d&#039;authentification standard
       SHA-256.
      </p>
     </dd>

    
   
    <dt id="ini.mysqlnd.trace-alloc">
     <code class="parameter">mysqlnd.trace_alloc</code>
     <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
    </dt>

    <dd>

     <p class="para">
     </p>
    </dd>

   
   
    <dt id="ini.mysqlnd.fetch_data_copy">
     <code class="parameter">mysqlnd.fetch_data_copy</code>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </dt>

    <dd>

     <p class="para">
      Impose la copie des jeux de résultats depuis les tampons internes vers 
      des variables PHP au lieu d&#039;utiliser le mécanisme par défaut de référence 
      et de copie sur écriture. Veuillez vous référer aux, 
      <a href="mysqlnd.memory.html" class="link">notes d&#039;implémentation sur la gestion de mémoire</a> 
      pour plus de détails.
     </p>
     <p class="para">
      Copier les jeux de résultats au lieu d&#039;avoir des variables PHP les référencant permet de libérér au plus tot la mémoire occupée par les variables PHP. En fonction du code de l&#039;API cliente, les requêtes actuelles et de la taille de leurs jeux de résultats, ceci peut réduire l&#039;empreinte mémoire de mysqlnd.      
     </p>
     <p class="para">
       Ne pas activer avec PDO_MySQL. PDO_MySQL ne supporte pas encore ce mode.
     </p>
    </dd>

   
   </dl>

 </p>
 
</div>
</div></div></body></html>