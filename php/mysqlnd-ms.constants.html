<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Constantes pr&eacute;-d&eacute;finies</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mysqlnd-ms.plugin-ini-json.html">« Fichier de configuration du plugin (&gt;=1.1.x)</a></li>
      <li style="float: right;"><a href="ref.mysqlnd-ms.html">Fonctions Mysqlnd_ms »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.mysqlnd-ms.html">mysqlnd_ms</a></li>
    <li>Constantes pr&eacute;-d&eacute;finies</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="mysqlnd-ms.constants" class="appendix">
 <h1>Constantes pré-définies</h1>

 <p class="simpara">Ces constantes sont définies par cette
extension, et ne sont disponibles que si cette extension a été compilée avec
PHP, ou bien chargée au moment de l&#039;exécution.</p>
 
 <p class="para">
  <em class="emphasis">Astuces SQL concernées</em>
 </p>
 <p class="para">
  <div class="example" id="example-2252">
   <p><strong>Exemple #1 Exemple montrant l&#039;utilisation des constantes mysqlnd_ms</strong></p>
   <div class="example-contents"><p>
    Le plugin de réplication et de balance de charge (<code class="literal">mysqlnd_ms</code>)
    effectue une séparation des lectures et des écritures pour diriger
    les requêtes d&#039;écriture vers un serveur MySQL maître, et les requêtes
    de lecture vers un serveur MySQL esclave. Le plugin a une logique interne
    de séparation lecture/écriture. Elle est relativement basique.
    Toutes les requêtes qui commencent par <code class="literal">SELECT</code> sont
    considérées comme des requêtes en lecture qui sont envoyées
    vers un serveur MySQL esclave listé dans le fichier de configuration du
    plugin. Toutes les autres requêtes sont redirigées vers le serveur
    MySQL maître spécifié dans le fichier de configuration du plugin.
   </p></div>
   <div class="example-contents"><p>
    Les astuces SQL fournies par l&#039;utilisateur peuvent être utilisées
    pour écraser ce comportement, afin d&#039;en maîtriser totalement le processus.
    Les astuces SQL sont des commentaires standards SQL. Le plugin analysera
    le début de la chaîne de requête pour y trouver un commentaire SQL avec
    des commandes spécifiques, qui contrôlera la redirection de la requête.
    Les autres systèmes intervenant dans le processus de la requête
    ne sont pas affectés par les astuces SQL, tout simplement parcequ&#039;ils
    les ignoreront.
   </p></div>
   <div class="example-contents"><p>
    Le plugin supporte 3 astuces SQL pour diriger les requêtes vers un des
    serveurs MySQL esclaves, le serveur MySQL maître, ou vers le
    dernier serveur MySQL utilisé. Les astuces SQL doivent être placées en
    début de requête pour être reconnues par le plugin.
   </p></div>
   <div class="example-contents"><p>
    Pour des raisons de portabilité, il est recommandé d&#039;utiliser les constantes
    <strong><code>MYSQLND_MS_MASTER_SWITCH</code></strong>,
    <strong><code>MYSQLND_MS_SLAVE_SWITCH</code></strong> et
    <strong><code>MYSQLND_MS_LAST_USED_SWITCH</code></strong> au lieu de leurs
    valeurs littérales.
   </p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;utilisation&nbsp;des&nbsp;constantes&nbsp;pour&nbsp;une&nbsp;portabilité&nbsp;maximale&nbsp;*/<br /></span><span style="color: #0000BB">$master_query&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"/*"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">MYSQLND_MS_MASTER_SWITCH&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"*/SELECT&nbsp;id&nbsp;FROM&nbsp;test"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;Valide,&nbsp;mais&nbsp;moins&nbsp;portable&nbsp;:&nbsp;utilisation&nbsp;littérale&nbsp;au&nbsp;lieu&nbsp;des&nbsp;constantes&nbsp;*/<br /></span><span style="color: #0000BB">$slave_query&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"/*ms=slave*/SHOW&nbsp;TABLES"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"master_query&nbsp;=&nbsp;'%s'\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$master_query</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"slave_query&nbsp;=&nbsp;'%s'\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$slave_query</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>Les exemples ci-dessus vont afficher :</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
master_query = /*ms=master*/SELECT id FROM test
slave_query = /*ms=slave*/SHOW TABLES
</pre></div>
   </div>
  </div>
 </p>
 <p class="para">
  <dl>

   
    <dt id="constant.mysqlnd-ms-master-switch">
     <strong><code>MYSQLND_MS_MASTER_SWITCH</code></strong>
     (<a href="language.types.string.html" class="link">chaîne de caractères</a>)
    </dt>

    <dd>

     <span class="simpara">
      Astuce SQL utilisée pour envoyer une requête au serveur MySQL maître de réplication.
     </span>
    </dd>

   
   
    <dt id="constant.mysqlnd-ms-slave-switch">
     <strong><code>MYSQLND_MS_SLAVE_SWITCH</code></strong>
     (<a href="language.types.string.html" class="link">chaîne de caractères</a>)
    </dt>

    <dd>

     <span class="simpara">
      Astuce SQL utilisé pour envoyer une requête à un des serveurs MySQL esclaves de réplication.
     </span>
    </dd>

   
   
    <dt id="constant.mysqlnd-ms-last-used-switch">
     <strong><code>MYSQLND_MS_LAST_USED_SWITCH</code></strong>
     (<a href="language.types.string.html" class="link">chaîne de caractères</a>)
    </dt>

    <dd>

     <span class="simpara">
      Astuce SQL utilisé pour envoyer une requête au dernier serveur MySQL utilisé.
      Ce peut être soit un maître, soit un esclave.
     </span>
    </dd>

   
  </dl>

 </p>
 
 <p class="para">
  En rapport avec la fonction
  <span class="function"><a href="function.mysqlnd-ms-query-is-select.html" class="function">mysqlnd_ms_query_is_select()</a></span>
 </p>
 <p class="para">
  <dl>

   
    <dt id="constant.mysqlnd-ms-query-use-master">
     <strong><code>MYSQLND_MS_QUERY_USE_MASTER</code></strong>
     (<a href="language.types.integer.html" class="link">entier</a>)
    </dt>

    <dd>

     <span class="simpara">
      Si la fonction <span class="function"><strong>mysqlnd_ms_is_select()</strong></span> retourne
      <strong><code>MYSQLND_MS_QUERY_USE_MASTER</code></strong> pour une requête
      donnée, le mécanisme interne de séparation des lectures/écritures
      recommande d&#039;envoyer la requête vers un serveur MySQL maître de
      réplication.
     </span>
    </dd>

   
   
    <dt id="constant.mysqlnd-ms-query-use-slave">
     <strong><code>MYSQLND_MS_QUERY_USE_SLAVE</code></strong>
     (<a href="language.types.integer.html" class="link">entier</a>)
    </dt>

    <dd>

     <span class="simpara">
      Si la fonction <span class="function"><strong>mysqlnd_ms_is_select()</strong></span> retourne
      <strong><code>MYSQLND_MS_QUERY_USE_SLAVE</code></strong> pour une requête donnée,
      le mécanisme interne de séparation des lectures/écritures recommande
      d&#039;envoyer la requête vers un serveur MySQL esclave de réplication.
     </span>
    </dd>

   
   
    <dt id="constant.mysqlnd-ms-query-use-last-used">
     <strong><code>MYSQLND_MS_QUERY_USE_LAST_USED</code></strong>
     (<a href="language.types.integer.html" class="link">entier</a>)
    </dt>

    <dd>

     <span class="simpara">
      Si la fonction <span class="function"><strong>mysqlnd_ms_is_select()</strong></span> retourne
      <strong><code>MYSQLND_MS_QUERY_USE_LAST_USED</code></strong> pour une requête donnée,
      le mécanisme de séparation des lectures/écritures recommande d&#039;envoyer
      la requête vers le dernier serveur utilisé.
     </span>
    </dd>

   
  </dl>

 </p>

 <p class="para">
  <span class="function"><a href="function.mysqlnd-ms-set-qos.html" class="function">mysqlnd_ms_set_qos()</a></span>,
  en rapport avec la qualité du service des filtres et des niveaux de services
 </p>
 <p class="para">
  <dl>

   
    <dt id="constant.mysqlnd-ms-qos-consistency-eventual">
     <strong><code>MYSQLND_MS_QOS_CONSISTENCY_EVENTUAL</code></strong>
     (<a href="language.types.integer.html" class="link">entier</a>)
    </dt>

    <dd>

     <span class="simpara">
      Utilisé pour demander une éventuelle consistence du niveau de service
      depuis la fonction <span class="function"><a href="function.mysqlnd-ms-set-qos.html" class="function">mysqlnd_ms_set_qos()</a></span>.
      Une consistence éventuelle est la qualité par défaut du service lors
      d&#039;une lecture depuis un esclave de réplication asynchrone MySQL.
      Les données retournées dans ce niveau de service peuvent ou pas être
      non à jour, suivant si l&#039;esclave sélectionné a déjà répliqué les dernières
      modifications survenues sur le serveur maître de réplication MySQL.
     </span>
    </dd>

   
   
    <dt id="constant.mysqlnd-ms-qos-consistency-session">
     <strong><code>MYSQLND_MS_QOS_CONSISTENCY_SESSION</code></strong>
     (<a href="language.types.integer.html" class="link">entier</a>)
    </dt>

    <dd>

     <span class="simpara">
      Utilisé pour demander une consistence de session du niveau de service
      depuis la fonction <span class="function"><a href="function.mysqlnd-ms-set-qos.html" class="function">mysqlnd_ms_set_qos()</a></span>.
      Une consistence de session est défini pour lire vos écritures.
      Le client est garanti de voir ces propres dernières modifications.
     </span>
    </dd>

   
   
    <dt id="constant.mysqlnd-ms-qos-consistency-strong">
     <strong><code>MYSQLND_MS_QOS_CONSISTENCY_STRONG</code></strong>
     (<a href="language.types.integer.html" class="link">entier</a>)
    </dt>

    <dd>

     <span class="simpara">
      Utilisé pour demander une consistence forte du niveau de service
      depuis la fonction <span class="function"><a href="function.mysqlnd-ms-set-qos.html" class="function">mysqlnd_ms_set_qos()</a></span>.
      Une consistence forte est utilisée pour assurer à tous les clients
      de voir chaque modification effectuée par les autres.
     </span>
    </dd>

   
   
    <dt id="constant.mysqlnd-ms-qos-option-gtid">
     <strong><code>MYSQLND_MS_QOS_OPTION_GTID</code></strong>
     (<a href="language.types.integer.html" class="link">entier</a>)
    </dt>

    <dd>

     <span class="simpara">
      Utilisé comme une option du niveau de service avec la fonction
      <span class="function"><a href="function.mysqlnd-ms-set-qos.html" class="function">mysqlnd_ms_set_qos()</a></span> pour paramétrer la
      consistence de session.
     </span>
    </dd>

   
   
    <dt id="constant.mysqlnd-ms-qos-option-age">
     <strong><code>MYSQLND_MS_QOS_OPTION_AGE</code></strong>
     (<a href="language.types.integer.html" class="link">entier</a>)
    </dt>

    <dd>

     <span class="simpara">
      Utilisé comme une option du niveau de service avec la fonction
      <span class="function"><a href="function.mysqlnd-ms-set-qos.html" class="function">mysqlnd_ms_set_qos()</a></span> pour paramétrer une
      consistence éventuelle.
     </span>
    </dd>

   
  </dl>

 </p>
 
 <p class="para">
  <em class="emphasis">Autre</em>
 </p>
 <p class="para">
  Le numéro de version du plugin peut être obtenu en utilisant
  la constante <strong><code>MYSQLND_MS_VERSION</code></strong> ou la constante
  <strong><code>MYSQLND_MS_VERSION_ID</code></strong>. La constante
  <strong><code>MYSQLND_MS_VERSION</code></strong> est une représentation
  sous forme de chaîne de caractères du numéro de version numérique
  de la constante <strong><code>MYSQLND_MS_VERSION_ID</code></strong>, qui est un
  entier, comme 10000. Les développeurs peuvent calculer le numéro
  de version comme ceci :
 </p>
 <p class="para">
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>Version (partie)</th>
      <th>Exemple</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>Majeur*10000</td>
      <td>1*10000 = 10000</td>
     </tr>

     <tr>
      <td>Mineur*100</td>
      <td>0*100 = 0</td>
     </tr>

     <tr>
      <td>Patch</td>
      <td>0 = 0</td>
     </tr>

     <tr>
      <td>MYSQLND_MS_VERSION_ID</td>
      <td>10000</td>
     </tr>

    </tbody>
   
  </table>

 </p>
 <p class="para">
  <dl>

   
    <dt id="constant.mysqlnd-ms-version">
     <strong><code>MYSQLND_MS_VERSION</code></strong>
     (<a href="language.types.string.html" class="link">chaîne de caractères</a>)
    </dt>

    <dd>

     <span class="simpara">
      La chaîne représentant la version du plugin,
      par exemple, <q class="quote">1.0.0-prototype</q>.
     </span>
    </dd>

   
   
    <dt id="constant.mysqlnd-ms-version-id">
     <strong><code>MYSQLND_MS_VERSION_ID</code></strong>
     (<a href="language.types.integer.html" class="link">entier</a>)
    </dt>

    <dd>

     <span class="simpara">
      Le numéro de version du plugin, par exemple, 10000.
     </span>
    </dd>

   
  </dl>

 </p>
 
</div>
</div></div></body></html>