<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Ouvre une connexion persistante vers un serveur CUBRID</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.cubrid-num-rows.html">« cubrid_num_rows</a></li>
      <li style="float: right;"><a href="function.cubrid-pconnect.html">cubrid_pconnect »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.cubrid.html">Fonctions CUBRID</a></li>
    <li>Ouvre une connexion persistante vers un serveur CUBRID</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.cubrid-pconnect-with-url" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">cubrid_pconnect_with_url</h1>
  <p class="verinfo">(PECL CUBRID &gt;= 8.3.1)</p><p class="refpurpose"><span class="refname">cubrid_pconnect_with_url</span> &mdash; <span class="dc-title">Ouvre une connexion persistante vers un serveur CUBRID</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.cubrid-pconnect-with-url-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>cubrid_pconnect_with_url</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$conn_url</code></span>  
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$userid</code></span>  
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$passwd</code></span>  
  ]] ) : <span class="type">resource</span></div>

  <p class="para rdfs-comment">
   Établit une connexion persistante vers un serveur CUBRID.
  </p>
  <p class="para">
   <span class="function"><strong>cubrid_pconnect_with_url()</strong></span> agit de la même façon que la
   fonction <span class="function"><a href="function.cubrid-connect-with-url.html" class="function">cubrid_connect_with_url()</a></span>, avec deux différences majeures.
  </p>
  <p class="para">
   Tout d&#039;abord, lors de la connexion, la fonction tentera tout d&#039;abord de trouver
   un lien (persistant) déjà ouvert avec le même hôte, sur le même port, sur la
   même base de données dbname et utilisant le même userid. Si une telle connexion
   est trouvée, son identifiant sera retourné au lieu d&#039;ouvrir une nouvelle
   connexion.
  </p>
  <p class="para">
   Ensuite, la connexion vers le serveur MySQL ne sera pas fermée lorsque la fin
   du script sera atteint. Au lieu de cela, la connexion restera ouverte
   pour une utilisation future ( la fonction <span class="function"><a href="function.cubrid-close.html" class="function">cubrid_close()</a></span> ou la fonction
   <span class="function"><a href="function.cubrid-disconnect.html" class="function">cubrid_disconnect()</a></span> ne fermera pas la connexion établie par la fonction
   <span class="function"><strong>cubrid_pconnect_with_url()</strong></span>).
  </p>
  <p class="para">
   Ce type de lien était appelé, auparavant, &#039;persistant&#039;.
  </p>
  <p class="para">
   &lt;url&gt; ::= CUBRID:&lt;host&gt;:&lt;db_name&gt;:&lt;db_user&gt;:&lt;db_password&gt;:[?&lt;properties&gt;]
  </p>
  <p class="para">
   &lt;properties&gt; ::= &lt;property&gt; [&amp;&lt;property&gt;]
  </p>
  <p class="para">
   &lt;properties&gt; ::= alhosts=&lt;alternative_hosts&gt;[ &amp;rctime=&lt;time&gt;]
  </p>
  <p class="para">
   &lt;properties&gt; ::= login_timeout=&lt;milli_sec&gt;
  </p>
  <p class="para">
   &lt;properties&gt; ::= query_timeout=&lt;milli_sec&gt;
  </p>
  <p class="para">
   &lt;properties&gt; ::= disconnect_on_query_timeout=true|false
  </p>
  <p class="para">
   &lt;alternative_hosts&gt; ::= &lt;standby_broker1_host&gt;:&lt;port&gt; [,&lt;standby_broker2_host&gt;:&lt;port&gt;]
  </p>
  <p class="para">
   &lt;host&gt; := HOSTNAME | IP_ADDR
  </p>
  <p class="para">
   &lt;time&gt; := SECOND
  </p>
  <p class="para">
   &lt;milli_sec&gt; := MILLI SECOND
  </p>
  <p class="para">
   <ul class="simplelist">
    <li class="member">host : Un nom d&#039;hôte ou une adresse IP du serveur maître de base de données</li>
    <li class="member">db_name : Un nom de base de données</li>
    <li class="member">db_user : Un nom d&#039;utilisateur de la base de données</li>
    <li class="member">db_password : Un mot de passe pour l&#039;utilisateur de la base de données</li>
    <li class="member">autocommit : Le mode auto-commit de la connexion à la base de données</li>
    <li class="member">
     alhosts : Spécifie l&#039;information du broker du serveur, qui sera utilisé comme point de sortie
     lorsqu&#039;il est impossible de se connecter au serveur actif. Vous pouvez spécifier plusieurs brokers dans ce cas,
     et la connexion aux brokers sera tentée dans l&#039;ordre de la configuration alhosts
    </li>
    <li class="member">
     rctime : Un intervalle de temps à attendre avant de tenter une connexion vers un broker lorsqu&#039;une erreur
     survient. Après qu&#039;une erreur soit survenue, le système tentera une connexion vers un broker spécifié par
     althosts, termine la transaction, et ensuite, tente de se connecter au broker actif du serveur maître
     de base de données. La valeur par défaut est de 600 secondes.
    </li>
    <li class="member">
     login_timeout : Valeur du délai maximal d&#039;attente (unité : mseconde) pour l&#039;identification
     à la base de données. Par défaut, cette valeur vaut 0, ce qui signifie que l&#039;on attend
     indéfiniment.
    </li>
    <li class="member">
     query_timeout : Valeur du délai maximal d&#039;attente (unité : mseconde) pour l&#039;exécution
     de la requête. Une fois cette valeur atteinte, un message pour annuler la requête
     envoyée au serveur est envoyé. La valeur retournée peut dépendre de la configuration
     de disconnect_on_query_timeout configuration ; même si le message pour annuler
     la requête a été envoyée au serveur, la requête peut réussir.
    </li>
    <li class="member">
     disconnect_on_query_timeout : Configure une valeur déterminant si l&#039;on doit retourner
     immédiatement une erreur pour les fonctions exécutées après le délai maximal d&#039;attente.
     La valeur par défaut est <strong><code>FALSE</code></strong>.
    </li>
   </ul>
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    Les caractères <code class="literal">?</code> et <code class="literal">:</code>
    utilisés comme identifiants dans les URLs de connexion PHP ne peuvent
    être inclus dans le mot de passe. Voici un exemple de mot de passe
    invalide, car utilisant les caractères &quot;<code class="literal">?:</code>&quot; dans l&#039;URL de connexion.
   </p>
   <p class="para">
    $url = &quot;CUBRID:localhost:33000:tdb:dba:12?:?login_timeout=100&quot;;
   </p>
   <p class="para">
    Les mots de passe contenant le caractère <code class="literal">?</code> ou le
    caractère <code class="literal">:</code> peuvent être passés en tant que paramètre séparé.
   </p>
   <p class="para">
    $url = &quot;CUBRID:localhost:33000:tbd:::?login_timeout=100&quot;;
   </p>
   <p class="para">
    $conn = cubrid_pconnect_with_url ($url, &quot;dba&quot;, &quot;12?&quot;);
   </p>
   <p class="para">
    Si le nom d&#039;utilisateur ou le mot de passe est vide, vous ne devez
    pas supprimer les &quot;<code class="literal">:</code>&quot; ; voici un exemple :
   </p>
   <p class="para">
    $url = &quot;CUBRID:localhost:33000:demodb:::&quot;;
   </p>
  </p></blockquote>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-function.cubrid-pconnect-with-url-parameters">
  <h3 class="title">Liste de paramètres</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">conn_url</code></dt>

     <dd>

      <p class="para">
       Une <a href="language.types.string.html" class="link">chaîne de caractères</a> qui contient les informations de connexion pour le serveur.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">userid</code></dt>

     <dd>

      <p class="para">
       Nom d&#039;utilisateur pour la base de données.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">passwd</code></dt>

     <dd>

      <p class="para">
       Mot de passe pour l&#039;utilisateur.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.cubrid-pconnect-with-url-returnvalues">
  <h3 class="title">Valeurs de retour</h3>
  <p class="para">
   Identifiant de connexion, lorsque le processus réussit.
  </p>
  <p class="para">
   <strong><code>FALSE</code></strong>, lorsqu&#039;une erreur survient.
  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.cubrid-pconnect-with-url-examples">
  <h3 class="title">Exemples</h3>
  <div class="example" id="example-1135">
   <p><strong>Exemple #1 Exemple avec <span class="function"><strong>cubrid_pconnect_with_url()</strong></span> sans propriétés</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$conn_url&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"CUBRID:127.0.0.1:33000:demodb:dba::?althost=10.34.63.132:33088&amp;rctime=100"<br /></span><span style="color: #0000BB">$con&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">cubrid_pconnect_with_url&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn_url</span><span style="color: #007700">);<br /><br />if&nbsp;(</span><span style="color: #0000BB">$con</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Connexion&nbsp;réussie"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cubrid_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$con</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"create&nbsp;table&nbsp;person(id&nbsp;int,name&nbsp;char(16))"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$req&nbsp;</span><span style="color: #007700">=</span><span style="color: #0000BB">cubrid_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$con</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"insert&nbsp;into&nbsp;person&nbsp;values(1,'James')"</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$req</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cubrid_close_request&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$req</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cubrid_commit&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$con</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cubrid_rollback&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$con</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cubrid_disconnect&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$con</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
  
  <div class="example" id="example-1136">
   <p><strong>Exemple #2 <span class="function"><strong>cubrid_pconnect_with_url()</strong></span> url with properties example</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$conn_url&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"CUBRID:127.0.0.1:33000:demodb:dba::?autocommit=off&amp;althost=10.34.63.132:33088&amp;rctime=100"<br /></span><span style="color: #0000BB">$con&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">cubrid_pconnect_with_url&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn_url</span><span style="color: #007700">);<br /><br />if&nbsp;(</span><span style="color: #0000BB">$con</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Connexion&nbsp;réussie"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$req&nbsp;</span><span style="color: #007700">=</span><span style="color: #0000BB">cubrid_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$con</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"insert&nbsp;into&nbsp;person&nbsp;values(1,'James')"</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$req</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cubrid_close_request&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$req</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cubrid_commit&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$con</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cubrid_rollback&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$con</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cubrid_disconnect&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$con</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.cubrid-pconnect-with-url-seealso">
  <h3 class="title">Voir aussi</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.cubrid-connect.html" class="function" rel="rdfs-seeAlso">cubrid_connect()</a> - Ouvre une connexion au serveur CUBRID</span></li>
    <li class="member"><span class="function"><a href="function.cubrid-connect-with-url.html" class="function" rel="rdfs-seeAlso">cubrid_connect_with_url()</a> - &Eacute;tablit l'environnement pour une connexion au serveur CUBRID</span></li>
    <li class="member"><span class="function"><a href="function.cubrid-pconnect.html" class="function" rel="rdfs-seeAlso">cubrid_pconnect()</a> - Ouvre une connexion persistante vers un serveur CUBRID</span></li>
    <li class="member"><span class="function"><a href="function.cubrid-disconnect.html" class="function" rel="rdfs-seeAlso">cubrid_disconnect()</a> - Ferme la connexion &agrave; la base de donn&eacute;es</span></li>
    <li class="member"><span class="function"><a href="function.cubrid-close.html" class="function" rel="rdfs-seeAlso">cubrid_close()</a> - Ferme une connexion CUBRID</span></li>
   </ul>
  </p>
 </div>


</div></div></div></body></html>