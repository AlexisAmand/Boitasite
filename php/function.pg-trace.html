<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Active le suivi d'une connexion PostgreSQL</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.pg-socket.html">« pg_socket</a></li>
      <li style="float: right;"><a href="function.pg-transaction-status.html">pg_transaction_status »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.pgsql.html">Fonctions PostgreSQL</a></li>
    <li>Active le suivi d'une connexion PostgreSQL</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.pg-trace" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">pg_trace</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.1, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">pg_trace</span> &mdash; <span class="dc-title">
   Active le suivi d&#039;une connexion PostgreSQL
  </span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.pg-trace-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>pg_trace</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$pathname</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$mode</code><span class="initializer"> = &quot;w&quot;</span></span>
   [, <span class="methodparam"><span class="type">resource</span> <code class="parameter">$connection</code></span>
  ]] ) : <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>pg_trace()</strong></span> active le suivi des communications entre PHP et
   le serveur PostgreSQL. Cet historique sera enregistré dans un fichier.
   Pour comprendre ces lignes, il faut être familier avec le protocole
   de communication interne à PostgreSQL.
  </p>
  <p class="para">   
   Pour ceux qui le ne sont pas, elles peuvent être utiles pour suivre les
   requêtes et les erreurs : avec la commande
   <strong class="command">grep &#039;^To backend&#039; trace.log</strong>, vous pourrez voir les
   requêtes réellement envoyées au serveur PostgreSQL. Pour plus
   d&#039;informations, référez-vous à la 
   <a href="http://www.postgresql.org/docs/current/interactive/" class="link external">&raquo;&nbsp;Documentation PostgreSQL</a>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.pg-trace-parameters">
  <h3 class="title">Liste de paramètres</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">pathname</code></dt>

     <dd>

      <p class="para">
       Le chemin complet et le nom du fichier dans lequel le suivi sera
       enregistré. Comme <span class="function"><a href="function.fopen.html" class="function">fopen()</a></span>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">mode</code></dt>

     <dd>

      <p class="para">
       Le mode d&#039;accès optionnel, comme <span class="function"><a href="function.fopen.html" class="function">fopen()</a></span>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">connection</code></dt>

     <dd>

      <p class="para">
       La ressource de connexion de la base de données PostgreSQL. Lorsque
       <code class="parameter">connection</code> n&#039;est pas présent, la connexion par
       défaut est utilisée. La connexion par défaut est la dernière connexion
       faite par <span class="function"><a href="function.pg-connect.html" class="function">pg_connect()</a></span> ou <span class="function"><a href="function.pg-pconnect.html" class="function">pg_pconnect()</a></span>.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.pg-trace-returnvalues">
  <h3 class="title">Valeurs de retour</h3>
  <p class="para">
   Cette fonction retourne <strong><code>TRUE</code></strong> en cas de succès ou <strong><code>FALSE</code></strong> si une erreur survient.
  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.pg-trace-examples">
  <h3 class="title">Exemples</h3>
  <p class="para">
   <div class="example" id="example-2542">
    <p><strong>Exemple #1 Exemple avec <span class="function"><strong>pg_trace()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$pgsql_conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">pg_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"dbname=mark&nbsp;host=localhost"</span><span style="color: #007700">);<br /><br />if&nbsp;(</span><span style="color: #0000BB">$pgsql_conn</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pg_trace</span><span style="color: #007700">(</span><span style="color: #DD0000">'/tmp/trace.log'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'w'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$pgsql_conn</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pg_query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;1"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pg_untrace</span><span style="color: #007700">(</span><span style="color: #0000BB">$pgsql_conn</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Maintenant&nbsp;/tmp/trace.log&nbsp;contiendra&nbsp;le&nbsp;suivi&nbsp;des&nbsp;communications<br /></span><span style="color: #007700">}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #0000BB">pg_last_error</span><span style="color: #007700">(</span><span style="color: #0000BB">$pgsql_conn</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;exit;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.pg-trace-seealso">
  <h3 class="title">Voir aussi</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.fopen.html" class="function" rel="rdfs-seeAlso">fopen()</a> - Ouvre un fichier ou une URL</span></li>
    <li class="member"><span class="function"><a href="function.pg-untrace.html" class="function" rel="rdfs-seeAlso">pg_untrace()</a> - Termine le suivi d'une connexion PostgreSQL</span></li>
   </ul>
  </p>
 </div>

</div></div></div></body></html>