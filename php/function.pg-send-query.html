<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Ex&eacute;cute une requ&ecirc;te PostgreSQL asynchrone</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.pg-send-query-params.html">« pg_send_query_params</a></li>
      <li style="float: right;"><a href="function.pg-set-client-encoding.html">pg_set_client_encoding »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.pgsql.html">Fonctions PostgreSQL</a></li>
    <li>Ex&eacute;cute une requ&ecirc;te PostgreSQL asynchrone</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.pg-send-query" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">pg_send_query</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.2.0, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">pg_send_query</span> &mdash; <span class="dc-title">
   Exécute une requête PostgreSQL asynchrone
  </span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.pg-send-query-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>pg_send_query</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$connection</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$query</code></span>
   ) : <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>pg_send_query()</strong></span> envoie une requête ou des requêtes de
   manière asynchrone à la connexion <code class="parameter">connection</code>.
   Contrairement à <span class="function"><a href="function.pg-query.html" class="function">pg_query()</a></span>, elle peut envoyer plusieurs
   requêtes à la fois au serveur PostgreSQL et obtenir les résultats un par un
   en utilisant <span class="function"><a href="function.pg-get-result.html" class="function">pg_get_result()</a></span>.
  </p>
  <p class="para"> 
   L&#039;exécution du script n&#039;est pas bloquée durant l&#039;exécution des requêtes. Utilisez 
   <span class="function"><a href="function.pg-connection-busy.html" class="function">pg_connection_busy()</a></span> pour vérifier si la connexion est
   occupée (c&#039;est-à-dire la requête est en train d&#039;être exécutée). Les requêtes
   peuvent être annulées avec <span class="function"><a href="function.pg-cancel-query.html" class="function">pg_cancel_query()</a></span>.
  </p>
  <p class="para">
   Bien que l&#039;on puisse envoyer plusieurs requêtes en même temps,
   il n&#039;est pas possible d&#039;envoyer plusieurs requêtes sur une connexion
   occupée. Si une requête est envoyée alors que la connexion est occupée,
   elle attendra que la requête précédente soit terminée et perdra tous ses
   résultats.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.pg-send-query-parameters">
  <h3 class="title">Liste de paramètres</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">connection</code></dt>

     <dd>

      <p class="para">
       La ressource de connexion de la base de données PostgreSQL.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">query</code></dt>

     <dd>

      <p class="para">
       La requête ou les requêtes SQL à être exécutées.
      </p>
      <p class="para">
       Les données contenues dans la requête doivent être <a href="function.pg-escape-string.html" class="link">échappées proprement</a>.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.pg-send-query-returnvalues">
  <h3 class="title">Valeurs de retour</h3>
  <p class="para">Cette fonction retourne <strong><code>TRUE</code></strong> en cas de succès ou <strong><code>FALSE</code></strong> si une erreur survient.</p>
  <p class="para">
   Utilisez <span class="function"><a href="function.pg-get-result.html" class="function">pg_get_result()</a></span> pour déterminer les résultats
   de requête.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.pg-send-query-examples">
  <h3 class="title">Exemples</h3>
  <p class="para">
   <div class="example" id="example-2539">
    <p><strong>Exemple #1 Exemple avec <span class="function"><strong>pg_send_query()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;$dbconn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">pg_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"dbname=publisher"</span><span style="color: #007700">)&nbsp;or&nbsp;die(</span><span style="color: #DD0000">"Connexion&nbsp;impossible"</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #0000BB">pg_connection_busy</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbconn</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pg_send_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbconn</span><span style="color: #007700">,</span><span style="color: #DD0000">"select&nbsp;*&nbsp;from&nbsp;auteurs;&nbsp;select&nbsp;count(*)&nbsp;from&nbsp;auteurs;"</span><span style="color: #007700">);<br />&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$res1&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">pg_get_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbconn</span><span style="color: #007700">);<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Premier&nbsp;appel&nbsp;de&nbsp;pg_get_result()&nbsp;:&nbsp;</span><span style="color: #0000BB">$res1</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$rows1&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">pg_num_rows</span><span style="color: #007700">(</span><span style="color: #0000BB">$res1</span><span style="color: #007700">);<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$res1</span><span style="color: #DD0000">&nbsp;a&nbsp;</span><span style="color: #0000BB">$rows1</span><span style="color: #DD0000">&nbsp;enregistrements\n\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$res2&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">pg_get_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbconn</span><span style="color: #007700">);<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Second&nbsp;appel&nbsp;de&nbsp;pg_get_result()&nbsp;:&nbsp;</span><span style="color: #0000BB">$res2</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$rows2&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">pg_num_rows</span><span style="color: #007700">(</span><span style="color: #0000BB">$res2</span><span style="color: #007700">);<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$res2</span><span style="color: #DD0000">&nbsp;a&nbsp;</span><span style="color: #0000BB">$rows2</span><span style="color: #DD0000">&nbsp;enregistrements\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>L&#039;exemple ci-dessus va afficher :</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Premier appel de pg_get_result() : Resource id #3
Resource id #3 a 3 enregistrements

Second appel de pg_get_result() : Resource id #4
Resource id #4 a 1 enregistrements
</pre></div>
    </div>
   </div> 
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.pg-send-query-seealso">
  <h3 class="title">Voir aussi</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.pg-query.html" class="function" rel="rdfs-seeAlso">pg_query()</a> - Ex&eacute;cute une requ&ecirc;te PostgreSQL</span></li>
    <li class="member"><span class="function"><a href="function.pg-cancel-query.html" class="function" rel="rdfs-seeAlso">pg_cancel_query()</a> - Annule une requ&ecirc;te asynchrone</span></li>
    <li class="member"><span class="function"><a href="function.pg-get-result.html" class="function" rel="rdfs-seeAlso">pg_get_result()</a> - Lit un r&eacute;sultat PostgreSQL asynchrone</span></li>
    <li class="member"><span class="function"><a href="function.pg-connection-busy.html" class="function" rel="rdfs-seeAlso">pg_connection_busy()</a> - V&eacute;rifie si la connexion PostgreSQL est occup&eacute;e</span></li>
   </ul>
  </p>
 </div>

</div></div></div></body></html>