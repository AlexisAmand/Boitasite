<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>La classe variant</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="dotnet.construct.html">« dotnet::__construct</a></li>
      <li style="float: right;"><a href="variant.construct.html">variant::__construct »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.com.html">COM</a></li>
    <li>La classe variant</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="class.variant" class="reference">
 
 <h1 class="title">La classe variant</h1>
 <div class="partintro"><p class="verinfo">(PHP 4 &gt;= 4.1.0, PHP 5, PHP 7)</p>


  <div class="section" id="variant.intro">
   <h2 class="title">Introduction</h2>
   <p class="para">
    
    Le VARIANT est l&#039;équivalent COM de zval pour PHP ; c&#039;est une structure qui
    peut contenir une valeur avec un intervalle de différent types possibles.
    La classe variant fournie par l&#039;extension COM vous permet d&#039;avoir plus de
    contrôle sur ce que PHP envoie et reçoit de COM.
   </p>
  </div>


  <div class="section" id="variant.synopsis">
   <h2 class="title">Synopsis de la classe</h2>


   <div class="classsynopsis">
    <div class="ooclass"></div>


    <div class="classsynopsisinfo">
     <span class="ooclass">
      <strong class="classname">variant</strong>
     </span>
     {</div>


    <div class="classsynopsisinfo classsynopsisinfo_comment">/* Méthodes */</div>
    <div class="constructorsynopsis dc-description">
   <span class="methodname"><a href="variant.construct.html" class="methodname">__construct</a></span>
    ([ <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$value</code><span class="initializer"> = <strong><code>NULL</code></strong></span></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$type</code><span class="initializer"> = VT_EMPTY</span></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$codepage</code><span class="initializer"> = CP_ACP</span></span>
  ]]] )</div>

   }</div>


  </div>

  <div class="section" id="class.variant.examples">
   <h2 class="title">Exemples variant</h2>
   <p class="para">
    <div class="example" id="example-6008">
     <p><strong>Exemple #1 Exemple variant</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$v&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">variant</span><span style="color: #007700">(</span><span style="color: #0000BB">42</span><span style="color: #007700">);<br />print&nbsp;</span><span style="color: #DD0000">"The&nbsp;type&nbsp;is&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">variant_get_type</span><span style="color: #007700">(</span><span style="color: #0000BB">$v</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;br/&gt;"</span><span style="color: #007700">;<br />print&nbsp;</span><span style="color: #DD0000">"The&nbsp;value&nbsp;is&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$v&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"&lt;br/&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     Lors du retour d&#039;une valeur ou récupérer une propriété variant, le variant
     est converti en une valeur PHP seulement quand il y a une correspondance
     directe entre les types qui ne produiraient pas une perte d&#039;information.
     Dans tous les autres cas, la valeur est retourné en tant qu&#039;une instance
     de la classe variant. Vous pouvez forcer PHP de convertir ou évaluer le
     variant en tant que type PHP natif en utilisant les opérateurs de transtypage
     explicitement, ou implicitement vers une <a href="language.types.string.html" class="link">chaîne de caractères</a> en l&#039;affichant
     grâce à <span class="function"><a href="function.print.html" class="function">print</a></span>. Vous pouvez utiliser la grande variété
     de fonctions variant pour effectuer des opérations arithmétrique sans
     forcer une conversion et risquer une perte de données.
    </p>
   </p></blockquote>
   <p class="para">
    Voir aussi <span class="function"><a href="function.variant-get-type.html" class="function">variant_get_type()</a></span>.
   </p>
  </div>

 </div>

 










<h2>Sommaire</h2><ul class="chunklist chunklist_reference"><li><a href="variant.construct.html">variant::__construct</a> — Constructeur de la classe variant</li></ul>
</div>
</div></div></body></html>