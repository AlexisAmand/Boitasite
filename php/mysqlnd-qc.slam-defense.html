<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>D&eacute;fense de type slam</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mysqlnd-qc.pattern-based-caching.html">« Mise en cache bas&eacute;e sur un masque</a></li>
      <li style="float: right;"><a href="mysqlnd-qc.cache-candidates.html">Trouver des candidats &agrave; la mise en cache »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="mysqlnd-qc.quickstart.html">D&eacute;marrage rapide et quelques exemples</a></li>
    <li>D&eacute;fense de type slam</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="mysqlnd-qc.slam-defense" class="section">
  <h2 class="title">Défense de type slam</h2>
  <p class="para">
   Un cache mal structuré peut faire plus de mal que de bien. Dans le pire
   des cas, un cache peut accroître la charge du serveur de base de données au
   lieu de la diminuer. Une situation de surcharge peut survenir si un grand
   nombre d&#039;entrées partagées du cache expirent (débandade du cache).
  </p>
  <p class="para">
   Les entrées du cache sont partagées et réutilisées à différents degrés suivant
   le mode de stockage utilisé. Le gestionnaire de stockage par défaut stocke
   les entrées en mémoire. Ainsi, une entrée du cache peut être réutilisée pendant
   la durée de vie du processus. Les autres processus PHP ne peuvent pas y accéder.
   Si Memcache est utilisé, une entrée du cache peut être partagée pour plusieurs
   processus PHP, sur différentes machaines, suivant la configuration utilisée.
  </p>
  <p class="para">
   Si un grand nombre d&#039;entrées partagées du cache stockées par exemple dans Memcache
   expirent, plusieurs clients se verront informés de l&#039;absence de l&#039;entrée
   dans le cache. A ce moment, vu que ces clients ne peuvent récupérer les données
   depuis le cache, ils tentent de les récupérer depuis le serveur de base de données.
   Tant que l&#039;entrée du cache n&#039;est pas mise à jour, de plus en plus de clients
   contacteront le serveur de base de données. Dans le pire des cas, cela peut conduire
   à une perte totale du service.
  </p>
  <p class="para">
   La surcharge peut être évitée en utilisant un gestionnaire de stockage qui limite
   la réutilisation d&#039;une entrée du cache à un nombre limité de clients. Alors, si
   le cas extrême est rencontré, ce ne sera qu&#039;un nombre limité de clients
   qui tenteront de mettre à jour l&#039;entrée du cache en même temps.
  </p>
  <p class="para">
   De plus, le mécanisme de défense interne de type slam peut et doit être utilisé.
   Si cette défense est activée, une entrée du cache expirée reçoit une extension
   de durée de vie. Le premier client qui récupère une entrée manquante car expirée
   tentera de la mettre à jour pendant la durée de cette extension. Tous les autres
   clients demandant cette entrée sont temporairement servis depuis le cache malgré
   le fait que le <code class="literal">TTL</code> original de cette entrée a expiré. Les autres
   clients ne recevront pas comme réponse le fait que l&#039;entrée n&#039;est pas présente
   dans le cache tant que cette extension de vie ne sera pas atteinte.
  </p>
  <p class="para">
   <div class="example" id="example-2269">
    <div class="example-contents">
<div class="inicode"><pre class="inicode">mysqlnd_qc.slam_defense=1
mysqlnd_qc.slam_defense_ttl=1</pre>
</div>
    </div>

   </div>
  </p>
  <p class="para">
   Le mécanisme de défense de type slam est activé avec la direction de configuration PHP
   <a href="mysqlnd-qc.configuration.html#ini.mysqlnd-qc.slam-defense" class="link"><code class="literal">mysqlnd_qc.slam_defense</code></a>.
   L&#039;extension de durée de vie d&#039;une entrée du cache est définie avec la directive
   <a href="mysqlnd-qc.configuration.html#ini.mysqlnd-qc.slam-defense-ttl" class="link"><code class="literal">mysqlnd_qc.slam_defense_ttl</code></a>.
  </p>
  <p class="para">
   La fonction <span class="function"><a href="function.mysqlnd-qc-get-core-stats.html" class="function">mysqlnd_qc_get_core_stats()</a></span> retourne un tableau de statistiques.
   Les statistiques <code class="literal">slam_stale_refresh</code> et <code class="literal">slam_stale_hit</code>
   sont incrémentées si une défense de type slam est mise en place.
  </p>
  <p class="para">
   Il n&#039;est pas possible de fournir une recommandation générale concernant la configuration
   de la défense de type slam. Les utilisateurs sont encouragés à surveiller
   et tester leur configuration et d&#039;ajuster leur configuration en conséquent.
  </p>
 </div></div></div></body></html>