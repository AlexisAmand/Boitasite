<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Utiliser les archives Phar : les classes Phar et PharData</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="phar.using.stream.html">« Utiliser les archives Phar : le flux phar</a></li>
      <li style="float: right;"><a href="phar.creating.html">Cr&eacute;er des archives Phar »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="phar.using.html">Utiliser les archives Phar</a></li>
    <li>Utiliser les archives Phar : les classes Phar et PharData</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="phar.using.object" class="section">
 <h2 class="title">Utiliser les archives Phar : les classes Phar et PharData</h2>
 <p class="para">
  La classe <a href="class.phar.html" class="classname">Phar</a> supporte la lecture et la manipulation des
  archives Phar, ainsi que l&#039;itération à travers la fonctionnalité héritée de la classe
  <a href="class.recursivedirectoryiterator.html" class="classname">RecursiveDirectoryIterator</a>.
  Avec le support de l&#039;interface <a href="class.arrayaccess.html" class="classname">ArrayAccess</a>,
  les fichiers contenus dans une archive Phar peuvent être accédés
  comme s&#039;ils étaient membres d&#039;un tableau associatif.
 </p>
 <p class="para">
  La classe <a href="class.phardata.html" class="classname">PharData</a> étend la classe <a href="class.phar.html" class="classname">Phar</a>, et
  permet la création et la modification d&#039;archives tar et zip non exécutables (données) même si
  <code class="literal">phar.readonly</code>=1 dans php.ini. Ainsi,
  <span class="function"><a href="phardata.setalias.html" class="function">PharData::setAlias()</a></span> et <span class="function"><a href="phardata.setstub.html" class="function">PharData::setStub()</a></span>
  sont toutes deux désactivées car les concepts d&#039;alias et de conteneur sont restreints aux
  archives phar exécutables.
 </p>
 <p class="para">
  Il est important de noter que quand une archive Phar est créée, le chemin complet
  doit être passé au constructeur de l&#039;objet <a href="class.phar.html" class="classname">Phar</a>.
  Un chemin relatif empêcherait l&#039;initialisation.
 </p>
 <p class="para">
  En supposant que <code class="literal">$p</code> est un objet initialisé de cette façon :
 </p>
 <p class="para">
  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$p&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Phar</span><span style="color: #007700">(</span><span style="color: #DD0000">'/chemin/vers/monphar.phar'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'monphar.phar'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="para">
  Une archive Phar vide sera créée en tant que <code class="literal">/chemin/vers/monphar.phar</code>,
  ou si <code class="literal">/chemin/vers/monphar.phar</code> existe déjà, il sera ouvert
  de nouveau.  Le terme <code class="literal">monphar.phar</code> démontre le concept d&#039;un alias
  qui peut être utilisé pour référencer <code class="literal">/chemin/vers/monphar.phar</code> dans des URL comme ceci :
 </p>
 <p class="para">
  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;ces&nbsp;deux&nbsp;appels&nbsp;à&nbsp;file_get_contents()&nbsp;sont&nbsp;équivalents&nbsp;si<br />//&nbsp;/chemin/vers/monphar.phar&nbsp;a&nbsp;un&nbsp;alias&nbsp;explicite&nbsp;de&nbsp;"monphar.phar"<br />//&nbsp;dans&nbsp;son&nbsp;mainfeste,&nbsp;ou&nbsp;si&nbsp;le&nbsp;phar&nbsp;a&nbsp;été&nbsp;initialisé&nbsp;avec&nbsp;l'instantiation&nbsp;de<br />//&nbsp;l'objet&nbsp;Phar&nbsp;de&nbsp;l'exemple&nbsp;précedent<br /></span><span style="color: #0000BB">$f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'phar:///chemin/vers/monphar.phar/nimportequoi.txt'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'phar://monphar.phar/nimportequoi.txt'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="para">
  Avec l&#039;objet <a href="class.phar.html" class="classname">Phar</a> <code class="literal">$p</code> nouvellement créé,
  les choses suivantes sont possibles :
  <ul class="itemizedlist">
   <li class="listitem">
    <span class="simpara">
     <code class="literal">$a = $p[&#039;fichier.php&#039;]</code> crée une <a href="class.pharfileinfo.html" class="classname">PharFileInfo</a>
     qui réfère au contenu de <code class="literal">phar://monphar.phar/fichier.php</code>
    </span>
   </li>
   <li class="listitem">
    <span class="simpara">
     <code class="literal">$p[&#039;fichier.php&#039;] = $v</code> crée un nouveau fichier
     (<code class="literal">phar://monphar.phar/fichier.php</code>), ou écrase
     un fichier existant au sein de <code class="literal">monphar.phar</code>.  <code class="literal">$v</code>
     peut être soit une chaîne ou un pointeur vers un fichier ouvert, dans quel cas
     le contenu du fichier sera utilisé pour créer le nouveau fichier. Notez que
     <code class="literal">$p-&gt;addFromString(&#039;fichier.php&#039;, $v)</code> est équivalent en terme de
     fonctionnalité au cas ci-dessus.  Il est aussi possible d&#039;ajouter le contenu d&#039;un fichier
     avec <code class="literal">$p-&gt;addFile(&#039;/chemin/vers/fichier.php&#039;, &#039;fichier.php&#039;)</code>.
     Enfin, un répertoire vide peut être créé avec
     <code class="literal">$p-&gt;addEmptyDir(&#039;vide&#039;)</code>.
    </span>
   </li>
   <li class="listitem">
    <span class="simpara">
     <code class="literal">isset($p[&#039;fichier.php&#039;])</code> peut être utilisé pour déterminer 
     si <code class="literal">phar://monphar.phar/fichier.php</code> existe au sein de
     <code class="literal">monphar.phar</code>.
    </span>
   </li>
   <li class="listitem">
    <span class="simpara">
     <code class="literal">unset($p[&#039;fichier.php&#039;])</code> efface
     <code class="literal">phar://monphar.phar/fichier.php</code> de
     <code class="literal">monphar.phar</code>.
    </span>
   </li>
  </ul>
 </p>
 <p class="para">
  De plus, l&#039;objet <a href="class.phar.html" class="classname">Phar</a> est le seul moyen 
  d&#039;accéder aux métadonnées spécifiques de Phar, via
  <span class="function"><a href="phar.getmetadata.html" class="function">Phar::getMetadata()</a></span>,
  et c&#039;est aussi le seul moyen de régler ou de récupérer le 
  conteneur du chargeur de l&#039;archive Phar via
  <span class="function"><a href="phar.getstub.html" class="function">Phar::getStub()</a></span> et
  <span class="function"><a href="phar.setstub.html" class="function">Phar::setStub()</a></span>.
  De plus, la compression pour l&#039;archive Phar entière peut
  être manipulée seulement via la classe <a href="class.phar.html" class="classname">Phar</a>.
 </p>
 <p class="para">
  La liste complète des fonctionnalités de l&#039;objet 
  <a href="class.phar.html" class="classname">Phar</a> est documentée ci-dessous.
 </p>
 <p class="para">
  La classe <a href="class.pharfileinfo.html" class="classname">PharFileInfo</a> étend la classe 
  <a href="class.splfileinfo.html" class="classname">SplFileInfo</a>
  et ajoute plusieurs méthodes pour manipuler les métadonnées
  spécifiques à Phar d&#039;un fichier contenu dans un Phar,
  telles que manipuler la compression ou les métadonnées.
 </p>
</div></div></div></body></html>