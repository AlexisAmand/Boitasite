<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Constructeurs et destructeurs</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="language.oop5.autoload.html">« Auto-chargement de classes</a></li>
      <li style="float: right;"><a href="language.oop5.visibility.html">Visibilit&eacute; »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="language.oop5.html">Les classes et les objets</a></li>
    <li>Constructeurs et destructeurs</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="language.oop5.decon" class="sect1">
  <h2 class="title">Constructeurs et destructeurs</h2>

  <div class="sect2" id="language.oop5.decon.constructor">
   <h3 class="title">Constructeur</h3>
   <div class="methodsynopsis dc-description" id="object.construct">
    <span class="methodname"><strong>__construct</strong></span>
     ([ <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$args</code><span class="initializer"> = &quot;&quot;</span></span>
    [, <span class="methodparam"> <code class="parameter">$...</code></span>
   ]] ) : <span class="type"><span class="type void">void</span></span></div>

   <p class="para">
    PHP permet aux développeurs de déclarer des constructeurs pour
    les classes. Les classes qui possèdent une méthode constructeur
    appellent cette méthode à chaque création d&#039;une nouvelle instance
    de l&#039;objet, ce qui est intéressant pour toutes les initialisations
    dont l&#039;objet a besoin avant d&#039;être utilisé.
   </p>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <span class="simpara">
     Les constructeurs parents ne sont pas appelés implicitement
     si la classe enfant définit un constructeur. Si vous
     voulez utiliser un constructeur parent, il sera nécessaire de faire
     appel à <code class="literal">parent::__construct()</code> depuis le constructeur enfant.
     Si l&#039;enfant ne définit pas un constructeur alors il peut être hérité
     de la classe parent, exactement de la même façon qu&#039;une méthode le serait
     (si elle n&#039;a pas été déclarée comme privée).
    </span>
   </p></blockquote>
   <div class="example" id="example-210">
    <p><strong>Exemple #1 Exemple d&#039;utilisation des nouveaux constructeurs unifiés</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">BaseClass&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"Dans&nbsp;le&nbsp;constructeur&nbsp;de&nbsp;BaseClass\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />class&nbsp;</span><span style="color: #0000BB">SubClass&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">BaseClass&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">parent</span><span style="color: #007700">::</span><span style="color: #0000BB">__construct</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"Dans&nbsp;le&nbsp;constructeur&nbsp;de&nbsp;SubClass\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />class&nbsp;</span><span style="color: #0000BB">OtherSubClass&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">BaseClass&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Constructeur&nbsp;hérité&nbsp;de&nbsp;BaseClass<br /></span><span style="color: #007700">}<br /><br /></span><span style="color: #FF8000">//&nbsp;Dans&nbsp;le&nbsp;constructeur&nbsp;de&nbsp;BaseClass<br /></span><span style="color: #0000BB">$obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">BaseClass</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;Dans&nbsp;le&nbsp;constructeur&nbsp;de&nbsp;BaseClass<br />//&nbsp;Dans&nbsp;le&nbsp;constructeur&nbsp;de&nbsp;SubClass<br /></span><span style="color: #0000BB">$obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SubClass</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;Dans&nbsp;le&nbsp;constructeur&nbsp;de&nbsp;BaseClass<br /></span><span style="color: #0000BB">$obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">OtherSubClass</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <p class="para">
    Pour des raisons de compatibilité ascendante avec PHP 3 et 4, si PHP ne peut pas
    trouver une fonction <a href="language.oop5.decon.html#object.construct" class="link">__construct()</a>
    pour une classe donnée,
    il cherchera une fonction constructeur représentée, comme dans
    l&#039;ancien style, par le nom de la classe.
    Dans les faits, cela signifie que le seul cas où il pourrait y avoir
    un problème de compatibilité est celui où votre classe contiendrait une
    méthode nommée <a href="language.oop5.decon.html#object.construct" class="link">__construct()</a> et que vous en ayez un
    autre usage.
   </p>
   
   <div class="warning"><strong class="warning">Avertissement</strong>
    <p class="simpara">
     L&#039;ancien style de constructeur est <em class="emphasis">DECONSEILLE</em> à partir de PHP 7.0
     et sera supprimé dans une future version. Vous devez toujours utiliser 
     <a href="language.oop5.decon.html#object.construct" class="link">__construct()</a> dans le nouveau code.
    </p>
   </div>
   <p class="para">
    À la différence des autres méthodes, PHP ne génèrera pas d&#039;erreur de niveau
    <strong><code>E_STRICT</code></strong> lorsque <a href="language.oop5.decon.html#object.construct" class="link">__construct()</a> est
    surchargé avec des paramètres différents du <a href="language.oop5.decon.html#object.construct" class="link">__construct()</a> parent.
   </p>
   <p class="para">
    À partir de PHP 5.3.3, les méthodes ayant le même nom que la classe dans laquelle
    elle se trouve ne sont plus traitées comme des constructeurs, si la classe
    considérée se situe dans un espace de noms. Ceci n&#039;affecte pas les classes
    sans espace de noms.
   </p>
   <div class="example" id="language.oop5.basic.class.class.name">
    <p><strong>Exemple #2 Constructeurs dans des classes dans des espaces de noms</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">Foo</span><span style="color: #007700">;<br />class&nbsp;</span><span style="color: #0000BB">Bar&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">Bar</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Traitée&nbsp;comme&nbsp;un&nbsp;constructeur&nbsp;dans&nbsp;PHP&nbsp;5.3.0-5.3.2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Traitée&nbsp;comme&nbsp;une&nbsp;méthode&nbsp;normale&nbsp;à&nbsp;partir&nbsp;de&nbsp;PHP&nbsp;5.3.3<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </div>

  <div class="sect2" id="language.oop5.decon.destructor">
   <h3 class="title">Destructeur</h3>
   <div class="methodsynopsis dc-description" id="object.destruct">
    <span class="methodname"><strong>__destruct</strong></span>
     ( <span class="methodparam">void</span>
    ) : <span class="type"><span class="type void">void</span></span></div>

   <p class="para">
    PHP 5 introduit un concept de destructeur similaire à celui d&#039;autres langages
    orientés objet, comme le <code class="literal">C++</code>. La méthode destructeur est appelée
    dès qu&#039;il n&#039;y a plus de référence sur un objet donné, ou dans n&#039;importe quel
    ordre pendant la séquence d&#039;arrêt.
   </p>
   <div class="example" id="example-212">
    <p><strong>Exemple #3 Exemple avec un Destructeur</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">MyDestructableClass&nbsp;<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"In&nbsp;constructor\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">__destruct</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"Destroying&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">__CLASS__&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">MyDestructableClass</span><span style="color: #007700">();</span>
</span>
</code></div>
    </div>

   </div>
   <p class="para">
    Tout comme le constructeur, le destructeur parent ne sera pas appelé
    implicitement par le moteur. Pour exécuter le destructeur parent, vous
    devez appeler explicitement la fonction
    <code class="literal">parent::__destruct</code> dans le corps du destructeur.
    Tout comme les constructeurs, une classe enfant peut hériter du
    destructeur du parent s&#039;il n&#039;en implémente pas un lui même.
   </p>
   <p class="para">
    Le destructeur sera appelé même si l&#039;exécution du script est stoppée
    en utilisant la fonction <span class="function"><a href="function.exit.html" class="function">exit()</a></span>.
    Appeler la fonction <span class="function"><a href="function.exit.html" class="function">exit()</a></span>
    dans un destructeur empêchera l&#039;exécution des routines d&#039;arrêt restantes.
   </p>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     Les destructeurs appelés durant l&#039;arrêt du script sont dans une situation
     où les en-têtes HTTP ont déjà été envoyés.
     Le dossier de travail dans la phase d&#039;arrêt du script
     peut être différent avec certaines APIs (e.g. Apache).
    </p>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     Tenter de lancer une exception depuis un destructeur (appelé à la fin du script)
     entraine une erreur fatale.
    </p>
   </p></blockquote>
  </div>
 </div></div></div></body></html>