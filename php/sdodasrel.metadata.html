<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Sp&eacute;cification des m&eacute;tadonn&eacute;es</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="sdodasrel.examples-crud.html">« Cr&eacute;ation, r&eacute;cup&eacute;ration, mise &agrave; jour et effacement de donn&eacute;es</a></li>
      <li style="float: right;"><a href="sdodasrel.examples.one-table.html">Exemples avec une table »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="sdodasrel.examples.html">Exemples</a></li>
    <li>Sp&eacute;cification des m&eacute;tadonn&eacute;es</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="sdodasrel.metadata" class="section">
  <h2 class="title">Spécification des métadonnées</h2>
  <p class="para">
   La première longue section décrit en détail comment les métadonnées
   décrivant la base de données et le modèle SDO requis est fourni à DAS
   Relationnel.
  </p>
  <p class="para">
   Lorsque le constructeur de DAS Relationnel est appelé, il doit recevoir
   plusieurs informations. La majeure partie des informations, passée en
   tant qu&#039;un tableau associatif dans le premier argument du constructeur,
   dit à DAS Relationnel ce qu&#039;il doit savoir à propos de la base de données
   relationnelle. Il décrit les noms des tables, des colonnes, des clés
   primaires et des clés secondaires. On devrait comprendre assez facilement
   ce qui est requis et une fois écrit, il peut être placé dans un fichier
   PHP et inclut lorsque nécessaire. Le reste des informations, passé dans
   un deuxième et troisième arguments du constructeur, dit au DAS
   Relationnel ce qu&#039;il doit savoir à propos des relations entre les objets
   et la forme du graphique de données; il détermine finalement comment les
   données de la base de données seront normalisées dans le graphique.
  </p>

  <div class="section" id="sdodasrel.metadata.database">
   <h2 class="title">Métadonnées de base de données</h2>
   <p class="para">
    Le premier argument du constructeur décrit la base de données
    relationnelle cible.
   </p>
   <p class="para">
    Chaque table est décrite par un tableau associatif avec jusqu&#039;à quatre
    clés.
    <table class="doctable informaltable">
     
      <thead>
       <tr>
        <th>Clé</th>
        <th>Valeur</th>
       </tr>

      </thead>

      <tbody class="tbody">
       <tr>
        <td>name</td>
        <td>Le nom de la table.</td>
       </tr>

       <tr>
        <td>columns</td>
        <td>
         Un tableau listant les noms des colonnes, dans n&#039;importe quel
         ordre.
        </td>
       </tr>

       <tr>
        <td>PK</td>
        <td>Le nom de la colonne contenant la clé primaire.</td>
       </tr>

       <tr>
        <td>FK</td>
        <td>Un tableau avec deux entrées, <code class="literal">&quot;from&quot;</code> et <code class="literal">&quot;to&quot;</code> (provenance et
         destination), qui définissent une colonne contenant la clé étrangère
         et une table dans lequel la clé étrangère pointe. S&#039;il n&#039;y a pas de
         clé étrangère dans la table, alors l&#039;entrée <code class="literal">&quot;FK&quot;</code> est optionnelle.
         Seulement une clé étrangère peut être spécifiée. Seulement une clé
         étrangère pointant à une clé primaire d&#039;une table peut être
         spécifiée.
        </td>
       </tr>

      </tbody>
     
    </table>

   </p>

   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*****************************************************************<br />*&nbsp;MÉTADONNÉES&nbsp;DÉFINISSANT&nbsp;LA&nbsp;BASE&nbsp;DE&nbsp;DONNÉES<br />******************************************************************/<br /></span><span style="color: #0000BB">$company_table&nbsp;</span><span style="color: #007700">=&nbsp;array&nbsp;(<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'name'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'company'</span><span style="color: #007700">,<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'columns'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'name'</span><span style="color: #007700">,&nbsp;&nbsp;</span><span style="color: #DD0000">'employee_of_the_month'</span><span style="color: #007700">),<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'PK'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'FK'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array&nbsp;(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'from'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'employee_of_the_month'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'to'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'employee'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br />&nbsp;&nbsp;);<br /></span><span style="color: #0000BB">$department_table&nbsp;</span><span style="color: #007700">=&nbsp;array&nbsp;(<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'name'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'department'</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'columns'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'name'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'location'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'number'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'co_id'</span><span style="color: #007700">),<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'PK'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'FK'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array&nbsp;(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'from'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'co_id'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'to'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'company'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br />&nbsp;&nbsp;);<br /></span><span style="color: #0000BB">$employee_table&nbsp;</span><span style="color: #007700">=&nbsp;array&nbsp;(<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'name'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'employee'</span><span style="color: #007700">,<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'columns'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'name'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'SN'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'manager'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'dept_id'</span><span style="color: #007700">),<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'PK'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'FK'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array&nbsp;(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'from'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'dept_id'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'to'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'department'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br />&nbsp;&nbsp;);<br /></span><span style="color: #0000BB">$database_metadata&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #0000BB">$company_table</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$department_table</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$employee_table</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>


   <p class="para">
    Les métadonnées correspondent à une base de données relationnelle qui
    peut avoir été définie comme étant MySQL :
   </p>
   <div class="example-contents">
<div class="sqlcode"><pre class="sqlcode">create table company (
 id integer auto_increment,
 name char(20),
 employee_of_the_month integer,
 primary key(id)
);
create table department (
 id integer auto_increment,
 name char(20),
 location char(10),
 number integer(3),
 co_id integer,
 primary key(id)
);
create table employee (
 id integer auto_increment,
 name char(20),
 SN char(4),
 manager tinyint(1),
 dept_id integer,
 primary key(id)
);</pre>
</div>
   </div>

   <p class="para">
   or to DB2 as:
   </p>
   <div class="example-contents">
<div class="sqlcode"><pre class="sqlcode">create table company ( \
  id integer not null generated by default as identity,  \
  name varchar(20), \
  employee_of_the_month integer, \
  primary key(id) )
create table department ( \
  id integer not null generated by default as identity, \
  name varchar(20), \
  location varchar(10), \
  number integer, \
  co_id integer, \
  primary key(id) )
create table employee ( \
  id integer not null generated by default as identity, \
  name varchar(20), \
  SN char(4), \
  manager smallint, \
  dept_id integer, \
  primary key(id) )</pre>
</div>
   </div>


   <p class="para">
    Notez que bien que dans cet exemple n&#039;a pas de clé étrangère de
    spécifiée à la base de données et que la base de données n&#039;est pas
    prévue à forcer l&#039;intégrité référentielle, l&#039;intention derrière la
    colonne
    <var class="varname">co_id</var>
    de la table departement et la colonne
    <var class="varname">dept_id</var>
    de la table employe est qu&#039;elles pourraient contenir la clé primaire de
    leur compagnie les contenant ou l&#039;enregistrement du département,
    respectivement.
    Alors ces deux colonnes actent comme des clés étrangères.
   </p>

   <p class="para">
    Il y a une troisième clé étrangère dans cet exemple, elle est de la
    colonne <var class="varname">employe_du_mois</var>
    de la table compagnie qui est compris dans une ligne de la table
    employe.
    Notez la différence dans l&#039;intention entre cette clé étrangère et les
    deux autres. La colonne
    <var class="varname">employe_du_mois</var>
    représente une relation de valeurs simples : il peut y avoir seulement
    un employé du moi pour une compagnie donnée.
    Les colonnes
    <var class="varname">co_id</var>
    <var class="varname">dept_id</var>
    représentent des relations de valeurs multiples : une compagnie peut
    contenir plusieurs département et un département peut contenir beaucoup
    d&#039;employés. Cette distinction deviendra évidente lorsque le reste des
    métadonnées sélectionne les relations entre la compagnie-département et le
    département-employé comme étant une relation contenue.
   </p>

   <p class="para">
    Il y a un peu de règles simples qui doivent être suivies lorsque l&#039;on
    construit les métadonnées de base de données :
   </p>

   <ul class="itemizedlist">
    <li class="listitem">
     <p class="para">
      Toutes les tables doivent avoir des clés primaires et les clés
      primaires doivent être spécifiées dans les métadonnées. Sans clés
      primaires, il n&#039;est pas possible de garder une trace des identités des
      objets. Comme vous pouvez le voir avec les requête SQL qui créent les
      tables, les clés primaires peuvent être générées automatiquement, ce
      qui signifie, qu&#039;elles sont générées et assignées par la base de
      données lorsque l&#039;enregistrement est inséré. Dans ce cas, la clé
      primaire générée automatiquement est obtenue de la base de données et
      insérées dans l&#039;objet de données immédiatement après que la ligne
      soit insérée dans la base de données.
     </p>
    </li>

    <li class="listitem">
     <p class="para">
      Il n&#039;est pas nécessaire de spécifier les métadonnées de toutes les
      colonnes qui existent dans la base de données, seulement celles qui
      seront utilisées. Par exemple, si la table compagnie avait un autre
      colonne que l&#039;application ne souhaite pas accéder avec SDO, il n&#039;est
      pas nécessaire de la spécifiée dans les métadonnées. En contrepartie,
      cela ne devrait pas causer de problème de la spécifier : si elle est
      spécifiée dans les métadonnées mais jamais récupérée ou assignée par
      l&#039;application, alors la colonne inutilisée ne devrait rien affecter.
     </p>
    </li>

    <li class="listitem">
     <p class="para">
      Dans les métadonnées de base de données, notez que les définitions
      des clés étrangères n&#039;identifient pas la colonne de destination dans
      la table qui est pointée, mais le nom de la table elle-même.
      Strictement, le modèle relationnel permet la destination d&#039;une clé
      étrangère à être une clé non primaire. Seules les clés étrangères qui
      pointent à une clé primaire sont utiles pour la construction du
      modèle SDO, puisque les métadonnées spécifient le nom de la table. Il
      est entendu que la clé étrangère pointe vers la clé primaire d&#039;une
      table donnée.
     </p>
    </li>
   </ul>

   <p class="para">
    Ayant donné ces règles et les requêtes SQL qui définissent les bases de
    données, les métadonnées de base de données devrait être faciles à
    construire.
   </p>

   <div class="section" id="sdodasrel.metadata.database.model">
    <h2 class="title">Que fait DAS Relationnel avec ces métadonnées</h2>
    <p class="para">
     Le DAS Relationnel utilise les métadonnées de base de données pour
     former la plupart des modèles SDO. Pour chaque table dans les
     métadonnées de base de données, un type SDO est défini. Chaque colonne
     qui peut représenter une valeur primitive (les colonnes qui ne sont pas
     définies comme étant des clés étrangères) est ajoutée comme propriété
     au type SDO.
    </p>
    <p class="para">
     Toutes les propriétés primitives sont données par un type de <a href="language.types.string.html" class="link">chaîne de caractères</a>
     dans le modèle SDO, sans se soucier de leur type SQL. Lors de la
     ré-écriture des données dans la base de données, le DAS Relationnel
     créera une requête SQL qui traitera les valeurs comme étant des chaînes
     de caractères et la base de données les convertira dans le type
     approprié.
    </p>

    <p class="para">
     Les clés étrangères sont interprétées de une des deux manières,
     dépendamment des métadonnées contenues dans le troisième argument du
     constructeur qui définissent les relations de SDO contenues.
     Une discussion de cela est donc reportée dans la section
     <a href="sdodasrel.metadata.html#sdodasrel.metadata.crels" class="link">
      relations SDO contenues
     </a>
     ci-dessous.
    </p>
   </div>

   <div class="section" id="sdodasrel.metadata.approottype">
    <h2 class="title">Spécification du type de racine de l&#039;application</h2>
    <p class="para">
     Le second argument du constructeur est l&#039;application du type de racine.
     La vraie racine de chaque graphique de données est un objet d&#039;un type de
     racine spécial et tous les objets de données des applications viennent
     quelque part sous cela. De la plupart des types d&#039;application dans le
     modèle SDO, une doit être le type d&#039;application immédiatement sous la
     racine du graphique de données. S&#039;il y a seulement une table dans les
     métadonnées de base de données, le type de racine de l&#039;application peut
     être impliqué et cet argument peut être omis.
    </p>
   </div>

   <div class="section" id="sdodasrel.metadata.crels">
    <h2 class="title">Spécification des relations SDO contenues</h2>

    <p class="para">
     Le troisième argument du constructeur définit comment les types dans le
     modèle seront liés ensemble pour former un graphique. Cela identifie les
     relations parent-enfant entre les types qui collectivement forment un
     graphique. Les relations doivent être supportées par les clés étrangères
     pour être trouvées dans les données, d&#039;une manière rapide d&#039;être décrit.
    </p>

    <p class="para">
     Les métadonnées sont un tableau contenant un ou plusieurs tableaux
     associatifs, chacun d&#039;eux identifie un parent et un enfant. L&#039;exemple
     ci-dessous montre une relation parent-enfant de compagnie au département
     et un autre du département aux employés. Chacune d&#039;elles deviendra un
     propriété définissant une relation de valeur multiples contenue dans un
     modèle SDO.
    </p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$department_containment&nbsp;</span><span style="color: #007700">=&nbsp;array(&nbsp;</span><span style="color: #DD0000">'parent'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'company'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'child'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'department'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$employee_containment&nbsp;</span><span style="color: #007700">=&nbsp;array(&nbsp;</span><span style="color: #DD0000">'parent'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'department'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'child'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'employee'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$SDO_containment_metadata&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #0000BB">$department_containment</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$employee_containment</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>


    <p class="para">
     Les clés étrangères dans les métadonnées de base de données sont
     interprétées comme des propriétés avec soit des relations de valeurs
     multiples contenues ou des références de simples valeurs non contenues,
     dépendamment si elles ont une relation SDO contenue correspondante
     spécifiée dans les métadonnées. Dans cet exemple ici, les clés
     étrangères du département à la compagnie (la colonne
     <var class="varname">co_id</var> dans la table de departement)
     et de l&#039;employé au département (la colonne <var class="varname">dept_id</var>
     dans la table employe) sont interprétées comme supportant les relations
     SDO contenues. Chaque référence contenue mentionnée dans les métadonnées
     de relations contenue de SDO doit avoir une clé correspondante présente
     dans la base de données et définie dans les métadonnées de base de données.
     Les valeurs des colonnes de la clé étrangère pour les relations contenues
     n&#039;apparaissent pas dans les objets de données; à la place, chacune
     d&#039;entre elles est représentée par une relation contenue du parent à
     l&#039;enfant. Alors la colonne <var class="varname">co_id</var> dans la ligne de
     département de la base de données, par exemple, n&#039;apparaît pas en tant
     que propriété du type de département, mais apparaît à la place comme
     une relation contenue appelée <var class="varname">departname</var> sur le
     type de compagnie. Notez que la clé étrangère et la relation
     parent-enfant semble avoir un sens opposé : la clé étrangère pointe du
     département à la compagnie, mais la relation parent-enfant pointe de
     la compagnie au département.
    </p>

    <p class="para">
     La troisième clé dans cet exemple, le <var class="varname">employe_du_mois</var>,
     est gérée différemment. Elle n&#039;est pas mentionnée dans les métadonnées
     de relations SDO contenues. Ceci a pour conséquence d&#039;être interprété de
     la seconde manière : elle devient une référence de valeur simple non contenue
     sur l&#039;objet compagnie, sur lequel vous pouvez assigner des références au type
     d&#039;employé d&#039;objets de données SDO. Elle apparaît comme une propriété du
     type de compagnie. Le moyen pour lui assigner une valeur dans le
     graphique de données est d&#039;avoir un graphique qui contient un objet
     employé avec les relations contenues et d&#039;assigner l&#039;objet à celui-ci.
     Ceci est montré dans les exemples plus loin.
    </p>
   </div>
  </div> 
 </div></div></div></body></html>