<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Exemple avec trois tables</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="sdodasrel.examples.two-table.html">« Exemples avec deux tables</a></li>
      <li style="float: right;"><a href="sdodasrel.limitations.html">Limitations »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="sdodasrel.examples.html">Exemples</a></li>
    <li>Exemple avec trois tables</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="sdodasrel.examples.three-table" class="section">
  <h2 class="title">Exemple avec trois tables</h2>
  <p class="para">
   Les exemples suivant utilisent tous trois tables de la base de données
   compagnie : les tables compagnie, departement et employe. Elles
   introduisent le dernier morceau du fonctionnement non expliqué dans les
   exemples ci haut : la référence non contenue
   <var class="varname">employe_du_mois</var>.
  </p>
  <p class="para">
   Comme les exemples ci haut pour la compagnie et le département, la série
   d&#039;exemples illustre le cycle de vie complet d&#039;un graphique de données.
  </p>


  <p class="para">
   <div class="example" id="example-6102">
    <p><strong>Exemple #1 Une compagnie, un département, un employé - Création</strong></p>
    <div class="example-contents"><p>
     Dans cet exemple, une compagnie est créée contenant un département et
     seulement un employé. Notez que dans cet exemple, les trois tables sont
     vidées à leur démarrage ainsi les résultats exacts des requêtes peuvent
     être connus.
    </p></div>
    <div class="example-contents"><p>
     Notez comment une fois que la compagnie, le département et l&#039;employé
     est créé que la propriété
     <var class="varname">employe_du_mois</var>
     de la compagnie peut être faite pour pointer au nouvel employé.
     Puisque c&#039;est une référence qui n&#039;est pas contenue, ceci ne peut être
     effectué tant que l&#039;objet employé ait été créé dans le graphique. Les
     références non contenues doivent être gérées prudemment. Par exemple,
     si un employé est maintenant supprimé de son département, il ne serait
     pas correcte d&#039;essayer de sauver le graphique sans premièrement
     effacer ou réassigner la propriété
     <var class="varname">employe_du_mois</var>.
     Cette règle SDO requiert que tous les objets
     pointé par une référence qui n&#039;est pas contenue doit être aussi
     accessible par des relations contenues.
    </p></div>
    <div class="example-contents"><p>
     Lorsque vient le moment d&#039;insérer le graphique dans la base de données,
     la procédure est similaire à l&#039;exemple d&#039;insertion d&#039;une compagnie et
     d&#039;un département, cependant, la propriété
     <var class="varname">employe_du_mois</var>
     introduit une plus grande complexité.
     Le DAS Relationnel doit insérer les objets en descendant l&#039;arbre formée
     des relations contenues, donc la compagnie, ensuite le département et
     ensuite l&#039;employée. Ceci est nécessaire puisqu&#039;il y a toujours une clé
     primaire générée automatiquement du parent pour l&#039;inclure dans une ligne
     du fils. Mais lorsque la compagnie est insérée, l&#039;employée qui est
     l&#039;employé du mois n&#039;est pas encore inséré et la clé primaire est
     inconnue. La procédure est qu&#039;après l&#039;insertion de l&#039;employé et que sa
     clé primaire soit connue, une dernière étape est effectuée qui permet
     de modifier la compagnie avec la clé primaire de l&#039;employé.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">require_once&nbsp;</span><span style="color: #DD0000">'SDO/DAS/Relational.php'</span><span style="color: #007700">;<br />require_once&nbsp;</span><span style="color: #DD0000">'company_metadata.inc.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*************************************************************************************<br />*&nbsp;Vidage&nbsp;des&nbsp;deux&nbsp;tables<br />*************************************************************************************/<br /></span><span style="color: #0000BB">$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO_DSN</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_USER</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_PASSWORD</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$pdo_stmt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">'DELETE&nbsp;FROM&nbsp;COMPAGNIE;'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$rows_affected&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$pdo_stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$pdo_stmt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">'DELETE&nbsp;FROM&nbsp;DEPARTEMENT;'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$rows_affected&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$pdo_stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$pdo_stmt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">'DELETE&nbsp;FROM&nbsp;EMPLOYE;'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$rows_affected&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$pdo_stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">/*************************************************************************************<br />*&nbsp;Crée&nbsp;une&nbsp;compagnie&nbsp;minuscule&nbsp;mais&nbsp;complète.<br />*&nbsp;Le&nbsp;nom&nbsp;de&nbsp;la&nbsp;compagnie&nbsp;est&nbsp;Acme.<br />*&nbsp;Il&nbsp;y&nbsp;a&nbsp;un&nbsp;département,&nbsp;Chaussure.<br />*&nbsp;Il&nbsp;y&nbsp;a&nbsp;une&nbsp;employé,&nbsp;Bob.<br />*&nbsp;L'employé&nbsp;du&nbsp;mois&nbsp;est&nbsp;Bob.<br />*************************************************************************************/<br /></span><span style="color: #0000BB">$das&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SDO_DAS_Relational&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$database_metadata</span><span style="color: #007700">,</span><span style="color: #DD0000">'compagnie'</span><span style="color: #007700">,</span><span style="color: #0000BB">$SDO_containment_metadata</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO_DSN</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_USER</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_PASSWORD</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$das&nbsp;&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">createRootDataObject</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$acme&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$root&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">createDataObject</span><span style="color: #007700">(</span><span style="color: #DD0000">'compagnie'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$acme&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">nom&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"Acme"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$chaussure&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$acme&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">createDataObject</span><span style="color: #007700">(</span><span style="color: #DD0000">'departement'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$chaussure&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">nom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Chaussure'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$chaussure&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">emplacement&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Bloc-A'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$bob&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$chaussure&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">createDataObject</span><span style="color: #007700">(</span><span style="color: #DD0000">'employe'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$bob&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">nom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Bob'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$acme&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">employe_du_mois&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$bob</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$das&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">applyChanges</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$root</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #DD0000">"Écriture&nbsp;de&nbsp;Acme&nbsp;avec&nbsp;un&nbsp;département&nbsp;et&nbsp;un&nbsp;employé\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-6103">
    <p><strong>Exemple #2 Une compagnie, un département, un employé - Récupération et Mise à Jour</strong></p>
    <div class="example-contents"><p>
     La requête SQL passée à DAS Relationnel est cette fois un inner join
     qui récupère les données des trois tables. Autrement, cet exemple
     n&#039;introduit rien de nouveau de l&#039;exemple précédent
    </p></div>
    <div class="example-contents"><p>
     Le graphique est mis à jour avec l&#039;addition d&#039;un nouveau département et
     d&#039;un nouvel employé et quelques modifications au propriétés de nom des
     objets existant dans le graphique. Les changements combinés sont écrits.
     Le DAS Relationnel traitera et appliquera un mélange arbitraire des
     additions, des modifications et des suppressions provenant et allant
     vers le graphique.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">require_once&nbsp;</span><span style="color: #DD0000">'SDO/DAS/Relational.php'</span><span style="color: #007700">;<br />require_once&nbsp;</span><span style="color: #DD0000">'company_metadata.inc.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*************************************************************************************<br />&nbsp;*&nbsp;Trouve&nbsp;la&nbsp;compagnie&nbsp;encore&nbsp;et&nbsp;change&nbsp;certains&nbsp;aspects.<br />&nbsp;*&nbsp;Change&nbsp;le&nbsp;nom&nbsp;de&nbsp;la&nbsp;compagnie,&nbsp;le&nbsp;département&nbsp;et&nbsp;l'employé.<br />&nbsp;*&nbsp;Ajoute&nbsp;un&nbsp;second&nbsp;département&nbsp;et&nbsp;un&nbsp;nouvel&nbsp;employé.<br />&nbsp;*&nbsp;Change&nbsp;l'employé&nbsp;du&nbsp;mois<br />&nbsp;*************************************************************************************/<br /></span><span style="color: #0000BB">$das&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SDO_DAS_Relational&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$database_metadata</span><span style="color: #007700">,</span><span style="color: #DD0000">'compagnie'</span><span style="color: #007700">,</span><span style="color: #0000BB">$SDO_containment_metadata</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO_DSN</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_USER</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_PASSWORD</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$root&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$das</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">executeQuery</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"select&nbsp;c.id,&nbsp;c.nom,&nbsp;c.employe_du_mois,&nbsp;d.id,&nbsp;d.nom,&nbsp;e.id,&nbsp;e.nom&nbsp;"&nbsp;</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"from&nbsp;compagnie&nbsp;c,&nbsp;departement&nbsp;d,&nbsp;employe&nbsp;e&nbsp;"&nbsp;</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"where&nbsp;e.dept_id&nbsp;=&nbsp;d.id&nbsp;and&nbsp;d.co_id&nbsp;=&nbsp;c.id&nbsp;and&nbsp;c.nom='Acme'"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</span><span style="color: #DD0000">'compagnie.id'</span><span style="color: #007700">,</span><span style="color: #DD0000">'compagnie.nom'</span><span style="color: #007700">,</span><span style="color: #DD0000">'compagnie.employe_du_mois'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'departement.id'</span><span style="color: #007700">,</span><span style="color: #DD0000">'departement.nom'</span><span style="color: #007700">,</span><span style="color: #DD0000">'employe.id'</span><span style="color: #007700">,</span><span style="color: #DD0000">'employe.nom'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">$acme&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$root</span><span style="color: #007700">[</span><span style="color: #DD0000">'compagnie'</span><span style="color: #007700">][</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br /><br /></span><span style="color: #0000BB">$chaussure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$acme</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">departement</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">$bob&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$chaussure&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">employe</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br /><br /></span><span style="color: #0000BB">$it&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$acme</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createDataObject</span><span style="color: #007700">(</span><span style="color: #DD0000">'departement'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$it</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nom&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'IT'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$it</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">location&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Bloc-G'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$billy&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$it</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createDataObject</span><span style="color: #007700">(</span><span style="color: #DD0000">'employe'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$billy</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nom&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Billy'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$acme</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nom&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'MegaCorp'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$chaussure</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nom&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Footwear'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$sue</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nom&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Suzan'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$acme</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">employe_du_mois&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$billy</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$das&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">applyChanges</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$root</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">"Écriture&nbsp;de&nbsp;la&nbsp;compagnie&nbsp;avec&nbsp;un&nbsp;département&nbsp;en&nbsp;plus&nbsp;et&nbsp;un&nbsp;employé&nbsp;et<br />tous&nbsp;les&nbsp;noms&nbsp;ont&nbsp;changés&nbsp;Megacorp/Footwear/Suzan)\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-6104">
    <p><strong>Exemple #3 Une compagnie, deux départements, deux employés - Récupération et Suppression</strong></p>
    <div class="example-contents"><p>
     La compagnie est récupéré en tant qu&#039;un graphique de données complet
     contenant cinq objets de données - la compagnie, deux départements et
     deux employés. Ils sont tous supprimés en supprimant l&#039;objet compagnie.
     La suppression d&#039;un objet du graphique supprime tous les objets sous
     celui-ci dans le graphique. Cinq requêtes DELETE SQL sera générées et
     exécutée. Comme d&#039;habitude, elles seront qualifiées avec une clause
     WHERE qui contient tous les champs qui ont été récupérés, alors toutes
     les mises à jour des données dans la base de données pendant ce temps
     par un autre processus seront détectées.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">require_once&nbsp;</span><span style="color: #DD0000">'SDO/DAS/Relational.php'</span><span style="color: #007700">;<br />require_once&nbsp;</span><span style="color: #DD0000">'company_metadata.inc.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*************************************************************************************<br />&nbsp;*&nbsp;Maintenant&nbsp;lit&nbsp;une&nbsp;ou&nbsp;plusieurs&nbsp;fois&nbsp;et&nbsp;supprime.<br />&nbsp;*&nbsp;Vous&nbsp;pouvez&nbsp;supprimer&nbsp;par&nbsp;partie,&nbsp;appliquer&nbsp;les&nbsp;changements,&nbsp;et&nbsp;ensuite<br />&nbsp;*&nbsp;continuer&nbsp;à&nbsp;travailler&nbsp;avec&nbsp;le&nbsp;même&nbsp;graphique&nbsp;de&nbsp;données&nbsp;mais&nbsp;la&nbsp;précaution<br />&nbsp;*&nbsp;est&nbsp;requise&nbsp;pour&nbsp;garder&nbsp;véracité&nbsp;-&nbsp;vous&nbsp;ne&nbsp;pouvez&nbsp;pas&nbsp;supprimer&nbsp;l'employé<br />&nbsp;*&nbsp;qui&nbsp;est&nbsp;l'employé&nbsp;du&nbsp;mois&nbsp;sans&nbsp;le&nbsp;réassigner.&nbsp;Pour&nbsp;plus&nbsp;de&nbsp;précaution&nbsp;ici,<br />&nbsp;*&nbsp;nous&nbsp;supprimons&nbsp;la&nbsp;compagnie&nbsp;en&nbsp;entier&nbsp;d'un&nbsp;seul&nbsp;coup.<br />&nbsp;*************************************************************************************/<br /></span><span style="color: #0000BB">$das&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SDO_DAS_Relational&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$database_metadata</span><span style="color: #007700">,</span><span style="color: #DD0000">'compagnie'</span><span style="color: #007700">,</span><span style="color: #0000BB">$SDO_containment_metadata</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO_DSN</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_USER</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_PASSWORD</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$root&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$das</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">executeQuery</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"select&nbsp;c.id,&nbsp;c.nom,&nbsp;c.employe_du_mois,&nbsp;d.id,&nbsp;d.nom,&nbsp;e.id,&nbsp;e.nom&nbsp;"&nbsp;</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"from&nbsp;compagnie&nbsp;c,&nbsp;departement&nbsp;d,&nbsp;employe&nbsp;e&nbsp;"&nbsp;</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"where&nbsp;e.dept_id&nbsp;=&nbsp;d.id&nbsp;and&nbsp;d.co_id&nbsp;=&nbsp;c.id&nbsp;and&nbsp;c.nom='MegaCorp';"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</span><span style="color: #DD0000">'compagnie.id'</span><span style="color: #007700">,</span><span style="color: #DD0000">'compagnie.nom'</span><span style="color: #007700">,</span><span style="color: #DD0000">'compagnie.employe_du_mois'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'departement.id'</span><span style="color: #007700">,</span><span style="color: #DD0000">'departement.nom'</span><span style="color: #007700">,</span><span style="color: #DD0000">'employe.id'</span><span style="color: #007700">,</span><span style="color: #DD0000">'employe.nom'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">$megacorp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$root</span><span style="color: #007700">[</span><span style="color: #DD0000">'compagnie'</span><span style="color: #007700">][</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br /><br />unset(</span><span style="color: #0000BB">$root</span><span style="color: #007700">[</span><span style="color: #DD0000">'compagnie'</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">$das&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">applyChanges</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$root</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #DD0000">"Suppression&nbsp;de&nbsp;la&nbsp;compagnie,&nbsp;des&nbsp;départements&nbsp;et&nbsp;des&nbsp;employés&nbsp;d'un&nbsp;seul&nbsp;coup.\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div></div></div></body></html>