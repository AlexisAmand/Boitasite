<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Retourne un tableau qui r&eacute;crit la derni&egrave;re connexion utilis&eacute;e</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mysqlnd-ms-get-last-gtid.html">« mysqlnd_ms_get_last_gtid</a></li>
      <li style="float: right;"><a href="function.mysqlnd-ms-get-stats.html">mysqlnd_ms_get_stats »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.mysqlnd-ms.html">Fonctions Mysqlnd_ms</a></li>
    <li>Retourne un tableau qui r&eacute;crit la derni&egrave;re connexion utilis&eacute;e</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mysqlnd-ms-get-last-used-connection" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysqlnd_ms_get_last_used_connection</h1>
  <p class="verinfo">(PECL mysqlnd_ms &gt;= 1.1.0)</p><p class="refpurpose"><span class="refname">mysqlnd_ms_get_last_used_connection</span> &mdash; <span class="dc-title">Retourne un tableau qui récrit la dernière connexion utilisée</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.mysqlnd-ms-get-last-used-connection-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   
   <span class="methodname"><strong>mysqlnd_ms_get_last_used_connection</strong></span>
    ( <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$connection</code></span>
   ) : <span class="type">array</span></div>

  <p class="para rdfs-comment">
   Retourne un tableau qui décrit la dernière connexion utilisée depuis la file
   d&#039;attente de connexions actuellement pointée par le gestionnaire de connexion
   utilisateur. Si vous utilisez le plugin, un gestionnaire de connexion utilisateur
   représente une file d&#039;attente de connexions à la base de données. Il n&#039;est pas
   possible de dire depuis la connexion utilisateur qui gère les propriétés
   quel serveur de base de données depuis la file d&#039;attente le gestionnaire
   de connexions utilisateur pointe.
  </p>
  <p class="para">
   La fonction peut être utilisée pour déboguer ou monitorer PECL mysqlnd_ms.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mysqlnd-ms-get-last-used-connection-parameters">
  <h3 class="title">Liste de paramètres</h3>
  <dl>

   
    <dt>
<code class="parameter">connection</code></dt>

    <dd>

     <p class="para">
      Un gestionnaire de connexion MySQL obtenu depuis n&#039;importe quelle
      fonction de connexion des extensions <a href="ref.mysqli.html" class="link">mysqli</a>,
      <a href="ref.mysql.html" class="link">mysql</a> ou
      <a href="ref.pdo-mysql.html" class="link">PDO_MYSQL</a>.
     </p>
    </dd>

   
  </dl>

 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mysqlnd-ms-get-last-used-connection-returnvalues">
  <h3 class="title">Valeurs de retour</h3>
  <p class="para">
   <strong><code>FALSE</code></strong> en cas d&#039;erreur. Sinon, un tableau décrivant la connexion utilisée
   pour exécuter la dernière requête.
  </p>
  <p class="para">
   Tableau décrivant la connexion.
  </p>
  <table class="doctable informaltable">
   
    <col width="1*" />
    <col width="7*" />
    <col width="2*" />
    <thead>
     <tr>
      <th>Propriété</th>
      <th>Description</th>
      <th>Version</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>
       <code class="literal">scheme</code>
      </td>
      <td>
       Shéma de connexion. Soit <code class="literal">tcp://host:port</code>
       ou <code class="literal">unix://host:socket</code>. Si vous voulez distinguer
       les connexions les unes des autres, utilisez une combinaison de
       <code class="literal">scheme</code> et de <code class="literal">thread_id</code> comme
       clé unique. Ni <code class="literal">scheme</code>, ni <code class="literal">thread_id</code>
       seul ne sont suffisants pour distinguer deux connexions. Deux serveurs
       peuvent assigner le même <code class="literal">thread_id</code> à deux connexions différentes.
       Aussi, les connexions dans la file d&#039;attente peuvent avoir le même
       <code class="literal">thread_id</code>. Deplus, ne pariez pas sur l&#039;unicité de
       <code class="literal">scheme</code> dans une file d&#039;attente. Votre ingénieur QA
       peut utiliser la même instance de serveur MySQL pour deux rôles logiques
       distinctes, et l&#039;ajouter plusieurs fois dans la file d&#039;attente.
       Ce hack est utilisé, par exemple, dans la suite de test.
      </td>
      <td>Depuis 1.1.0.</td>
     </tr>

     <tr>
      <td>
       <code class="literal">host</code>
      </td>
      <td>
       Hôte du serveur de base de données utilisé avec la connexion.
       L&#039;hôte est uniquement défini avec des connexions TCP/IP.
       Il sera vide avec un domaine Unix ou Windows, nommé avec des connexions pipes.
      </td>
      <td>Depuis 1.1.0.</td>
     </tr>

     <tr>
      <td>
       <code class="literal">host_info</code>
      </td>
      <td>
       Une chaîne de caractères représentant le nom d&#039;hôte du serveur et
       le type de connexion.
      </td>
      <td>Depuis 1.1.2.</td>
     </tr>

     <tr>
      <td>
       <code class="literal">port</code>
      </td>
      <td>
       Le port du serveur de base de données utilisé avec la connexion.
      </td>
      <td>Depuis 1.1.0.</td>
     </tr>

     <tr>
      <td>
       <code class="literal">socket_or_pipe</code>
      </td>
      <td>
       Socket de domaine Unix ou Windows nommé pipe, utilisé avec la connexion.
       La valeur est vide pour les connexions TCP/IP.
      </td>
      <td>Depuis 1.1.2.</td>
     </tr>

     <tr>
      <td>
       <code class="literal">thread_id</code>
      </td>
      <td>
       Identifiant du thread de connexion.
      </td>
      <td>Depuis 1.1.0.</td>
     </tr>

     <tr>
      <td>
       <code class="literal">last_message</code>
      </td>
      <td>
       Message d&#039;information obtenu depuis la fonction
       mysql_info() MySQL C API. Reportez-vous à la fonction
       <span class="function"><a href="mysqli.info.html" class="function">mysqli_info()</a></span> pour une description détaillée.
      </td>
      <td>Depuis 1.1.0.</td>
     </tr>

     <tr>
      <td>
       <code class="literal">errno</code>
      </td>
      <td>
       Le code erreur.
      </td>
      <td>Depuis 1.1.0.</td>
     </tr>

     <tr>
      <td>
       <code class="literal">error</code>
      </td>
      <td>
       Le message d&#039;erreur.
      </td>
      <td>Depuis 1.1.0.</td>
     </tr>

     <tr>
      <td>
       <code class="literal">sqlstate</code>
      </td>
      <td>
       Le code erreur SQLstate.
      </td>
      <td>Depuis 1.1.0.</td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 unknown-returnvaluet" id="refsect1-function.mysqlnd-ms-get-last-used-connection-unknown-returnvaluet">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    <span class="function"><strong>mysqlnd_ms_get_last_used_connection()</strong></span> requière
    PHP &gt;= 5.4.0 et PECL mysqlnd_ms &gt;&gt; 1.1.0. En interne, cette fonction
    utilise un appel à la bibliothèque C <code class="literal">mysqlnd</code> qui n&#039;est
    pas disponible avec PHP 5.3.
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mysqlnd-ms-get-last-used-connection-examples">
  <h3 class="title">Exemples</h3>
  <p class="para">
   Cet exemple suppose que <code class="literal">myapp</code> se réfère une section
   du fichier de configuration du plugin et représente une file d&#039;attente
   de connexions.
  </p>
  <p class="para">
   <div class="example" id="example-2255">
    <p><strong>Exemple #1 Exemple avec <span class="function"><strong>mysqlnd_ms_get_last_used_connection()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$link&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">"myapp"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"database"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$link</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;1&nbsp;FROM&nbsp;DUAL"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">mysqlnd_ms_get_last_used_connection</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>L&#039;exemple ci-dessus va afficher :</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
array(10) {
  [&quot;scheme&quot;]=&gt;
  string(22) &quot;unix:///tmp/mysql.sock&quot;
  [&quot;host_info&quot;]=&gt;
  string(25) &quot;Localhost via UNIX socket&quot;
  [&quot;host&quot;]=&gt;
  string(0) &quot;&quot;
  [&quot;port&quot;]=&gt;
  int(3306)
  [&quot;socket_or_pipe&quot;]=&gt;
  string(15) &quot;/tmp/mysql.sock&quot;
  [&quot;thread_id&quot;]=&gt;
  int(46253)
  [&quot;last_message&quot;]=&gt;
  string(0) &quot;&quot;
  [&quot;errno&quot;]=&gt;
  int(0)
  [&quot;error&quot;]=&gt;
  string(0) &quot;&quot;
  [&quot;sqlstate&quot;]=&gt;
  string(5) &quot;00000&quot;
}
</pre></div>
    </div>
   </div>
  </p>
 </div>


</div></div></div></body></html>