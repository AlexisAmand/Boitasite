<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Surveille la modification d'un ou plusieurs flux</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.stream-resolve-include-path.html">« stream_resolve_include_path</a></li>
      <li style="float: right;"><a href="function.stream-set-blocking.html">stream_set_blocking »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.stream.html">Fonctions sur les flux</a></li>
    <li>Surveille la modification d'un ou plusieurs flux</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.stream-select" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">stream_select</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.3.0, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">stream_select</span> &mdash; <span class="dc-title">Surveille la modification d&#039;un ou plusieurs flux</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.stream-select-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>stream_select</strong></span>
    ( <span class="methodparam"><span class="type">array</span> <code class="parameter reference">&$read</code></span>
   , <span class="methodparam"><span class="type">array</span> <code class="parameter reference">&$write</code></span>
   , <span class="methodparam"><span class="type">array</span> <code class="parameter reference">&$except</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$tv_sec</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$tv_usec</code><span class="initializer"> = 0</span></span>
  ] ) : <span class="type">int</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>stream_select()</strong></span> accepte un tableau de flux et
   attend que l&#039;un d&#039;entre eux change de statut. Cette opération est
   équivalente à ce que fait la fonction <span class="function"><a href="function.socket-select.html" class="function">socket_select()</a></span>,
   hormis le fait qu&#039;elle travaille sur un flux.
  </p>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-function.stream-select-parameters">
  <h3 class="title">Liste de paramètres</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">read</code></dt>

     <dd>

      <p class="para">
       Les flux qui sont listés dans le paramètre <code class="parameter">read</code>
       seront surveillés en lecture, c&#039;est-à-dire si de nouveaux octets
       sont disponibles en lecture (pour être précis, si une lecture ne
       bloquera pas, ce qui inclut aussi les flux qui sont en fin de 
       fichier, auquel cas un appel à la fonction <span class="function"><a href="function.fread.html" class="function">fread()</a></span>
       retournera une chaîne de taille 0).
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">write</code></dt>

     <dd>

      <p class="para">
       Les flux qui sont listés dans le paramètre <code class="parameter">write</code>
       seront surveillés en écriture (pour être précis, si une écriture ne
       bloquera pas).
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">except</code></dt>

     <dd>

      <p class="para">
       Les flux qui sont listés dans le paramètre <code class="parameter">except</code>
       seront surveillés pour voir si une exception est levée.
      </p>
      <blockquote class="note"><p><strong class="note">Note</strong>: 
       <p class="para">
        Lorsque <span class="function"><strong>stream_select()</strong></span> se termine, les tableaux
        <code class="parameter">read</code>, <code class="parameter">write</code> et
        <code class="parameter">except</code> sont modifiés pour indiquer quels flux
        ont actuellement changé de statut.
       </p>
      </p></blockquote>
     </dd>

    
    
     <dt>
<code class="parameter">tv_sec</code></dt>

     <dd>

      <p class="para">
       Les paramètres <code class="parameter">tv_sec</code> et
       <code class="parameter">tv_usec</code>
       forment le <em class="emphasis">délai d&#039;expiration</em>,
       <code class="parameter">tv_sec</code> spécifie le nombre de secondes
       tandis que <code class="parameter">tv_usec</code>, le nombre de 
       microsecondes. Le paramètre <code class="parameter">timeout</code>
       représente la limite supérieure du temps que 
       <span class="function"><strong>stream_select()</strong></span> doit attendre avant de
       se terminer. Si <code class="parameter">tv_sec</code> et 
       <code class="parameter">tv_usec</code> sont tous les deux définis
       à <code class="literal">0</code>, , <span class="function"><strong>stream_select()</strong></span> n&#039;attendra 
       pas de données - à la place, elle se terminera immédiatement,
       indiquant le statut courant du flux. 
      </p>
      <p class="para">
       Si <code class="parameter">tv_sec</code> vaut <strong><code>NULL</code></strong>, 
       <span class="function"><strong>stream_select()</strong></span> peut se bloquer indéfiniment,
       se terminant uniquement lorsqu&#039;un événement sur un des flux surveillés
       survient (ou si un signal interrompt l&#039;appel système).
      </p>
      <div class="warning"><strong class="warning">Avertissement</strong>
       <p class="para">
        Utiliser un valeur de <code class="literal">0</code> vous permet de 
        tester instantanément le statut des flux, mais il faut savoir
        qu&#039;il n&#039;est pas recommandé d&#039;utiliser <code class="literal">0</code> 
        dans une boucle, car cela va faire consommer énormément de
        processeur à votre script.
       </p>
       <p class="para">
        Il est bien mieux de spécifier une valeur de quelques secondes, même
        si vous devez surveiller et exécuter différents codes de manière
        simultanée. Par exemple, utiliser une valeur d&#039;au moins 
        <code class="literal">200000</code> microsecondes, vous réduirez considérablement
        la consommation processeur de votre script.
       </p>
       <p class="para">
        N&#039;oubliez pas que la valeur d&#039;expiration est la durée maximale
        d&#039;attente, si rien ne se passe : <span class="function"><strong>stream_select()</strong></span> 
        retournera un résultat dès que l&#039;un des flux soumis est prêt à 
        l&#039;utilisation.
       </p>
      </div>
     </dd>

    
    
     <dt>
<code class="parameter">tv_usec</code></dt>

     <dd>

      <p class="para">
       Voyez la description de <code class="parameter">tv_sec</code>.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.stream-select-returnvalues">
  <h3 class="title">Valeurs de retour</h3>
  <p class="para">
   En cas de succès, <span class="function"><strong>stream_select()</strong></span> retourne
   le nombre de flux qui ont évolué, ce qui peut être <code class="literal">0</code>,  si 
   le délai d&#039;expiration a été atteint avant que les flux n&#039;évoluent.
   En cas d&#039;erreur, la fonction retournera <strong><code>FALSE</code></strong> et un 
   avertissement sera renvoyé (cela peut apparaître si l&#039;appel
   système est interrompu par un signal entrant).
  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.stream-select-examples">
  <h3 class="title">Exemples</h3>
  <p class="para">
   <div class="example" id="example-4457">
    <p><strong>Exemple #1 Exemple avec <span class="function"><strong>stream_select()</strong></span></strong></p>
    <div class="example-contents"><p>
     Cet exemple surveille si des données arrivent pour être
     lues soit dans <code class="parameter">$stream1</code>, soit dans
     <code class="parameter">$stream2</code>. Si le délai d&#039;expiration
     vaut <code class="literal">0</code>, la fonction se termine immédiatement :
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;Preparation&nbsp;du&nbsp;tableau&nbsp;de&nbsp;flux&nbsp;lecture&nbsp;*/<br /></span><span style="color: #0000BB">$read&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #0000BB">$stream1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$stream2</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$write&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">NULL</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$except&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">NULL</span><span style="color: #007700">;<br />if&nbsp;(</span><span style="color: #0000BB">false&nbsp;</span><span style="color: #007700">===&nbsp;(</span><span style="color: #0000BB">$num_changed_streams&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_select</span><span style="color: #007700">(</span><span style="color: #0000BB">$read</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$write</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$except</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Gestion&nbsp;d'erreur&nbsp;*/<br /></span><span style="color: #007700">}&nbsp;elseif&nbsp;(</span><span style="color: #0000BB">$num_changed_streams&nbsp;</span><span style="color: #007700">&gt;&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Au&nbsp;moins&nbsp;un&nbsp;des&nbsp;flux&nbsp;a&nbsp;évolué&nbsp;&nbsp;*/<br /></span><span style="color: #007700">}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 
 <div class="refsect1 notes" id="refsect1-function.stream-select-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    À cause d&#039;une limitation du moteur Zend actuel, il n&#039;est pas possible
    de passer la valeur <strong><code>NULL</code></strong> directement comme paramètre d&#039;une fonction
    qui s&#039;attend à des paramètres passés par référence. Au lieu de cela,
    il est recommandé d&#039;utiliser une variable temporaire, ou une expression
    dont le membre de gauche est une variable temporaire. Comme ceci :
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$e&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">NULL</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">stream_select</span><span style="color: #007700">(</span><span style="color: #0000BB">$r</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$w</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$e</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    Assurez-vous de bien utiliser l&#039;opérateur <code class="literal">===</code> lorsque vous
    recherchez des erreurs. Comme <span class="function"><strong>stream_select()</strong></span> peut retourner
    0, une comparaison effectuée à l&#039;aide de <code class="literal">==</code>
    l&#039;évaluerait à <strong><code>TRUE</code></strong> :
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$e&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">NULL</span><span style="color: #007700">;<br />if&nbsp;(</span><span style="color: #0000BB">false&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">stream_select</span><span style="color: #007700">(</span><span style="color: #0000BB">$r</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$w</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$e</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"stream_select()&nbsp;failed\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    Si vous avez écrit ou lu dans un flux qui est retourné dans les tableaux
    de flux, soyez bien conscient que ces flux n&#039;ont peut être pas écrit
    ou lu la totalité des données demandées. Soyez en
    mesure de lire un seul octet.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    Quelques flux (comme <code class="literal">zlib</code>) ne peuvent pas être
    sélectionnés par cette fonction.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <strong>Compabilité Windows</strong><br />
   <p class="para">
    Utiliser la fonction <span class="function"><strong>stream_select()</strong></span>
    sur un pointeur de fichier retourné par <span class="function"><a href="function.proc-open.html" class="function">proc_open()</a></span>
    échouera et retournera <strong><code>FALSE</code></strong> sous Windows.
   </p>
   <p class="para">
    <strong><code>STDIN</code></strong> fdepuis une console change son statut dés que
    <em class="emphasis">n&#039;importe</em> quel évenements d&#039;entrées sont disponible,
    mais lire depuis un flux peut toujours être bloquant.
   </p>
  </p></blockquote>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.stream-select-seealso">
  <h3 class="title">Voir aussi</h3>
  <ul class="simplelist">
   <li class="member"><span class="function"><a href="function.stream-set-blocking.html" class="function" rel="rdfs-seeAlso">stream_set_blocking()</a> - Configure le mode bloquant d'un flux</span></li>
  </ul>
 </div>

</div></div></div></body></html>