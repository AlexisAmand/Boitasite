<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Ex&eacute;cute une requ&ecirc;te SQL pass&eacute;e comme requ&ecirc;te pr&eacute;par&eacute;e, avec une liste de
   valeurs &agrave; substituer pour les param&egrave;tres fictifs, et retourne les r&eacute;sultats
   comme un graphique de donn&eacute;es normalis&eacute;.</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="sdo-das-relational.createrootdataobject.html">« SDO_DAS_Relational::createRootDataObject</a></li>
      <li style="float: right;"><a href="sdo-das-relational.executequery.html">SDO_DAS_Relational::executeQuery »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.sdodasrel.html">Fonctions SDO-DAS-Relational</a></li>
    <li>Ex&eacute;cute une requ&ecirc;te SQL pass&eacute;e comme requ&ecirc;te pr&eacute;par&eacute;e, avec une liste de
   valeurs &agrave; substituer pour les param&egrave;tres fictifs, et retourne les r&eacute;sultats
   comme un graphique de donn&eacute;es normalis&eacute;.</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="sdo-das-relational.executepreparedquery" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">SDO_DAS_Relational::executePreparedQuery</h1>
  <p class="verinfo">(^)</p><p class="refpurpose"><span class="refname">SDO_DAS_Relational::executePreparedQuery</span> &mdash; <span class="dc-title">
   Exécute une requête SQL passée comme requête préparée, avec une liste de
   valeurs à substituer pour les paramètres fictifs, et retourne les résultats
   comme un graphique de données normalisé.
  </span></p>

 </div>

 <div class="refsect1 description" id="refsect1-sdo-das-relational.executepreparedquery-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   
   <span class="methodname"><strong>SDO_DAS_Relational::executePreparedQuery</strong></span>
    ( <span class="methodparam">
    <span class="type"><a href="class.pdo.html" class="type PDO">PDO</a></span>
     <code class="parameter">$database_handle</code>
   </span>
   , <span class="methodparam">
    <span class="type"><a href="class.pdostatement.html" class="type PDOStatement">PDOStatement</a></span>
     <code class="parameter">$prepared_statement</code>
   </span>
   , <span class="methodparam">
    <span class="type">array</span>
     <code class="parameter">$value_list</code>
   </span>
   [, <span class="methodparam">
    <span class="type">array</span>
     <code class="parameter">$column_specifier</code>
   </span>
  ] ) : <span class="type"><span class="type SDODataObject">SDODataObject</span></span></div>


  <div class="warning"><strong class="warning">Avertissement</strong><p class="simpara">
 Cette fonction est <em class="emphasis">EXPERIMENTALE</em>. Le comportement de cette fonction, son nom, et toute la
 documentation autour de cette fonction peut changer sans préavis dans une prochaine version de PHP.
 Cette fonction doit être utilisée à vos risques et périls.
</p></div>

  <p class="para">
   Exécute une requête donnée sur une base de données relationnelle, en
   utilisant la ressource de base de données PDO fourni. Elle diffère de la
   fonction simple
   <span class="function"><strong>executeQuery()</strong></span>
   puisqu&#039;elle prend des requêtes préparées et une liste de valeurs. Ceci est
   l&#039;appel approprié lorsque vous voulez utiliser une requête qui doit être
   appelée un certain nombre de fois avec des arguments différents et il y a
   donc un avantage de performance à être préparée une seule fois. Elle est
   utile aussi pour les requêtes SQL qui contiennent des valeurs qui varient
   prises d&#039;une source qui ne peut pas être totalement sûre. Dans ce dernier
   cas, il est peu sécuritaire de construire une requête SQL en concaténant
   simplement les parties de la requête ensemble, puisque les valeurs peuvent
   convenir des morceau de SQL. Pour se protéger de ceci, d&#039;une prétendue
   attaque par injection SQL, il est plus sécuritaire de préparer la requête
   SQL avec des paramètres fictifs (aussi connu sous le nom de marqueurs,
   noté &#039;?&#039;) et fournir une liste de valeurs qui devra être substituée dans un
   argument séparé. Autrement, cette fonction est la même que
   <span class="function"><strong>executeQuery()</strong></span> puisqu&#039;elle utilise le modèle qui était
   bâti à partir des métadonnées pour interpréter le jeu de résultats et
   retourner un graphique de données.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-sdo-das-relational.executepreparedquery-parameters">
  <h3 class="title">Liste de paramètres</h3>
  <p class="para">
   <dl>

    
     <dt>
PDO_database_handle</dt>

     <dd>

      <p class="para">
       Construit en utilisant l&#039;extension PDO.
       Une ligne typique pour construire un descripteur de base de données PDO
       devrait ressembler à ceci :
       <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
$dbh&nbsp;=&nbsp;new&nbsp;PDO("mysql:dbname=COMPANYDB;host=localhost",DATABASE_USER,DATABASE_PASSWORD);</span>
</code></div>
       </div>

      </p>
     </dd>

    
    
     <dt>
prepared_statement</dt>

     <dd>

      <p class="para">
       Une requête SQL préparée qui sera exécutée sur la base de données. Il
       aura été préparé par la méthode
       <span class="function"><strong>prepare()</strong></span>
       de PDO.
      </p>
     </dd>

    
    
     <dt>
value_list</dt>

     <dd>

      <p class="para">
       Un tableau de valeurs à être substituées dans la requête SQL à la place
       des paramètres fictifs. Dans le cas qu&#039;il n&#039;y a pas de paramètres
       fictifs ou de marqueurs dans la requête SQL, alors cet argument peut
       être spécifié comme <strong><code>NULL</code></strong> ou en tant qu&#039;un tableau vide.
      </p>
     </dd>

    
    
     <dt>
column_specifier</dt>

     <dd>

      <p class="para">
       Le DAS Relationnel doit examiner le jeu de résultats et pour chaque
       colonne, provenant de quelle table et quelle colonne de la table il
       vient.
       Dans certaines circonstances, il peut trouver les informations pour
       lui-même, mais la plupart du temps il ne le peut pas.
       Dans ces cas, une colonne spécifique est requise, qui est un tableau
       qui identifie les colonnes. Chaque entrée dans le tableau est simplement
       une <a href="language.types.string.html" class="link">chaîne de caractères</a> dans la forme
       <var class="varname">table-name.column_name</var>.
      </p>
      <p class="para">
       Le spécificateur de colonne est requis lorsqu&#039;il y a des noms de
       colonnes similaires dans les métadonnées de base de données.
       Par exemple, dans une base de données utilisée dans ces exemples,
       toutes les tables ont une colonne
       <var class="varname">id</var> et une colonne <var class="varname">nom</var>.
       Lorsque DAS Relationnel récupère le jeu de résultats à partir de PDO,
       il peut le faire avec l&#039;attribut PDO_FETCH_ASSOC, ce qui permettra aux
       colonnes dans les jeux de résultats d&#039;être marquées avec un nom de
       colonne, mais on ne pourra pas distinguer les entrées similaires.
       Alors cela fonctionnera seulement lorsqu&#039;il y aura aucune entrée
       similaire possible dans les jeux de résultats.
      </p>
      <p class="para">
       Pour résumer, spécifier un tableau de spécificateurs de colonne
       lorsqu&#039;il y a une incertitude à propos des colonnes qui pourraient
       venir de quelle table. Il faut l&#039;omettre seulement lorsque chaque nom
       des colonnes dans les métadonnées de base de données est unique.
      </p>
      <p class="para">
       Tous les exemples dans la section d&#039;<a href="sdodasrel.examples.html" class="link">Exemples</a> utilisent un
       spécificateur de colonne. Il y a un exemple dans le dossier
       <var class="filename">Scenarios</var> de l&#039;installation qui ne fait pas :
       il ne fonctionne seulement avec la table employe et parce qu&#039;il
       travaille seulement avec une seule table, il ne peut y avoir des noms de
       colonnes similaires.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-sdo-das-relational.executepreparedquery-returnvalues">
  <h3 class="title">Valeurs de retour</h3>
  <p class="para">
   Retourne un graphique de données.
   Spécifiquement, elle retourne un objet racine d&#039;un type spécial. Sous cet
   objet de racine se trouveront les données du jeu de résultat. L&#039;objet de
   racine aura une propriété de valeurs multiples contenue avec le même nom
   que le type racine d&#039;application spécifié dans le constructeur, et la
   propriété continuera un ou plusieurs objets de donnés du type de racine de
   l&#039;application.
  </p>
  <p class="para">
   Dans le cas que la requête aucune donnée, l&#039;objet spécial de racine pour
   le type de racine de l&#039;application sera vide.
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-sdo-das-relational.executepreparedquery-errors">
  <h3 class="title">Erreurs / Exceptions</h3>
  <p class="para">
   <span class="function"><strong>SDO_DAS_Relational::executePreparedQuery()</strong></span> peut jeter une
   exception <strong class="classname">SDO_DAS_Relational_Exception</strong> si elle n&#039;est pas capable de
   construire le graphique de données correctement.
   Cela peut arriver pour un certains nombres de raisons :
   par exemple, si elle trouve qu&#039;elle n&#039;a pas de clés primaire dans le jeu de
   résultats pour tous les objets.
   Le DAS Relationnel attrape toutes les exceptions de PDO et obtient des
   informations de diagnostique de PDO qui inclut un
   <strong class="classname">SDO_DAS_Relational_Exception</strong> qui sera alors jeté.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-sdo-das-relational.executepreparedquery-examples">
  <h3 class="title">Exemples</h3>
  <p class="para">
   <div class="example" id="example-6105">
    <p><strong>Exemple #1 Récupération d&#039;un objet de données en utilisant
     <span class="function"><strong>executePreparedQuery()</strong></span></strong></p>
    <div class="example-contents"><p>
     Dans cet exemple, un simple objet de données est récupéré de la base de
     données - ou possiblement plus d&#039;un s&#039;il y a plus d&#039;une compagnie appelée
     &#039;Acme&#039;. Pour chaque compagnie retournée, les propriétés
     <var class="varname">nom</var>
     et
     <var class="varname">id</var>
     sont affichées.
    </p></div>
    <div class="example-contents"><p>
     D&#039;autres exemples d&#039;utilisation de
     <span class="function"><strong>executePreparedQuery()</strong></span>
     peuvent être trouvés dans le code d&#039;exemple fourni dans
     <var class="filename">sdo/DAS/Relational/Scenarios</var>.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">require_once&nbsp;</span><span style="color: #DD0000">'SDO/DAS/Relational.php'</span><span style="color: #007700">;<br />require_once&nbsp;</span><span style="color: #DD0000">'company_metadata.inc.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/**************************************************************<br />&nbsp;*&nbsp;Construit&nbsp;le&nbsp;DAS&nbsp;avec&nbsp;les&nbsp;métadonnées<br />&nbsp;***************************************************************/<br /></span><span style="color: #0000BB">$das&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SDO_DAS_Relational&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$database_metadata</span><span style="color: #007700">,</span><span style="color: #DD0000">'company'</span><span style="color: #007700">,</span><span style="color: #0000BB">$SDO_reference_metadata</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/**************************************************************<br />&nbsp;*&nbsp;Récupère&nbsp;une&nbsp;connexion&nbsp;à&nbsp;la&nbsp;base&nbsp;de&nbsp;données<br />&nbsp;***************************************************************/<br /></span><span style="color: #0000BB">$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO_DSN</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_USER</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_PASSWORD</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/**************************************************************<br />&nbsp;*&nbsp;Effectue&nbsp;une&nbsp;requête&nbsp;pour&nbsp;obtenir&nbsp;un&nbsp;objet&nbsp;compagnie&nbsp;-&nbsp;il&nbsp;pourrait&nbsp;y&nbsp;en<br />&nbsp;*&nbsp;avoir&nbsp;plus&nbsp;s'ils&nbsp;existaient<br />&nbsp;*&nbsp;Utilise&nbsp;une&nbsp;requête&nbsp;préparée&nbsp;avec&nbsp;des&nbsp;paramètres&nbsp;fictifs.<br />&nbsp;***************************************************************/<br /></span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Acme'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$pdo_stmt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">'select&nbsp;name,&nbsp;id&nbsp;from&nbsp;company&nbsp;where&nbsp;name=?'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$root&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$das</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">executePreparedQuery</span><span style="color: #007700">(<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$pdo_stmt</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;array(</span><span style="color: #0000BB">$name</span><span style="color: #007700">),&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;array(</span><span style="color: #DD0000">'company.name'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'company.id'</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">/**************************************************************<br />&nbsp;*&nbsp;Affiche&nbsp;le&nbsp;nom&nbsp;et&nbsp;son&nbsp;id<br />&nbsp;***************************************************************/<br /></span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$root</span><span style="color: #007700">[</span><span style="color: #DD0000">'company'</span><span style="color: #007700">]&nbsp;as&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Company&nbsp;obtained&nbsp;from&nbsp;the&nbsp;database&nbsp;has&nbsp;name&nbsp;=&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">"&nbsp;and&nbsp;id&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">[</span><span style="color: #DD0000">'id'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

</div></div></div></body></html>