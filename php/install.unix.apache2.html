<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Apache 2.x sur les syst&egrave;mes Unix</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="install.unix.apache.html">« Apache 1.3.x sur les syst&egrave;mes Unix</a></li>
      <li style="float: right;"><a href="install.unix.nginx.html">Nginx 1.4.x sur les syst&egrave;mes Unix »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="install.unix.html">Installation sur les syst&egrave;mes UNIX</a></li>
    <li>Apache 2.x sur les syst&egrave;mes Unix</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="install.unix.apache2" class="sect1">
 <h2 class="title">Apache 2.x sur les systèmes Unix</h2>
 <p class="para">
  Cette section contient les notes et conseils d&#039;installation de PHP avec le serveur
  Apache 2.x sur les systèmes Unix.
 </p>
 
 <div class="warning"><strong class="warning">Avertissement</strong><p class="para">Nous ne recommandons pas
    l&#039;utilisation de PHP dans un environnement threadé MPM, avec Apache 2.
    Utilisez le mode prefork MPM, qui est le MPM par défaut pour Apache 2.0 et 2.2.
    Pour savoir pourquoi, lisez
    l&#039;entrée de la FAQ correspondante à l&#039;<a href="faq.installation.html#faq.installation.apache2" class="link">utilisation
        d&#039;Apache 2 dans un environnement threadé MPM</a>.</p></div>
 
 <p class="para">
  La <a href="http://httpd.apache.org/docs/current/" class="link external">&raquo;&nbsp;Documentation Apache</a>
  est la meilleure source d&#039;informations sur le serveur Apache 2.x.
  La plupart des informations sur les options d&#039;installation d&#039;Apache
  peut y être trouvée.
 </p>
 
 <p class="para">
  La version la plus récente du serveur HTTP Apache peut être obtenue
  depuis la <a href="http://httpd.apache.org/" class="link external">&raquo;&nbsp;page de téléchargement d&#039;Apache</a>,
  et une version adaptée de PHP depuis les liens ci-dessus.
  Ce guide couvre uniquement les bases de fonctionnement d&#039;Apache 2.x avec PHP.     
  Pour plus d&#039;informations, lire la
  <a href="http://httpd.apache.org/docs/current/" class="link external">&raquo;&nbsp;documentation Apache</a>.
  Les numéros de version sont omis ici, pour s&#039;assurer que les instructions ne soient
  pas incorrectes. Dans les exemples ci-dessous, &#039;NN&#039; devra être remplacé
  par la version spécifique d&#039;Apache à utiliser.
 </p>
 
 <p class="para">
  Il y a actuellement 2 versions d&#039;Apache 2.x - 2.4 et 2.2.
  Il y a plusieurs raisons de choisir l&#039;une plutôt que l&#039;autre ; néanmoins, la version
  2.4 est actuellement la dernière version disponible et c&#039;est aussi celle
  que nous vous recommandons. Cependant, les instructions contenues
  dans ce guide devraient fonctionner pour la version 2.4 comme pour la version 2.2. Note: Apache hhtpd 2.2 est officiellement en Fin de Vie, il n&#039;y aura plus de développement ni de patch pour cette version.
 </p>
 
 <ol type="1">
  <li class="listitem">
   <p class="para">
    Téléchargez le serveur HTTP Apache depuis le site ci-dessus et décompressez-le :
   </p>
   
   <div class="informalexample">
    <div class="example-contents screen">
<div class="cdata"><pre>
tar -xzf httpd-2.x.NN.tar.gz
</pre></div>
    </div>
   </div>
  </li>
  
  <li class="listitem">
   <p class="para">
    De la même façon, téléchargez et décompressez les sources de PHP :
   </p>
   
   <div class="informalexample">
    <div class="example-contents screen">
<div class="cdata"><pre>
tar -xzf php-NN.tar.gz
</pre></div>
    </div>
   </div>
  </li>
  
  <li class="listitem">
   <p class="para">
    Compilez et installez Apache. Consultez la documentation sur l&#039;installation
    d&#039;Apache pour plus de détails quant à la compilation de ce logiciel.
   </p>
   
   <div class="informalexample">
    <div class="example-contents screen">
<div class="cdata"><pre>
cd httpd-2_x_NN
./configure --enable-so
make
make install
</pre></div>
    </div>
   </div>
  </li>
  
  <li class="listitem">
   <p class="para">
    Maintenant que vous avez Apache 2.x.NN de disponible sous /usr/local/apache2,
    configurez-le avec le support pour le chargement de modules, ainsi que le
    MPM prefork standard. Pour tester votre installation, utilisez la procédure
    normale pour démarrer le serveur Apache, i.e. :
    
    <div class="informalexample">
     <div class="example-contents screen">
<div class="cdata"><pre>
/usr/local/apache2/bin/apachectl start
</pre></div>
     </div>
    </div>
    et arrêtez-le pour continuer dans la configuration de PHP :
    
    <div class="informalexample">
     <div class="example-contents screen">
<div class="cdata"><pre>
/usr/local/apache2/bin/apachectl stop
</pre></div>
     </div>
    </div>
   </p>
  </li>
  
  <li class="listitem">
   
   <p class="para">
    Maintenant, configurez et compilez PHP. Ce sera à ce moment-là
    où vous pourrez personnaliser PHP avec les diverses options disponibles,
    comme la liste des extensions à activer. Dans notre exemple, nous effectuerons
    une configuration simple, avec Apache 2 et le support MySQL.
   </p>
   
   <p class="para">
    Si vous avez construis Apache depuis les sources, tel que décrit ci-dessus,
    l&#039;exemple suivant devrait être correct concernant les chemins vers les apxs, mais si
    vous avez installé Apache d&#039;une autre façon, vous devrez prendre en compte vos
    spécificités et ajustez les chemins apxs en conséquent. Notez que suivants
    les distributions, vous pourriez être amené à renommer apxs en apxs2.
   </p>
   <div class="informalexample">
    <div class="example-contents screen">
<div class="cdata"><pre>
cd ../php-NN
./configure --with-apxs2=/usr/local/apache2/bin/apxs --with-mysql
make
make install
</pre></div>
    </div>
   </div>
   
   <p class="para">
    Si vous décidez de modifier les options de configuration après l&#039;installation,
    vous devrez exécuter de nouveau les étapes &quot;configure&quot;, &quot;make&quot; et &quot;make install&quot;.
    Vous n&#039;aurez alors qu&#039;à redémarrer Apache pour que le nouveau module prenne effet.
    Une re-compilation d&#039;Apache n&#039;est pas nécessaire.
   </p>
   
   <p class="para">
    Notez que, sauf indications contraires, l&#039;étape &quot;make install&quot; installera
    également PEAR, mais aussi divers outils PHP comme phpsize, PHP CLI et
    bien plus encore.
   </p>
   
  </li>
  
  <li class="listitem">
   <p class="para">
    Setup your php.ini
   </p>
   
   <div class="informalexample">
    <div class="example-contents screen">
<div class="cdata"><pre>
cp php.ini-development /usr/local/lib/php.ini
</pre></div>
    </div>
   </div>
   
   <p class="para">
    Vous devez éditer le fichier .ini pour définir les options PHP.
    Si vous préférez placer ce fichier dans un autre répertoire, utilisez
    l&#039;option <code class="literal">--with-config-file-path=/some/path</code> à l&#039;étape 5.
   </p>
   
   <p class="para">
    Si vous choisissez le fichier php.ini-production, assurez-vous de lire la liste
    des modifications correspondante car il peut affecter considérablement la façon
    dont PHP fonctionnera.
   </p>
   
  </li>
  
  <li class="listitem">
   
   <p class="para">
    Éditez le fichier httpd.conf pour charger le module PHP. Le chemin spécifié
    à droite de la chaîne LoadModule, doit correspondre au chemin système du module
    PHP. L&#039;étape &quot;make install&quot; ci-dessus devrait avoir réalisé cette opération
    à votre place, mais une simple vérification permettra de s&#039;en assurer.
   </p>
   
      <div class="informalexample">
       <p class="para">
        Pour PHP 7:
       </p>
       <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode">LoadModule php7_module modules/libphp7.so</pre>
</div>
       </div>

     </div>
   
   <div class="informalexample">
       <p class="para">
        Pour PHP 5:
       </p>
    <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode">LoadModule php5_module modules/libphp5.so</pre>
</div>
    </div>

   </div>
   
  </li>
  
  <li class="listitem">
   
   <p class="para">
    Dites à Apache d&#039;analyser certaines extensions comme étant des scripts PHP.
    Par exemple, laissez Apache passer à PHP les fichiers dont l&#039;extension est
    .php. Au lieu d&#039;utiliser seulement la directive AddType d&#039;Apache,
    nous souhaitons éviter tout risque potentiellement dangereux, lors
    d&#039;un téléchargement de de la création de fichier comme exploit.php.jpg,
    d&#039;exécution PHP. En utilisant cette exemple, vous pouvez avoir n&#039;importe
    quelle extension d&#039;analyser par PHP. Nous avons ajouté .php pour l&#039;exemple.
   </p>
   
   
   <div class="informalexample">
    <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode">&lt;FilesMatch \.php$&gt;
    SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;</pre>
</div>
    </div>

   </div>
   
   <p class="para">
    Ou, si vous voulez autoriser les fichiers .php, .php2, .php3, .php4, .php5, .php6, et
    .phtml à être analysés par PHP, mais rien d&#039;autre, nous utiliserons ceci :
   </p>
   
   <div class="informalexample">
    <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode">&lt;FilesMatch &quot;\.ph(p[2-6]?|tml)$&quot;&gt;
    SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;</pre>
</div>
    </div>

   </div>
   
   <p class="para">
    Et pour autoriser les fichiers .phps à être gérés par le filtre du code
    source de PHP, et ainsi, être affichés comme code source avec la coloration
    syntaxique, utilisez ceci :
   </p>
   
   <div class="informalexample">
    <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode">&lt;FilesMatch &quot;\.phps$&quot;&gt;
    SetHandler application/x-httpd-php-source
&lt;/FilesMatch&gt;</pre>
</div>
    </div>

   </div>
   
   <p class="para">
    mod_rewrite peut être utilisé pour permettre à n&#039;importe quel fichier .php
    d&#039;être affiché comme code source avec coloration syntaxique, sans pour autant
    avoir besoin de le renommer ou de le copier avec une extension .phps. :
   </p>
   
   <div class="informalexample">
    <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode">RewriteEngine On
RewriteRule (.*\.php)s$ $1 [H=application/x-httpd-php-source]</pre>
</div>
    </div>

   </div>
   
   <p class="para">
    Le filtre de code source PHP ne devrait pas être actif sur des systèmes de
    production, car il peut exposer du code confidentiel ou des informations
    sensibles contenues dans le code source.
   </p>
   
  </li>
  
  <li class="listitem">
   <p class="para">
    Utilisez la procédure normale pour démarrer le serveur Apache, i.e. :
   </p>
   
   <div class="informalexample">
    <div class="example-contents screen">
<div class="cdata"><pre>
/usr/local/apache2/bin/apachectl start
</pre></div>
    </div>
   </div>
   
   <p class="para">Ou</p>
   
   <div class="informalexample">
    <div class="example-contents screen">
<div class="cdata"><pre>
service httpd restart
</pre></div>
    </div>
   </div>
   
  </li>
 </ol>
 
 <p class="para">
  Si vous avez suivi les étapes précédentes, vous avez maintenant un serveur web
  Apache2 fonctionnel avec le support PHP comme module <code class="literal">SAPI</code>.
  Bien-sûr, il y a une multitude d&#039;autres options de configuration de disponibles
  avec Apache et PHP. Pour plus d&#039;informations, entrez la commande
  <strong class="command">./configure --help</strong> dans l&#039;arbre source correspondant.
 </p>
 <p class="para">
  Apache peut être compilé en mode multi-threadé, en sélectionnant
  le MPM <var class="filename">worker</var>, plutôt que le standard
  MPM <var class="filename">prefork</var>. Ceci est fait en ajoutant l&#039;option
  suivante à l&#039;argument de la commande &quot;./configure&quot;, à l&#039;étape 3 ci-dessus :
 </p>
 <div class="informalexample">
  <div class="example-contents screen">
<div class="cdata"><pre>
--with-mpm=worker
</pre></div>
  </div>
 </div>
 <p class="para">
  Cela ne devrait pas être entrepris sans être conscients des conséquences,
  et ayant au moins une juste compréhension de ce que cela implique.
  La documentation Apache concernant
  <a href="http://httpd.apache.org/docs/current/mpm.html" class="link external">&raquo;&nbsp;MPM-Modules</a>
  vous apportera d&#039;importantes informations qui vous permettra de prendre
  votre décision.
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   La <a href="faq.installation.html#faq.installation.apache.multiviews" class="link">FAQ Apache
   MultiViews</a> traite de l&#039;utilisation MultiViews avec PHP.
  </p>
 </p></blockquote>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   Pour compiler une version multi-threadée d&#039;Apache, le système cible
   doit supporter les threads. Dans ce cas, PHP doit également être construit
   avec l&#039;expérimental Zend Thread Safety (ZTS). Sous cette configuration,
   toutes les extensions ne seront pas disponibles. Nous vous recommandons
   de compiler Apache avec le <var class="filename">prefork</var> MPM-Module.
  </p>
 </p></blockquote>
</div></div></div></body></html>