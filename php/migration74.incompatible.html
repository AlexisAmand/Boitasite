<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Modifications entrainant une incompatibilit&eacute; ascendante</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="migration74.constants.html">« Nouvelles constantes globales</a></li>
      <li style="float: right;"><a href="migration74.deprecated.html">Fonctionnalit&eacute;s obsol&egrave;tes »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="migration74.html">Migration de PHP 7.3.x vers PHP 7.4.x</a></li>
    <li>Modifications entrainant une incompatibilit&eacute; ascendante</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="migration74.incompatible" class="sect1">
 <h2 class="title">Modifications entrainant une incompatibilité ascendante</h2>


 <div class="sect2" id="migration74.incompatible.core">
  <h3 class="title">PHP Core</h3>

  <div class="sect3" id="migration74.incompatible.core.non-array-access">
   <h4 class="title">Accès de type tableau des non-tableaux</h4>

   <p class="para">
    Essayer d&#039;utiliser des valeurs de type <span class="type"><a href="language.types.null.html" class="type null">null</a></span>, <span class="type"><a href="language.types.boolean.html" class="type bool">bool</a></span>, <span class="type"><a href="language.types.integer.html" class="type int">int</a></span>, <span class="type"><a href="language.types.float.html" class="type float">float</a></span> ou <span class="type"><span class="type ressource">ressource</span></span> comme un tableau (comme <code class="literal">$null[&quot;clé&quot;]</code>) va maintenant générer un avis.
    
   </p>
  </div>

  <div class="sect3" id="migration74.incompatible.core.get-declared-classes">
   <h4 class="title">Fonction <span class="function"><a href="function.get-declared-classes.html" class="function">get_declared_classes()</a></span></h4>

   <p class="para">
    La fonction <span class="function"><a href="function.get-declared-classes.html" class="function">get_declared_classes()</a></span> ne renvoie plus les 
    classes anonymes qui n&#039;ont pas encore été instanciées.
   </p>
  </div>

  <div class="sect3" id="migration74.incompatible.core.fn">
   <h4 class="title">mot-clé <code class="literal">fn</code></h4>

   <p class="para">
    <code class="literal">fn</code> est maintenant un mot-clé réservé. En particulier, il ne 
    peut plus être utilisé comme une fonction ou un nom de classe.
    Il peut encore être utilisé comme une méthode ou un nom de constante de classe.
   </p>
  </div>

  <div class="sect3" id="migration74.incompatible.core.php-tag">
   <h4 class="title"><code class="literal">&lt;?php</code> tag à la fin du fichier</h4>

   <p class="para">
    <code class="literal">&lt;?php</code> à la fin du fichier (sans nouvelle ligne)
     sera désormais interprété comme une balise PHP d&#039;ouverture.  Auparavant, il 
    était interprété soit comme une balise courte d&#039;ouverture suivie d&#039;une 
    <code class="literal">php</code> littérale et aboutissait à une erreur de syntaxe 
    (avec <code class="literal">short_open_tag=1</code>) ou était interprété comme une chaîne 
    <code class="literal">&lt;?php</code> (avec  <code class="literal">short_open_tag=0</code>).
   </p>
  </div>

  <div class="sect3" id="migration74.incompatible.core.stream-wrappers">
   <h4 class="title">Filtres de flux</h4>

   <p class="para">
    Lors de l&#039;utilisation de include/require sur un flux, 
    <span class="methodname"><a href="streamwrapper.stream-set-option.html" class="methodname">streamWrapper::stream_set_option()</a></span> sera invoqué avec 
    l&#039;option <strong><code>STREAM_OPTION_READ_BUFFER</code></strong>.
    Les implémentations de filtre de flux personnalisés peuvent avoir besoin 
    d&#039;implémenter la méthode  <span class="methodname"><a href="streamwrapper.stream-set-option.html" class="methodname">streamWrapper::stream_set_option()</a></span> 
    pour éviter un avertissement (toujours en retouner <strong><code>FALSE</code></strong> est une implémentation suffisante).
   </p>
  </div>

  <div class="sect3" id="migration74.incompatible.core.serialization">
   <h4 class="title">Sérialisation</h4>

   <p class="para">
    Le format <code class="literal">o</code> de sérialisation a été supprimé.
    Comme il n&#039;est jamais produit par PHP, cela peut seulement briser la déserialisation 
    des chaînes construites manuellement.
   </p>
  </div>

  <div class="sect3" id="migration74.incompatible.core.password-algorithm-constants">
   <h4 class="title">Constantes d&#039;algorithme de mot de passe</h4>

   <p class="para">
    Les identificateurs d&#039;algorithme de hachage de mot de passe sont maintenant des chaînes nullables plutôt que des entiers.
   </p>

   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      <strong><code>PASSWORD_DEFAULT</code></strong> était l&#039;entier 1; maintenant est <strong><code>NULL</code></strong>
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <strong><code>PASSWORD_BCRYPT</code></strong> était l&#039;entier 1; maintenant est &#039;2y&#039;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <strong><code>PASSWORD_ARGON2I</code></strong>  était l&#039;entier 2; maintenant est &#039;argon2i&#039;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <strong><code>PASSWORD_ARGON2ID</code></strong>  était l&#039;entier 3; maintenant est &#039;argon2id&#039;
     </span>
    </li>
   </ul>

   <p class="para">
    Applications utilisant correctement les constantes PASSWORD_DEFAULT,
    PASSWORD_BCRYPT, PASSWORD_ARGON2I, et PASSWORD_ARGON2ID continueront à 
    fonctionner correctement.
   </p>
  </div>

  <div class="sect3" id="migration74.incompatible.core.htmlentities">
   <h4 class="title">Fonction <span class="function"><a href="function.htmlentities.html" class="function">htmlentities()</a></span></h4>

   <p class="para">
    <span class="function"><a href="function.htmlentities.html" class="function">htmlentities()</a></span> va maintenant lever un avis (au lieu d&#039;un 
    avertissement de normes strictes) s&#039;il est utilisé avec un codage pour lequel 
    seule la substitution d&#039;entité de base est supportée, auquel cas il est 
    équivalent à <span class="function"><a href="function.htmlspecialchars.html" class="function">htmlspecialchars()</a></span>.
   </p>
  </div>

  <div class="sect3" id="migration74.incompatible.core.fread-fwrite">
   <h4 class="title">Les fonctions <span class="function"><a href="function.fread.html" class="function">fread()</a></span> et <span class="function"><a href="function.fwrite.html" class="function">fwrite()</a></span></h4>

   <p class="para">
     <span class="function"><a href="function.fread.html" class="function">fread()</a></span> et <span class="function"><a href="function.fwrite.html" class="function">fwrite()</a></span> vont maintenant retourner <strong><code>FALSE</code></strong> si l&#039;opération échoue.
    Auparavant, une chaîne vide ou 0 était retourné(e).
    EAGAIN/EWOULDBLOCK ne sont pas considérés comme des échecs.
   </p>
   <p class="para">
    Ces fonctions soulèvent également un avis sur l&#039;échec, par exemple lorsque 
    vous essayez d&#039;écrire à une ressource de fichier en lecture uniquement.
   </p>
  </div>

 </div>

 <div class="sect2" id="migration74.incompatible.bcmath">
  <h3 class="title">BCMath Arbitrary Precision Mathematics</h3>

  <p class="para">
   Les fonctions BCMath avertiront désormais si un nombre non bien formé est 
   adopté, tel que <code class="literal">&quot;32foo&quot;</code>. L&#039;argument sera interprété comme 
   zéro, comme avant.
  </p>
 </div>

 <div class="sect2" id="migration74.incompatible.curl">
  <h3 class="title">CURL</h3>

  <p class="para">
   Tenter de sérialiser une classe <a href="class.curlfile.html" class="classname">CURLFile</a> va maintenant 
   générer une exception. Auparavant, l&#039;exception n&#039;était lancée que sur la désérialisation.
  </p>
  <p class="para">
   L&#039;utilisation de <strong><code>CURLPIPE-HTTP1</code></strong> est dépréciée et n&#039;est plus 
   prise en charge à partir de 7.62.0 cURL.
  </p>
  <p class="para">
   Le paramètre <code class="literal">$version</code> de <span class="function"><strong>curl_version ()</strong></span> 
   est déprécié. Si une valeur n&#039;est pas égale à la valeur par défaut
   <strong><code>CURLVERSION_NOW</code></strong> est passé, un avertissement est levé et 
   le paramètre est ignoré.
  </p>
 </div>

 <div class="sect2" id="migration74.incompatible.datetime">
  <h3 class="title">Date et heure</h3>

  <p class="para">
   Appeler <span class="function"><a href="function.var-dump.html" class="function">var_dump()</a></span> ou similaire sur une instance  
   <a href="class.datetime.html" class="classname">DateTime</a> ou <a href="class.datetimeimmutable.html" class="classname">DateTimeImmutable</a> ne 
   laissera plus de propriétés accessibles sur l&#039;objet.
  </p>
  <p class="para">
   La comparaison des objets <a href="class.dateinterval.html" class="classname">DateInterval</a> (à l&#039;aide de 
   <code class="literal">==</code>, <code class="literal">&lt;</code>, etc.) va maintenant générer 
   un avertissement et toujours retourner <strong><code>FALSE</code></strong>. Auparavant, tous les 
   <a href="class.dateinterval.html" class="classname">DateInterval</a> objets étaient considérés comme égaux, 
   à moins qu&#039;ils n&#039;aient des propriétés.
  </p>
 </div>

 <div class="sect2" id="migration74.incompatible.intl">
  <h3 class="title">Intl</h3>

  <p class="para">
   La valeur par défaut du paramètre de <span class="function"><a href="function.idn-to-ascii.html" class="function">idn_to_ascii()</a></span> et
   <span class="function"><a href="function.idn-to-utf8.html" class="function">idn_to_utf8()</a></span> est maintenant <strong><code>INTL_IDNA_VARIANT_UTS46</code></strong>
   au lieu de la valeur déconseillée <strong><code>INTL_IDNA_VARIANT_2003</code></strong>.
  </p>
 </div>

 <div class="sect2" id="migration74.incompatible.mysqli">
  <h3 class="title">MySQLi</h3>

  <p class="para">
   La fonctionnalité du serveur intégré a été supprimée. Elle a été cassée depuis 
   au moins PHP 7.0.
  </p>
  <p class="para">
   La propriété non documentée <code class="literal">mysqli::$stat</code> a été supprimée au 
   profit de <span class="methodname"><a href="mysqli.stat.html" class="methodname">mysqli::stat()</a></span>.
  </p>
 </div>

 <div class="sect2" id="migration74.incompatible.openssl">
  <h3 class="title">OpenSSL</h3>

  <p class="para">
   La fonction <span class="function"><a href="function.openssl-random-pseudo-bytes.html" class="function">openssl_random_pseudo_bytes()</a></span>
   lance une exception dans les situations d&#039;erreur, semblable à <span class="function"><a href="function.random-bytes.html" class="function">random_bytes()</a></span>.
   En particulier, un <a href="class.error.html" class="classname">Error</a> est lancé si le nombre d&#039;octets demandés est inférieur ou égal à zéro, et une  <a href="class.exception.html" class="classname">Exception</a> est lancé si un caractère aléatoire suffisant ne peut pas être recueilli.
   L&#039;argument de sortie <code class="literal">$crypto_strong output</code> est garanti d&#039;être toujours <strong><code>TRUE</code></strong> si la fonction ne lance pas d&#039;exception, afin de vérifier explicitement qu&#039;il n&#039;est pas nécessaire.
  </p>
 </div>

 <div class="sect2" id="migration74.incompatible.pcre">
  <h3 class="title">Expressions rationnelles (compatible Perl)</h3>

  <p class="para">
   Lorsque le mode <strong><code>PREG_UNMATCHED_AS_NULL</code></strong> est utilisé, les 
   groupes de capture non trouvés seront désormais également réglés à <strong><code>NULL</code></strong> (ou 
   <code class="literal">[null, -1]</code> si la capture offset est activée).   Cela signifie 
   que la taille de  <code class="literal">$matches</code> sera toujours la même.
  </p>
 </div>

 <div class="sect2" id="migration74.incompatible.pdo">
  <h3 class="title">PHP Data Objects</h3>

  <p class="para">
   Une tentative de sérialisation d&#039;une instance de <a href="class.pdo.html" class="classname">PDO</a> ou
   <a href="class.pdostatement.html" class="classname">PDOStatement</a>  va désormais générer une 
   <a href="class.exception.html" class="classname">Exception</a> plutôt qu&#039;une <a href="class.pdoexception.html" class="classname">PDOException</a>, 
   compatible avec d&#039;autres classes internes qui ne prennent pas en charge la sérialisation.
  </p>
 </div>

 <div class="sect2" id="migration74.incompatible.reflection">
  <h3 class="title">Reflection</h3>

  <p class="para">
   Les objets Reflection génèrent désormais une exception si une tentative est faite 
   pour les sérialiser. La sérialisation des objets Reflection n&#039;a jamais été prise 
   en charge et a donné lieu à des objets Reflection corrompus. Il a été explicitement 
   interdit maintenant.
  </p>
 </div>

 <div class="sect2" id="migration74.incompatible.spl">
  <h3 class="title">Bibliothèque PHP standard (SPL)</h3>

  <p class="para">
   L&#039;appel <span class="function"><a href="function.get-object-vars.html" class="function">get_object_vars()</a></span> sur une instance   
   <a href="class.arrayobject.html" class="classname">ArrayObject</a> retournera toujours les propriétés de 
   l&#039;<a href="class.arrayobject.html" class="classname">ArrayObject</a> lui-même (ou d&#039;une sous-classe).
   Auparavant, il retournait les valeurs du tableau/objet à moins que le drapeau 
   <strong><code>ArrayObject::STD_PROP_LIST</code></strong> n&#039;ai été spécifié.
  </p>
  <p class="para">
   Les autres opérations touchées sont les suivante :
  </p>
  <ul class="itemizedlist">
   <li class="listitem">
    <span class="simpara">
     <span class="methodname"><strong>ReflectionObject::getProperties()</strong></span>
    </span>
   </li>
   <li class="listitem">
    <span class="simpara">
     <span class="function"><a href="function.reset.html" class="function">reset()</a></span>, <span class="function"><a href="function.current.html" class="function">current()</a></span>, etc.
     Utiliser plutôt les méthodes d&#039;<span class="interfacename"><a href="class.iterator.html" class="interfacename">Iterator</a></span>.
    </span>
   </li>
   <li class="listitem">
    <span class="simpara">
     Potentiellement d&#039;autres fonctions travaillant sur les propriétés de l&#039;objet comme une liste.
    </span>
   </li>
  </ul>
  <p class="para">
   Les modifications de type <code class="literal">(array)</code> ne sont pas affectés. 
   Ils continueront à retourner soit le tableau enveloppé, soit les propriétés 
   <a href="class.arrayobject.html" class="classname">ArrayObject</a>, selon que le drapeau 
   <strong><code>ArrayObject::STD_PROP_LIST</code></strong> est utilisé.
  </p>
  <p class="para">
   <span class="methodname"><a href="splpriorityqueue.setextractflags.html" class="methodname">SplPriorityQueue::setExtractFlags()</a></span> lancera une exception 
   si zéro est passé. Auparavant, cela générerait une erreur fatale récupérable 
   lors de la prochaine opération d&#039;extraction.
  </p>
  <p class="para">
   <a href="class.arrayobject.html" class="classname">ArrayObject</a>, <a href="class.arrayiterator.html" class="classname">ArrayIterator</a>,
   <a href="class.spldoublylinkedlist.html" class="classname">SplDoublyLinkedList</a> et <a href="class.splobjectstorage.html" class="classname">SplObjectStorage</a>
   gèrent maintenant <code class="literal">__serialize()</code> et <code class="literal">__unserialize()</code>
   en plus de l&#039;interface <span class="interfacename"><a href="class.serializable.html" class="interfacename">Serializable</a></span>.
   Cela signifie que les charges utiles de sérialisation créées sur les anciennes 
   versions PHP peuvent toujours être désérialisées, mais les nouvelles charges 
   utiles créées par PHP 7.4 ne seront pas compatibles par les anciennes versions.
  </p>
 </div>

 <div class="sect2" id="migration74.incompatible.tokenizer">
  <h3 class="title">Tokenizer</h3>

  <p class="para">
   <span class="function"><a href="function.token-get-all.html" class="function">token_get_all()</a></span> émettra maintenant un jeton 
   <strong><code>T-BAD-CHARACTER</code></strong> pour les caractères inattendus au lieu de 
   laisser derrière eux des trous dans le flux de jetons.
  </p>
 </div>

 <div class="sect2" id="migration74.incompatible.cookie-decode">
  <h3 class="title">Cookies entrants</h3>

  <p class="para">
   Depuis PHP 7.4.11, le <em class="emphasis">nom</em> des cookies entrants ne sont plus
   url-décodés pour des raisons de sécurité.
  </p>
 </div>

</div></div></div></body></html>