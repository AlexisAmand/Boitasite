<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Apache 1.3.x sur les syst&egrave;mes Unix</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="install.unix.html">« Installation sur les syst&egrave;mes UNIX</a></li>
      <li style="float: right;"><a href="install.unix.apache2.html">Apache 2.x sur les syst&egrave;mes Unix »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="install.unix.html">Installation sur les syst&egrave;mes UNIX</a></li>
    <li>Apache 1.3.x sur les syst&egrave;mes Unix</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="install.unix.apache" class="sect1">
    <h2 class="title">Apache 1.3.x sur les systèmes Unix</h2>
    <p class="para">
     Cette section contient des notes spécifiques pour l&#039;installation de PHP
     avec Apache sur les systèmes Unix. Des notes spécifiques
     pour Apache 2 sont aussi disponibles <a href="install.unix.apache2.html" class="link">sur une
     page séparée</a>.
    </p>
    <p class="para">
     Vous pouvez sélectionner des options à ajouter au fichier
     <strong class="command">configure</strong> à la ligne 10 depuis la
     <a href="configure.about.html" class="link">liste complète des options de configuration</a>.
     Les numéros de versions ont été omis ici afin de s&#039;assurer que les instructions ne
     soient pas incorrectes. Vous devrez donc remplacer les &#039;xxx&#039; par les versions
     correctes de vos fichiers.
    </p>

    <div class="example" id="install.unix.apache.example">
     <p><strong>Exemple #1 
      Instructions d&#039;installation de PHP (en module Apache)
     </strong></p>
     <div class="example-contents screen">
<div class="cdata"><pre>
1.  gunzip apache_xxx.tar.gz
2.  tar -xvf apache_xxx.tar
3.  gunzip php-xxx.tar.gz
4.  tar -xvf php-xxx.tar
5.  cd apache_xxx
6.  ./configure --prefix=/www --enable-module=so
7.  make
8.  make install
9.  cd ../php-xxx

10. Maintenant, configurez votre PHP. C&#039;est le moment où vous configurez PHP
    avec diverses options, comme les extensions qui seront activées. Lancez
    ./configure --help pour une liste des options disponibles. Dans notre exemple,
    nous ferons un ./configure assez simple avec uniquement le support Apache et MySQL.
    Votre chemin vers apxs peut être différent de notre exemple.

      ./configure --with-mysql --with-apxs=/www/bin/apxs

11. make
12. make install

    Si vous décidez de changer vos options de configuration après l&#039;installation,
    vous aurez juste besoin de répéter les trois dernières étapes. Vous aurez aussi besoin
    de redémarrer apache pour que le nouveau module soit chargé. Une recompilation de
    Apache n&#039;est pas nécessaire.

    Notez que, à moins de l&#039;avoir explicitement désactivé, &#039;make install&#039; installera aussi PEAR,
    et des outils PHP tels que phpize, installera le CLI PHP, etc.

13. Configurez votre fichier php.ini :

      cp php.ini-development /usr/local/lib/php.ini

    Vous pouvez éditer votre fichier .ini pour régler certaines options PHP. Si vous souhaitez
    votre php.ini à un autre endroit, utilisez --with-config-file-path=/votre/chemin lors de
    l&#039;étape 10.

    Si vous utilisez plutôt php.ini-production, assurez-vous de lire l&#039;ensemble des changements
    qui y sont contenus, car ils modifient le fonctionnement de PHP.

14. Éditez votre httpd.conf afin de charger le module PHP. Le chemin dans la partie droite de la
    directive LoadModule doit pointer vers l&#039;endroit où se trouve le module PHP sur votre système.
    Le make install lancé plus haut l&#039;y aura certainement déjà déposé pour vous, 
    mais assurez vous en.

      LoadModule php5_module libexec/libphp5.so

15. Et dans la section AddModule de httpd.conf, quelque part en dessous de
    ClearModuleList, ajoutez ceci :

      AddModule mod_php5.c

16. Dites à Apache de faire analyser certaines extensions par PHP. Par exemple,
    faites analyser l&#039;extension .php par PHP. Vous pouvez ajouter n&#039;importe quelle(s)
    extension(s) à analyser juste en l&#039;(les)ajoutant à la suite, séparée(s) par un espace.
    Nous ajouterons .phtml dans notre exemple.

      AddType application/x-httpd-php .php .phtml

    Il est assez fréquent de configurer l&#039;extension .phps comme code source PHP colorisé,
    ce qui peut être fait ainsi :

      AddType application/x-httpd-php-source .phps

17. Utilisez votre méthode habituelle pour démarrer le serveur Apache.
    (vous devez l&#039;éteindre et le redémarrer, pas seulement lui envoyer
    un signal HUP ou USR1.)
</pre></div>
     </div>
    </div>

    <p class="para">
     Alternativement, pour installer PHP en tant qu&#039;objet statique :
    </p>

    <div class="example" id="install.unix.apache.example-static">
     <p><strong>Exemple #2 
      Instructions d&#039;installation (installation en tant que module statique d&#039;Apache) de PHP
     </strong></p>
     <div class="example-contents screen">
<div class="cdata"><pre>
1.  gunzip -c apache_1.3.x.tar.gz | tar xf -
2.  cd apache_1.3.x
3.  ./configure
4.  cd ..

5.  gunzip -c php-5.x.y.tar.gz | tar xf -
6.  cd php-5.x.y
7.  ./configure --with-mysql --with-apache=../apache_1.3.x
8.  make
9.  make install

10. cd ../apache_1.3.x

11. ./configure --prefix=/www --activate-module=src/modules/php5/libphp5.a
    (La ligne ci-dessus est correcte ! Oui, nous savons que libphp5.a n&#039;existe pas à
    ce moment. On ne le suppose pas non plus. Il sera créé.)

12. make
    (vous devriez avoir maintenant un binaire httpd que vous pouvez copier dans votre
    dossier de binaire Apache ; si c&#039;est votre première installation, vous devez exécuter la
    commande &quot;make install&quot;)

13. cd ../php-5.x.y
14. cp php.ini-development /usr/local/lib/php.ini

15. Vous pouvez éditer le fichier /usr/local/lib/php.ini pour définir les options de PHP.
    Éditez votre fichier httpd.conf ou srm.conf et ajoutez :
    AddType application/x-httpd-php .php
</pre></div>
      </div>
     </div>

     <p class="para">
      Suivant votre installation d&#039;Apache et votre variante d&#039;Unix,
      il existe de nombreuses façons d&#039;arrêter et redémarrer
      Apache. Voici une liste des commandes typiques, pour différentes
      installations. Remplacez <code class="literal">/path/to/</code> par
      le chemin d&#039;accès à vos applications sur votre système.
     </p>
     <p class="para">
      <div class="example" id="example-11">
       <p><strong>Exemple #3 Exemples de commandes pour le redémarrage d&#039;apache</strong></p>
       <div class="example-contents">
<div class="shellcode"><pre class="shellcode">1. Nombreuses variantes Linux SysV :
/etc/rc.d/init.d/httpd restart

2. Avec les scripts apachectl :
/path/to/apachectl stop
/path/to/apachectl start

3. httpdctl et httpsdctl (utilisant OpenSSL), similaires à apachectl :
/path/to/httpsdctl stop
/path/to/httpsdctl start

4. En utilisant mod_ssl, ou un autre serveur SSL, vous pouvez vouloir l&#039;arrêter
et le démarrer manuellement :
/path/to/apachectl stop
/path/to/apachectl startssl</pre>
</div>
       </div>

      </div>
     </p>
     <p class="para">
      L&#039;emplacement des exécutables apachectl et http(s)dctl peut
      varier. Si votre système est pourvu des commandes
      <code class="literal">locate</code>, <code class="literal">whereis</code> ou
      <code class="literal">which</code>, elles peuvent vous aider à retrouver vos programmes.
     </p>

     <p class="para">
      Différents exemples de compilation PHP pour Apache suivent :
      <div class="informalexample">
       <div class="example-contents">
<div class="shellcode"><pre class="shellcode">./configure --with-apxs --with-pgsql</pre>
</div>
       </div>

      </div>
     </p>
     <p class="para">
      Cette commande va créer une bibliothèque partagée
      <var class="filename">libphp5.so</var> qui sera chargée par Apache avec
      une ligne LoadModule dans le fichier <var class="filename">httpd.conf</var>.
      Le support PostgreSQL est aussi inclus dans cette bibliothèque.
     </p>
     <p class="para">
      <div class="informalexample">
       <div class="example-contents">
<div class="shellcode"><pre class="shellcode">./configure --with-apxs --with-pgsql=shared</pre>
</div>
       </div>

      </div>
     </p>
     <p class="para">
      Cette commande va créer une bibliothèque partagée <var class="filename">libphp5.so</var>
      pour Apache, mais va aussi créer la bibliothèque partagée
      <var class="filename">pgsql.so</var> qui sera chargée dans PHP
      avec une directive du fichier <var class="filename">php.ini</var> ou en la
      chargeant explicitement dans le script avec la fonction
      <span class="function"><a href="function.dl.html" class="function">dl()</a></span>.
     </p>
     <p class="para">
      <div class="informalexample">
       <div class="example-contents">
<div class="shellcode"><pre class="shellcode">./configure --with-apache=/path/to/apache_source --with-pgsql</pre>
</div>
       </div>

      </div>
     </p>
     <p class="para">
      Cette commande va créer une autre bibliothèque partagée
      <var class="filename">libmodphp5.a</var>, un fichier <var class="filename">mod_php5.c</var>
      et quelques fichiers associés dans le dossier <code class="literal">src/modules/php4</code>
      du dossier source Apache. Puis, vous devez compiler Apache avec
      <code class="literal">--activate-module=src/modules/php5/libphp5.a</code>
      et le système de compilation d&#039;Apache va créer un fichier
      <var class="filename">libphp5.a</var> et le lier statiquement avec
      <var class="filename">httpd</var>. Le support PostgreSQL est alors
      inclus directement dans l&#039;exécutable <var class="filename">httpd</var>,
      ce qui fait que le résultat final est un fichier unique
      <var class="filename">httpd</var>, qui inclut Apache et PHP.
     </p>
     <p class="para">
      <div class="informalexample">
       <div class="example-contents">
<div class="shellcode"><pre class="shellcode">./configure --with-apache=/path/to/apache_source --with-pgsql=shared</pre>
</div>
       </div>

      </div>
     </p>
     <p class="para">
      Comme précédemment, mais au lieu d&#039;inclure le support PostgreSQL
      directement dans l&#039;exécutable <var class="filename">httpd</var> final, vous allez obtenir
      une bibliothèque partagée <var class="filename">pgsql.so</var> que vous pouvez charger
      dans PHP soit grâce au fichier de configuration
      <var class="filename">php.ini</var> ou dynamiquement avec <span class="function"><a href="function.dl.html" class="function">dl()</a></span>.
     </p>
     <p class="para">
      Lorsque vous faites votre choix entre les différents modes de compilation de PHP,
      vous devez prendre en compte leurs avantages et inconvénients respectifs. Les
      objets partagés permettent de compiler PHP et Apache de manière séparée, et vous
      n&#039;aurez pas à compiler l&#039;ensemble pour faire évoluer PHP. La compilation statique
      permet de charger et d&#039;exécuter plus rapidement PHP. Pour plus
      d&#039;informations, voyez la page web sur le
      <a href="http://httpd.apache.org/docs/current/dso.html" class="link external">&raquo;&nbsp;support des DSO</a>.
     </p>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <p class="para">
      Le <var class="filename">httpd.conf</var> par défaut d&#039;Apache est fourni avec une
      section qui ressemble à ceci :
      <div class="informalexample">
       <div class="example-contents">
<div class="apache-confcode"><pre class="apache-confcode">User nobody
Group &quot;#-1&quot;</pre>
</div>
       </div>

      </div>
      À moins que vous ne changiez cette valeur par &quot;Group nogroup&quot;
      ou quelque chose comme ça (&quot;Group daemon&quot; est aussi classique),
      PHP ne sera pas capable d&#039;ouvrir des fichiers.
     </p>
    </p></blockquote>  
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <p class="para">
      Assurez-vous que vous spécifiez la version installée de apxs avec l&#039;option
      <strong class="option configure">--with-apxs=/path/to/apxs</strong>.
      Vous NE devez PAS utiliser la version d&#039;apxs qui est
      dans les sources d&#039;Apache, mais celle qui est réellement installée sur votre
      système.
     </p>
    </p></blockquote>   
   </div></div></div></body></html>